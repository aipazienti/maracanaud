<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MARACA • Maxi Suite 01–05</title>
<style>
  :root {
    --bg: #0b0d12;
    --panel: rgba(18, 22, 34, 0.92);
    --panel2: rgba(18, 22, 34, 0.65);
    --text: #e9eefc;
    --muted: rgba(233, 238, 252, 0.72);
    --border: rgba(233, 238, 252, 0.15);
    --shadow: 0 20px 60px rgba(0,0,0,.55);
    --radius: 18px;
  }
  html,body {
    height:100%;
    margin:0;
    background: radial-gradient(1200px 700px at 20% 10%, #1a2140 0%, transparent 60%),
                radial-gradient(900px 600px at 80% 20%, #102b2a 0%, transparent 55%),
                var(--bg);
    color: var(--text);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  }
  .topbar {
    position: sticky;
    top: 0;
    z-index: 50;
    display:flex;
    align-items:center;
    justify-content: space-between;
    gap: 12px;
    padding: 10px 12px;
    backdrop-filter: blur(10px);
    background: linear-gradient(180deg, rgba(10,12,18,.92), rgba(10,12,18,.65));
    border-bottom: 1px solid var(--border);
  }
  .brand {
    display:flex;
    align-items:center;
    gap:10px;
    font-weight:700;
    letter-spacing:.4px;
    user-select:none;
    white-space:nowrap;
  }
  .brand .pill {
    font-size:12px;
    padding:4px 10px;
    border: 1px solid var(--border);
    border-radius: 999px;
    background: rgba(255,255,255,.05);
    color: var(--muted);
    font-weight:600;
  }
  .btnrow {
    display:flex;
    flex-wrap: wrap;
    gap: 8px;
    align-items:center;
    justify-content: flex-end;
  }
  button {
    appearance:none;
    border: 1px solid var(--border);
    background: rgba(255,255,255,.06);
    color: var(--text);
    padding: 9px 12px;
    border-radius: 12px;
    cursor:pointer;
    font-weight: 650;
    letter-spacing:.2px;
    transition: transform .08s ease, background .15s ease, border-color .15s ease, opacity .15s ease;
  }
  button:hover { background: rgba(255,255,255,.10); border-color: rgba(233,238,252,.25); }
  button:active { transform: translateY(1px); }
  button.primary {
    background: rgba(106, 159, 255, .18);
    border-color: rgba(106, 159, 255, .35);
  }
  button.danger {
    background: rgba(255, 93, 141, .14);
    border-color: rgba(255, 93, 141, .30);
  }
  button:disabled {
    opacity:.55;
    cursor:not-allowed;
  }
  .page {
    padding: 18px 12px 40px;
    max-width: 1100px;
    margin: 0 auto;
  }
  .card {
    border: 1px solid var(--border);
    background: rgba(255,255,255,.04);
    border-radius: var(--radius);
    padding: 16px;
    box-shadow: var(--shadow);
  }
  .card h1 {
    margin:0 0 10px 0;
    font-size: 22px;
  }
  .card p {
    margin: 0;
    color: var(--muted);
    line-height: 1.45;
  }

  /* Overlay start */
  .overlay {
    position: fixed;
    inset: 0;
    z-index: 100;
    display:flex;
    align-items:center;
    justify-content:center;
    padding: 18px;
    background: rgba(0,0,0,.65);
    backdrop-filter: blur(8px);
  }
  .overlay .panel {
    width: min(720px, 100%);
    border: 1px solid var(--border);
    border-radius: 22px;
    background: var(--panel);
    box-shadow: var(--shadow);
    padding: 18px;
  }
  .overlay h2 {
    margin: 0 0 10px 0;
    font-size: 20px;
  }
  .overlay p {
    margin: 0 0 14px 0;
    color: var(--muted);
    line-height: 1.5;
  }
  .overlay .actions {
    display:flex;
    flex-wrap:wrap;
    gap: 10px;
  }

  /* Modal */
  .modal {
    position: fixed;
    inset: 0;
    z-index: 80;
    display:none;
    align-items: stretch;
    justify-content: center;
    background: rgba(0,0,0,.62);
    backdrop-filter: blur(8px);
    padding: 14px;
  }
  .modal.open { display:flex; }
  .modal .window {
    width: min(1200px, 100%);
    height: 100%;
    border: 1px solid var(--border);
    border-radius: 22px;
    background: var(--panel2);
    box-shadow: var(--shadow);
    overflow: hidden;
    display:flex;
    flex-direction: column;
  }
  .modal .head {
    display:flex;
    align-items:center;
    justify-content: space-between;
    gap: 10px;
    padding: 10px 10px;
    border-bottom: 1px solid var(--border);
    background: rgba(10,12,18,.80);
  }
  .modal .head .title {
    font-weight: 750;
    letter-spacing: .2px;
  }
  .modal .body {
    flex: 1;
    position: relative;
    background: #000;
  }
  .modal iframe {
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    border:0;
    background:#000;
  }
  .hint {
    margin-top: 12px;
    font-size: 12.5px;
    color: rgba(233,238,252,.65);
  }
</style>
</head>
<body>
  <div class="topbar">
    <div class="brand">
      <div>MARACA • Maxi Suite</div>
      <div class="pill">01–05 in un file</div>
    </div>
    <div class="btnrow">
      <button id="btnActivateTop" class="primary" type="button">ATTIVA AUDIO</button>
      <button type="button" onclick="openSection('01')">01 ACC</button>
      <button type="button" onclick="openSection('02')">02 LOOP</button>
      <button type="button" onclick="openSection('03')">03 DJ</button>
      <button type="button" onclick="openSection('04')">04 SYNTH</button>
      <button type="button" onclick="openSection('05')">05 SEQ</button>
      <button type="button" class="danger" onclick="closeModal()">CHIUDI</button>
    </div>
  </div>

  <main class="page">
    <div class="card">
      <h1>Avvio rapido</h1>
      <p>
        1) Premi <b>ATTIVA AUDIO</b> (sblocca l’audio nel browser).<br/>
        2) Apri <b>01 ACC</b> e usa il pulsante interno dell’accordatore per avviare microfono/analisi.<br/>
        Se il browser chiede permessi, consenti il microfono.
      </p>
      <div class="hint">
        Nota: ogni sezione gira in una finestra popup (iframe) separata per evitare conflitti tra JS/CSS originali.
      </div>
    </div>
  </main>

  <!-- Start overlay: garante gesto utente prima dell'audio -->
  <div id="startOverlay" class="overlay" role="dialog" aria-modal="true">
    <div class="panel">
      <h2>Attivazione audio richiesta</h2>
      <p>
        Per i browser moderni, l’audio e/o il microfono richiedono un gesto utente.
        Premi uno dei pulsanti qui sotto per sbloccare l’audio, poi apri <b>01 ACC</b> e avvia l’accordatore.
      </p>
      <div class="actions">
        <button class="primary" type="button" id="btnActivate">ATTIVA ORA</button>
        <button class="primary" type="button" id="btnActivateOpen01">ATTIVA + APRI 01</button>
      </div>
      <div class="hint">Se non senti o non vedi input, controlla permessi microfono del browser per il file locale.</div>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal" role="dialog" aria-modal="true">
    <div class="window">
      <div class="head">
        <div class="title" id="modalTitle">Sezione</div>
        <div class="btnrow">
          <button type="button" onclick="reloadCurrent()">RIPRISTINA</button>
          <button type="button" class="danger" onclick="closeModal()">CHIUDI</button>
        </div>
      </div>
      <div class="body" id="modalBody"></div>
    </div>
  </div>

<script>
  // === Embedded sources (base64) ===
  const SOURCES = {"01": {"title": "Accordatore", "b64": "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9Iml0Ij4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9IlVURi04IiAvPgo8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MS4wLHZpZXdwb3J0LWZpdD1jb3ZlciIgLz4KPHRpdGxlPm1hcmFjYW5hdWRpbyDigJMgQWNjb3JkYXRvcmU8L3RpdGxlPgoKPG1ldGEgbmFtZT0idGhlbWUtY29sb3IiIGNvbnRlbnQ9IiMwMDAwMDAiPgo8bWV0YSBuYW1lPSJtb2JpbGUtd2ViLWFwcC1jYXBhYmxlIiBjb250ZW50PSJ5ZXMiPgo8bWV0YSBuYW1lPSJhcHBsZS1tb2JpbGUtd2ViLWFwcC1jYXBhYmxlIiBjb250ZW50PSJ5ZXMiPgo8bWV0YSBuYW1lPSJhcHBsZS1tb2JpbGUtd2ViLWFwcC1zdGF0dXMtYmFyLXN0eWxlIiBjb250ZW50PSJibGFjay10cmFuc2x1Y2VudCI+Cgo8c3R5bGU+Cip7bWFyZ2luOjA7cGFkZGluZzowO2JveC1zaXppbmc6Ym9yZGVyLWJveDt9Cmh0bWwsYm9keXt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQ6IzAwMDtvdmVyZmxvdzpoaWRkZW47Zm9udC1mYW1pbHk6c3lzdGVtLXVpLC1hcHBsZS1zeXN0ZW0sU2Vnb2UgVUksUm9ib3RvLEFyaWFsLHNhbnMtc2VyaWY7fQouYXBwe3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ZGlzcGxheTpmbGV4O2JhY2tncm91bmQ6cmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCBjZW50ZXIsIzE1MTUxNSAwJSwjMDAwIDcwJSk7Y29sb3I6I2ZmZjt9Ci50dW5lcntmbGV4OjE7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpzdHJldGNoO2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O3BhZGRpbmc6MTJweDtnYXA6MTBweDt9Ci50b3BSb3d7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6OHB4O30KLnBpbGx7ZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjhweDtwYWRkaW5nOjhweCAxMnB4O2JvcmRlci1yYWRpdXM6MTRweDtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsMC4wOCk7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LDAuMTIpO2ZvbnQtd2VpZ2h0OjkwMDt9Ci5idG57Ym9yZGVyOm5vbmU7Y3Vyc29yOnBvaW50ZXI7cGFkZGluZzoxMHB4IDE0cHg7Ym9yZGVyLXJhZGl1czoxNHB4O2ZvbnQtd2VpZ2h0OjkwMDtjb2xvcjojZmZmO2JhY2tncm91bmQ6IzJhNTI5ODt0cmFuc2l0aW9uOnRyYW5zZm9ybSAuMTJzIGVhc2U7dXNlci1zZWxlY3Q6bm9uZTt9Ci5idG46YWN0aXZle3RyYW5zZm9ybTpzY2FsZSgwLjk4KTt9Ci5idG4uc2Vjb25kYXJ5e2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwwLjEyKTt9Ci5idG4uZGFuZ2Vye2JhY2tncm91bmQ6I2RjMzU0NTt9Ci5yZWFkb3V0e2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo0cHg7cGFkZGluZy10b3A6MnB4O30KLm5vdGVMaW5le2ZvbnQtc2l6ZTo0OHB4O2ZvbnQtd2VpZ2h0OjEwMDA7dGV4dC1zaGFkb3c6MCAwIDE4cHggcmdiYSgwLDI1NSwwLDAuMzUpO30KLmZyZXFMaW5le2ZvbnQtc2l6ZToyMnB4O2ZvbnQtd2VpZ2h0OjkwMDt9Ci5kZWx0YUxpbmV7Zm9udC1zaXplOjE4cHg7Zm9udC13ZWlnaHQ6OTAwO2NvbG9yOiNmZmQ3MDA7fQoubWV0ZXJ7cG9zaXRpb246cmVsYXRpdmU7ZmxleDoxO21pbi1oZWlnaHQ6MTQwcHg7Ym9yZGVyLXJhZGl1czoxOHB4O2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZyxyZ2JhKDI1NSwyNTUsMjU1LDAuMDYpLHJnYmEoMjU1LDI1NSwyNTUsMC4wMikpO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwwLjEyKTtvdmVyZmxvdzpoaWRkZW47fQouc2NhbGV7cG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MDtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZzowIDI0cHg7fQoubWFya3t3aWR0aDoycHg7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LDAuMik7cG9zaXRpb246cmVsYXRpdmU7fQoubWFyay5jZW50ZXJ7d2lkdGg6M3B4O2JhY2tncm91bmQ6IzAwZmYwMDtib3gtc2hhZG93OjAgMCAxNnB4IHJnYmEoMCwyNTUsMCwwLjYpO30KLmxhYmVse3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbTo4cHg7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7Zm9udC1zaXplOjEycHg7Zm9udC13ZWlnaHQ6OTAwO29wYWNpdHk6MC43O3doaXRlLXNwYWNlOm5vd3JhcDt9Ci5uZWVkbGV7cG9zaXRpb246YWJzb2x1dGU7dG9wOjEwJTtoZWlnaHQ6ODAlO3dpZHRoOjRweDtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTtib3JkZXItcmFkaXVzOjJweDtiYWNrZ3JvdW5kOiNmZjMzMzM7Ym94LXNoYWRvdzowIDAgMTZweCByZ2JhKDI1NSwwLDAsMC42KTt0cmFuc2l0aW9uOmxlZnQgLjA4cyBlYXNlLW91dDt9Ci5uZWVkbGUub2t7YmFja2dyb3VuZDojMDBmZjAwO2JveC1zaGFkb3c6MCAwIDE4cHggcmdiYSgwLDI1NSwwLDAuNyk7fQouc3RhdHVze3RleHQtYWxpZ246Y2VudGVyO3BhZGRpbmc6OHB4O2JvcmRlci1yYWRpdXM6MTRweDtmb250LXdlaWdodDoxMDAwO2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwwLjA2KTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4xMik7fQouc3RhdHVzLmdvb2R7YmFja2dyb3VuZDpyZ2JhKDAsMjU1LDAsMC4xOCk7Y29sb3I6I2Q5ZmZkOTtib3JkZXItY29sb3I6cmdiYSgwLDI1NSwwLDAuMjUpO30KLnN0YXR1cy5sb3d7YmFja2dyb3VuZDpyZ2JhKDI1NSw2OCw2OCwwLjE4KTtib3JkZXItY29sb3I6cmdiYSgyNTUsNjgsNjgsMC4yNSk7fQouc3RhdHVzLmhpZ2h7YmFja2dyb3VuZDpyZ2JhKDI1NSwxMzYsMCwwLjE4KTtib3JkZXItY29sb3I6cmdiYSgyNTUsMTM2LDAsMC4yNSk7fQoKLm92ZXJsYXl7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC44Mik7ei1pbmRleDo5OTk7cGFkZGluZzoxNHB4O30KLm92ZXJsYXlDYXJke3dpZHRoOm1pbig1MjBweCw5NnZ3KTtiYWNrZ3JvdW5kOiNmZmY7Y29sb3I6IzExMTtib3JkZXItcmFkaXVzOjE4cHg7cGFkZGluZzoxOHB4O2JveC1zaGFkb3c6MCAxOHB4IDcwcHggcmdiYSgwLDAsMCwwLjQ1KTt0ZXh0LWFsaWduOmNlbnRlcjt9Ci5vdmVybGF5Q2FyZCBoMntmb250LXNpemU6MjBweDtmb250LXdlaWdodDoxMDAwO21hcmdpbi1ib3R0b206OHB4O30KLm92ZXJsYXlDYXJkIHB7Zm9udC1zaXplOjE0cHg7Zm9udC13ZWlnaHQ6NzUwO2NvbG9yOiM0NDQ7bGluZS1oZWlnaHQ6MS40O21hcmdpbi1ib3R0b206MTRweDt9Ci5vdmVybGF5Um93e2Rpc3BsYXk6ZmxleDtnYXA6MTBweDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2ZsZXgtd3JhcDp3cmFwO30KLm92ZXJsYXlSb3cgLmJ0bnttaW4td2lkdGg6MTYwcHg7fQouZXJye2Rpc3BsYXk6bm9uZTttYXJnaW4tdG9wOjEycHg7Y29sb3I6I2IwMDAyMDtmb250LXdlaWdodDo5MDA7Zm9udC1zaXplOjEzcHg7d2hpdGUtc3BhY2U6cHJlLXdyYXA7fQoKLnJlZk1vZGFse3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7ZGlzcGxheTpub25lO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjcyKTt6LWluZGV4OjEyMDA7cGFkZGluZzoxNHB4O30KLnJlZk1vZGFsLnNob3d7ZGlzcGxheTpmbGV4O30KLnJlZkNhcmR7d2lkdGg6bWluKDUyMHB4LDk2dncpO2JhY2tncm91bmQ6I2ZmZjtjb2xvcjojMTExO2JvcmRlci1yYWRpdXM6MThweDtwYWRkaW5nOjE4cHg7dGV4dC1hbGlnbjpsZWZ0O2JveC1zaGFkb3c6MCAxOHB4IDcwcHggcmdiYSgwLDAsMCwwLjQ1KTt9Ci5yZWZDYXJkIGgze2ZvbnQtc2l6ZToxOHB4O2ZvbnQtd2VpZ2h0OjEwMDA7bWFyZ2luLWJvdHRvbToxMHB4O30KLnJlZlJvd3tkaXNwbGF5OmZsZXg7Z2FwOjEwcHg7YWxpZ24taXRlbXM6Y2VudGVyO30KLnJlZlJvdyBpbnB1dHtmbGV4OjE7cGFkZGluZzoxMnB4IDEycHg7Ym9yZGVyLXJhZGl1czoxNHB4O2JvcmRlcjoycHggc29saWQgI2RkZDtmb250LXNpemU6MTZweDtmb250LXdlaWdodDo5MDA7b3V0bGluZTpub25lO30KLmhpbnR7bWFyZ2luLXRvcDoxMHB4O2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjgwMDtjb2xvcjojNTU1O30KCkBtZWRpYSAob3JpZW50YXRpb246bGFuZHNjYXBlKSBhbmQgKG1heC1oZWlnaHQ6NTIwcHgpewogIC50b3BSb3d7ZGlzcGxheTpub25lO30KICAucmVhZG91dHtnYXA6MnB4O30KICAubm90ZUxpbmV7Zm9udC1zaXplOjMwcHg7fQogIC5mcmVxTGluZXtmb250LXNpemU6MTZweDt9CiAgLmRlbHRhTGluZXtmb250LXNpemU6MTRweDt9CiAgLm1ldGVye2ZsZXg6MTttaW4taGVpZ2h0OjE2MHB4O30KICAuc3RhdHVze2ZvbnQtc2l6ZToxNHB4O3BhZGRpbmc6NnB4O30KfQo8L3N0eWxlPgo8L2hlYWQ+Cgo8Ym9keT4KPGRpdiBjbGFzcz0iYXBwIj4KICA8ZGl2IGNsYXNzPSJ0dW5lciIgaWQ9InR1bmVyUm9vdCI+CiAgICA8ZGl2IGNsYXNzPSJ0b3BSb3ciPgogICAgICA8ZGl2IGNsYXNzPSJwaWxsIj5BNCA8c3BhbiBpZD0icmVmVmFsIj40NDAuMCBIejwvc3Bhbj48L2Rpdj4KICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo4cHg7YWxpZ24taXRlbXM6Y2VudGVyOyI+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIHNlY29uZGFyeSIgaWQ9InJlZkJ0biI+TEEgKEE0KTwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBkYW5nZXIiIGlkPSJzdG9wQnRuIiBzdHlsZT0iZGlzcGxheTpub25lOyI+U1RPUDwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9InJlYWRvdXQiPgogICAgICA8ZGl2IGNsYXNzPSJub3RlTGluZSIgaWQ9Im5vdGVOYW1lIj7igJQ8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iZnJlcUxpbmUiIGlkPSJmcmVxTm93Ij7igJQgSHo8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iZGVsdGFMaW5lIiBpZD0iZGVsdGFOb3ciPjAgY2VudHM8L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9Im1ldGVyIiBpZD0ibWV0ZXIiPgogICAgICA8ZGl2IGNsYXNzPSJzY2FsZSIgaWQ9InNjYWxlIj48L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ibmVlZGxlIiBpZD0ibmVlZGxlIj48L2Rpdj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9InN0YXR1cyIgaWQ9InN0YXR1cyI+VG9jY2EgQVZWSUEgcGVyIGluaXppYXJlPC9kaXY+CiAgPC9kaXY+CjwvZGl2PgoKPGRpdiBjbGFzcz0ib3ZlcmxheSIgaWQ9InN0YXJ0T3ZlcmxheSI+CiAgPGRpdiBjbGFzcz0ib3ZlcmxheUNhcmQiPgogICAgPGgyPkFjY29yZGF0b3JlPC9oMj4KICAgIDxwPgogICAgICBUb2NjYSAiQVZWSUEiIHBlciBhdHRpdmFyZSBpbCBtaWNyb2Zvbm8uPGJyLz4KICAgICAgTEEgZGkgcmlmZXJpbWVudG86IDxiIGlkPSJvdmVybGF5UmVmIj40NDAuMCBIejwvYj4KICAgIDwvcD4KICAgIDxkaXYgY2xhc3M9Im92ZXJsYXlSb3ciPgogICAgICA8YnV0dG9uIGNsYXNzPSJidG4gc2Vjb25kYXJ5IiBpZD0ib3ZlcmxheVJlZkJ0biI+Q2FtYmlhIExBPC9idXR0b24+CiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biIgaWQ9InN0YXJ0QnRuIj5BVlZJQTwvYnV0dG9uPgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJlcnIiIGlkPSJvdmVybGF5RXJyIj48L2Rpdj4KICA8L2Rpdj4KPC9kaXY+Cgo8ZGl2IGNsYXNzPSJyZWZNb2RhbCIgaWQ9InJlZk1vZGFsIj4KICA8ZGl2IGNsYXNzPSJyZWZDYXJkIj4KICAgIDxoMz5JbXBvc3RhIExBIChBNCkgbWFudWFsbWVudGU8L2gzPgogICAgPGRpdiBjbGFzcz0icmVmUm93Ij4KICAgICAgPGlucHV0IGlkPSJyZWZJbnB1dCIgdHlwZT0ibnVtYmVyIiBtaW49IjM4MCIgbWF4PSI1MjAiIHN0ZXA9IjAuMSIgdmFsdWU9IjQ0MC4wIiAvPgogICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJyZWZBcHBseSI+QXBwbGljYTwvYnV0dG9uPgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJoaW50Ij5TdWdnZXJpdGk6IDQ0MCAoc3RhbmRhcmQpLCA0MzIsIDQ0Mi48L2Rpdj4KICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6MTBweDttYXJnaW4tdG9wOjEycHg7Ij4KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIHNlY29uZGFyeSIgaWQ9InJlZkNsb3NlIj5DaGl1ZGk8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvZGl2Pgo8L2Rpdj4KCjxzY3JpcHQ+CiJ1c2Ugc3RyaWN0IjsKCi8vIOKUgOKUgOKUgCBFUlJPUkUgVUkg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACmZ1bmN0aW9uIHNob3dFcnIobXNnKXsgb3ZlcmxheUVyci5zdHlsZS5kaXNwbGF5PSJibG9jayI7IG92ZXJsYXlFcnIudGV4dENvbnRlbnQ9bXNnOyB9CmZ1bmN0aW9uIGhpZGVFcnIoKXsgb3ZlcmxheUVyci5zdHlsZS5kaXNwbGF5PSJub25lIjsgb3ZlcmxheUVyci50ZXh0Q29udGVudD0iIjsgfQoKLy8g4pSA4pSA4pSAIFNUQVRPIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgApsZXQgYXVkaW9Db250ZXh0LCBhbmFseXNlciwgbWljU291cmNlLCBzdHJlYW1SZWYsIHJhZklkOwpsZXQgaXNSdW5uaW5nID0gZmFsc2U7CmxldCByZWZlcmVuY2VBNCA9IDQ0MC4wOwoKLy8g4pSA4pSA4pSAIERPTSDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKY29uc3QgcmVmVmFsICAgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWZWYWwnKTsKY29uc3Qgb3ZlcmxheVJlZiAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5UmVmJyk7CmNvbnN0IG5vdGVOYW1lRWwgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm90ZU5hbWUnKTsKY29uc3QgZnJlcU5vd0VsICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmcmVxTm93Jyk7CmNvbnN0IGRlbHRhTm93RWwgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVsdGFOb3cnKTsKY29uc3Qgc3RhdHVzRWwgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGF0dXMnKTsKY29uc3QgbmVlZGxlRWwgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWVkbGUnKTsKY29uc3Qgc2NhbGVFbCAgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FsZScpOwpjb25zdCBzdG9wQnRuICAgICAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3BCdG4nKTsKY29uc3Qgc3RhcnRPdmVybGF5ICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydE92ZXJsYXknKTsKY29uc3Qgc3RhcnRCdG4gICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydEJ0bicpOwpjb25zdCBvdmVybGF5UmVmQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXlSZWZCdG4nKTsKY29uc3Qgb3ZlcmxheUVyciAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5RXJyJyk7CmNvbnN0IHJlZkJ0biAgICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVmQnRuJyk7CmNvbnN0IHJlZk1vZGFsICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVmTW9kYWwnKTsKY29uc3QgcmVmSW5wdXQgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWZJbnB1dCcpOwpjb25zdCByZWZBcHBseSAgICAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZkFwcGx5Jyk7CmNvbnN0IHJlZkNsb3NlICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVmQ2xvc2UnKTsKCi8vIOKUgOKUgOKUgCBOT1RFIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgApjb25zdCBOT1RFX1NIQVJQID0gWyJDIiwiQyMiLCJEIiwiRCMiLCJFIiwiRiIsIkYjIiwiRyIsIkcjIiwiQSIsIkEjIiwiQiJdOwpjb25zdCBOT1RFX0ZMQVQgID0gWyJDIiwiRGIiLCJEIiwiRWIiLCJFIiwiRiIsIkdiIiwiRyIsIkFiIiwiQSIsIkJiIiwiQiJdOwpjb25zdCBjbGFtcCA9IChuLGEsYikgPT4gTWF0aC5tYXgoYSxNYXRoLm1pbihiLG4pKTsKCmZ1bmN0aW9uIGZyZXFUb01pZGkoZikgIHsgcmV0dXJuIDY5ICsgMTIqTWF0aC5sb2cyKGYvcmVmZXJlbmNlQTQpOyB9CmZ1bmN0aW9uIG1pZGlUb0ZyZXEobSkgIHsgcmV0dXJuIHJlZmVyZW5jZUE0Kk1hdGgucG93KDIsKG0tNjkpLzEyKTsgfQpmdW5jdGlvbiBtaWRpVG9OYW1lKG1pZGksIHByZWZlckZsYXRzKXsKICBjb25zdCBuPU1hdGgucm91bmQobWlkaSk7CiAgY29uc3Qgb2N0YXZlPU1hdGguZmxvb3Iobi8xMiktMTsKICBjb25zdCBpZHg9KG4lMTIrMTIpJTEyOwogIGNvbnN0IG5hbWU9cHJlZmVyRmxhdHM/Tk9URV9GTEFUW2lkeF06Tk9URV9TSEFSUFtpZHhdOwogIHJldHVybiB7bmFtZSxvY3RhdmV9Owp9CmZ1bmN0aW9uIGNlbnRzRGlmZihmcmVxLHRhcmdldCl7IHJldHVybiAxMjAwKk1hdGgubG9nMihmcmVxL3RhcmdldCk7IH0KZnVuY3Rpb24gZm9ybWF0TmFtZUJvdGgobWlkaSl7CiAgY29uc3Qgcz1taWRpVG9OYW1lKG1pZGksZmFsc2UpLCBmPW1pZGlUb05hbWUobWlkaSx0cnVlKTsKICBpZihzLm5hbWUhPT1mLm5hbWUpIHJldHVybiBgJHtzLm5hbWV9JHtzLm9jdGF2ZX0gLyAke2YubmFtZX0ke2Yub2N0YXZlfWA7CiAgcmV0dXJuIGAke3MubmFtZX0ke3Mub2N0YXZlfWA7Cn0KCi8vIOKUgOKUgOKUgCBTQ0FMQSBWSVNJVkEg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACmZ1bmN0aW9uIGdldFpvb21SYW5nZShhYnNDKXsKICBpZihhYnNDPjgwKSAgcmV0dXJuIDE1MDsKICBpZihhYnNDPjQwKSAgcmV0dXJuIDgwOwogIGlmKGFic0M+MjApICByZXR1cm4gNDA7CiAgaWYoYWJzQz4xMCkgIHJldHVybiAyMDsKICBpZihhYnNDPjUpICAgcmV0dXJuIDEwOwogIHJldHVybiA1Owp9CmZ1bmN0aW9uIGRyYXdTY2FsZShyYW5nZSl7CiAgc2NhbGVFbC5pbm5lckhUTUw9IiI7CiAgbGV0IHN0ZXA9MTA7CiAgaWYocmFuZ2U8PTIwKSBzdGVwPTU7CiAgaWYocmFuZ2U8PTEwKSBzdGVwPTI7CiAgaWYocmFuZ2U8PTUpICBzdGVwPTE7CiAgZm9yKGxldCBjPS1yYW5nZTtjPD1yYW5nZTtjKz1zdGVwKXsKICAgIGNvbnN0IG1hcms9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICBtYXJrLmNsYXNzTmFtZT0oYz09PTApPyJtYXJrIGNlbnRlciI6Im1hcmsiOwogICAgY29uc3QgbWFqb3I9KHJhbmdlPj04MCk/MjA6KHJhbmdlPj00MD8xMDoocmFuZ2U+PTIwPzEwOihyYW5nZT49MTA/NToyKSkpOwogICAgaWYoYz09PTAgfHwgKE1hdGguYWJzKGMpJW1ham9yPT09MCkpewogICAgICBjb25zdCBsYWI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpOwogICAgICBsYWIuY2xhc3NOYW1lPSJsYWJlbCI7IGxhYi50ZXh0Q29udGVudD1jOwogICAgICBtYXJrLmFwcGVuZENoaWxkKGxhYik7CiAgICB9CiAgICBzY2FsZUVsLmFwcGVuZENoaWxkKG1hcmspOwogIH0KfQoKLy8g4pSA4pSA4pSAIENPU1RBTlRJIERJIFJJTEVWQVpJT05FIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgApjb25zdCBGRlRfU0laRSA9IDQwOTY7ICAgICAgICAgIC8vIOKGkSBlcmEgMjA0OCDigJQgcGnDuSBjYW1waW9uaSA9IHBpw7kgcmlzb2x1emlvbmUgdGVtcG9yYWxlIHBlciBub3RlIGFjdXRlCmNvbnN0IFJNU19NSU4gID0gMC4wMTU7CmNvbnN0IENPTkZfTUlOID0gMC44MjsgICAgICAgICAgLy8g4oaRIHNvZ2xpYSBwacO5IGFsdGEgcGVyIHJpZHVycmUgZmFsc2kgcG9zaXRpdmkKY29uc3QgTk9URV9IWVNURVJFU0lTX0NFTlRTID0gMjI7CmNvbnN0IFNUQUJMRV9GUkFNRVNfUkVRVUlSRUQgPSAzOwoKLy8gUmFuZ2UgY2hpdGFycmEgc3RhbmRhcmQ6IEUyKDgySHopIOKAkyBFNSgxMzE5SHopCmNvbnN0IEZSRVFfTUlOID0gNzA7CmNvbnN0IEZSRVFfTUFYID0gMTQwMDsKCi8vIOKUgOKUgOKUgCBBTEdPUklUTU8gREkgUElUQ0gg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACi8vIFVzYSBZSU4gc2VtcGxpZmljYXRvICsgY29ycmV6aW9uZSBkJ290dGF2YSB2aWEgSFBTIChIYXJtb25pYyBQcm9kdWN0IFNwZWN0cnVtKQovLyBZSU4gw6ggbW9sdG8gcGnDuSBhY2N1cmF0byBkZWxsJ2F1dG9jb3JyZWxhemlvbmUgc2VtcGxpY2UgcGVyIG5vdGUgYWN1dGUKCmZ1bmN0aW9uIGNhbGNSTVMoYnVmKXsKICBsZXQgcz0wOwogIGZvcihsZXQgaT0wO2k8YnVmLmxlbmd0aDtpKyspIHMrPWJ1ZltpXSpidWZbaV07CiAgcmV0dXJuIE1hdGguc3FydChzL2J1Zi5sZW5ndGgpOwp9CgovLyBEaWZmZXJlbnphIHF1YWRyYXRpY2EgbWVkaWEgKGNvcmUgZGkgWUlOKQpmdW5jdGlvbiB5aW5EaWZmZXJlbmNlKGJ1ZiwgVyl7CiAgY29uc3QgZCA9IG5ldyBGbG9hdDMyQXJyYXkoVyk7CiAgZFswXSA9IDA7CiAgZm9yKGxldCB0YXU9MTt0YXU8Vzt0YXUrKyl7CiAgICBsZXQgcz0wOwogICAgZm9yKGxldCBpPTA7aTxXO2krKyl7CiAgICAgIGNvbnN0IGRpZmYgPSBidWZbaV0gLSBidWZbaSt0YXVdOwogICAgICBzICs9IGRpZmYqZGlmZjsKICAgIH0KICAgIGRbdGF1XSA9IHM7CiAgfQogIHJldHVybiBkOwp9CgovLyBEaWZmZXJlbnphIGN1bXVsYXRpdmEgbm9ybWFsaXp6YXRhCmZ1bmN0aW9uIHlpbkNNTkQoZCl7CiAgY29uc3QgY21uZCA9IG5ldyBGbG9hdDMyQXJyYXkoZC5sZW5ndGgpOwogIGNtbmRbMF0gPSAxOwogIGxldCBydW5uaW5nU3VtID0gMDsKICBmb3IobGV0IHRhdT0xO3RhdTxkLmxlbmd0aDt0YXUrKyl7CiAgICBydW5uaW5nU3VtICs9IGRbdGF1XTsKICAgIGNtbmRbdGF1XSA9IChydW5uaW5nU3VtID09PSAwKSA/IDAgOiBkW3RhdV0gKiB0YXUgLyBydW5uaW5nU3VtOwogIH0KICByZXR1cm4gY21uZDsKfQoKLy8gUGFyYWJvbGljIGludGVycG9sYXRpb24gcGVyIHN1Yi1zYW1wbGUgcHJlY2lzaW9uCmZ1bmN0aW9uIHBhcmFib2xpY0ludGVycChhcnIsIHgpewogIGlmKHg8PTAgfHwgeD49YXJyLmxlbmd0aC0xKSByZXR1cm4geDsKICBjb25zdCBhPWFyclt4LTFdLCBiPWFyclt4XSwgYz1hcnJbeCsxXTsKICBjb25zdCBkZW5vbSA9IDIqKGEgLSAyKmIgKyBjKTsKICBpZihNYXRoLmFicyhkZW5vbSk8MWUtMTApIHJldHVybiB4OwogIHJldHVybiB4ICsgKGEgLSBjKS9kZW5vbTsKfQoKLy8gUmlsZXZhemlvbmUgcGl0Y2ggcHJpbmNpcGFsZSBjb24gWUlOCmZ1bmN0aW9uIGRldGVjdFBpdGNoWUlOKGJ1Ziwgc3IpewogIGNvbnN0IHJtcyA9IGNhbGNSTVMoYnVmKTsKICBpZihybXMgPCBSTVNfTUlOKSByZXR1cm4ge2ZyZXE6LTEsIGNvbmZpZGVuY2U6MCwgcm1zfTsKCiAgY29uc3QgVyA9IE1hdGguZmxvb3IoYnVmLmxlbmd0aCAvIDIpOwogIGNvbnN0IGQgICAgPSB5aW5EaWZmZXJlbmNlKGJ1ZiwgVyk7CiAgY29uc3QgY21uZCA9IHlpbkNNTkQoZCk7CgogIC8vIENhbGNvbGEgdGF1X21pbiBjb3JyaXNwb25kZW50ZSBhIEZSRVFfTUFYCiAgLy8gQ2FsY29sYSB0YXVfbWF4IGNvcnJpc3BvbmRlbnRlIGEgRlJFUV9NSU4KICBjb25zdCB0YXVNaW4gPSBNYXRoLmZsb29yKHNyIC8gRlJFUV9NQVgpOwogIGNvbnN0IHRhdU1heCA9IE1hdGgubWluKFctMSwgTWF0aC5jZWlsKHNyIC8gRlJFUV9NSU4pKTsKCiAgY29uc3QgdGhyZXNob2xkID0gMC4xMDsgLy8gWUlOIHRocmVzaG9sZCDigJQgcGnDuSBiYXNzbyA9IHBpw7kgc2Vuc2liaWxlCgogIC8vIENlcmNhIGlsIHByaW1vIG1pbmltbyBzb3R0byBsYSBzb2dsaWEKICBsZXQgYmVzdFRhdSA9IC0xOwogIGxldCBiZXN0VmFsID0gMTsKCiAgLy8gUHJpbWEgcGFzczogY2VyY2EgbWluaW1vIHNvdHRvIHNvZ2xpYQogIGZvcihsZXQgdGF1PXRhdU1pbjsgdGF1PD10YXVNYXg7IHRhdSsrKXsKICAgIGlmKGNtbmRbdGF1XSA8IHRocmVzaG9sZCl7CiAgICAgIC8vIFZlcmlmaWNhIGNoZSBzaWEgdW4gbWluaW1vIGxvY2FsZQogICAgICB3aGlsZSh0YXUrMTw9dGF1TWF4ICYmIGNtbmRbdGF1KzFdPGNtbmRbdGF1XSkgdGF1Kys7CiAgICAgIGJlc3RUYXUgPSB0YXU7CiAgICAgIGJlc3RWYWwgPSBjbW5kW3RhdV07CiAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgLy8gU2Ugbm9uIHRyb3ZhdG8gc290dG8gc29nbGlhLCB1c2EgaWwgbWluaW1vIGFzc29sdXRvCiAgaWYoYmVzdFRhdSA9PT0gLTEpewogICAgZm9yKGxldCB0YXU9dGF1TWluOyB0YXU8PXRhdU1heDsgdGF1KyspewogICAgICBpZihjbW5kW3RhdV0gPCBiZXN0VmFsKXsgYmVzdFZhbD1jbW5kW3RhdV07IGJlc3RUYXU9dGF1OyB9CiAgICB9CiAgfQoKICBpZihiZXN0VGF1ID09PSAtMSB8fCBiZXN0VmFsID4gMC4zNSkgcmV0dXJuIHtmcmVxOi0xLCBjb25maWRlbmNlOjAsIHJtc307CgogIC8vIFN1Yi1zYW1wbGUgY29uIGludGVycG9sYXppb25lIHBhcmFib2xpY2EKICBjb25zdCB0YXVJbnRlcnAgPSBwYXJhYm9saWNJbnRlcnAoY21uZCwgYmVzdFRhdSk7CiAgY29uc3QgZnJlcSA9IHNyIC8gdGF1SW50ZXJwOwoKICBpZihmcmVxIDwgRlJFUV9NSU4gfHwgZnJlcSA+IEZSRVFfTUFYKSByZXR1cm4ge2ZyZXE6LTEsIGNvbmZpZGVuY2U6MCwgcm1zfTsKCiAgLy8gQ29uZmlkZW5jZTogcGnDuSBiYXNzbyBjbW5kID0gcGnDuSBzaWN1cm87IHNjYWxhIGludmVydGl0YQogIGNvbnN0IGNvbmZpZGVuY2UgPSBjbGFtcCgxIC0gYmVzdFZhbCwgMCwgMSkgKiBjbGFtcChybXMvMC4wNSwgMC4xLCAxKTsKCiAgcmV0dXJuIHtmcmVxLCBjb25maWRlbmNlLCBybXN9Owp9CgovLyDilIDilIDilIAgQ09SUkVaSU9ORSBPVFRBVkEgdmlhIEhQUyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKLy8gU2UgbGEgbm90YSByaWxldmF0YSDDqCB0cm9wcG8gYmFzc2EgcmlzcGV0dG8gYWwgc2VnbmFsZSBGRlQsIGNvcnJlZ2dpIGFsbCdvdHRhdmEgc3VwZXJpb3JlLgovLyBRdWVzdG8gcmlzb2x2ZSBpbCBwcm9ibGVtYSBjbGFzc2ljbyBkaSBjaGl0YXJyYSBkb3ZlIHNpIHJpbGV2YSBsYSBmb25kYW1lbnRhbGUgc2JhZ2xpYXRhLgpmdW5jdGlvbiBjb3JyZWN0T2N0YXZlSFBTKGRldGVjdGVkRnJlcSwgZmZ0QnVmLCBzcil7CiAgaWYoIWZmdEJ1ZiB8fCBmZnRCdWYubGVuZ3RoID09PSAwKSByZXR1cm4gZGV0ZWN0ZWRGcmVxOwoKICAvLyBGdW56aW9uZSBwZXIgb3R0ZW5lcmUgYW1waWV6emEgRkZUIGEgdW5hIGNlcnRhIGZyZXF1ZW56YSAoaW50ZXJwb2xhemlvbmUgbGluZWFyZSkKICBjb25zdCBnZXRBbXAgPSAoZikgPT4gewogICAgY29uc3QgYmluID0gZiAqIGZmdEJ1Zi5sZW5ndGggLyBzcjsKICAgIGNvbnN0IGkgPSBNYXRoLmZsb29yKGJpbik7CiAgICBpZihpPDAgfHwgaT49ZmZ0QnVmLmxlbmd0aC0xKSByZXR1cm4gMDsKICAgIGNvbnN0IGZyYWMgPSBiaW4gLSBpOwogICAgLy8gZmZ0QnVmIGNvbnRpZW5lIGRCIChkYSBnZXRGbG9hdEZyZXF1ZW5jeURhdGEpLCBub3JtYWxpenphCiAgICBjb25zdCBhID0gTWF0aC5wb3coMTAsIGZmdEJ1ZltpXS8yMCk7CiAgICBjb25zdCBiID0gTWF0aC5wb3coMTAsIGZmdEJ1ZltpKzFdLzIwKTsKICAgIHJldHVybiBhKigxLWZyYWMpICsgYipmcmFjOwogIH07CgogIGNvbnN0IGYxID0gZGV0ZWN0ZWRGcmVxOwogIGNvbnN0IGYyID0gZGV0ZWN0ZWRGcmVxICogMjsgLy8gb3R0YXZhIHNvcHJhCiAgaWYoZjIgPiBGUkVRX01BWCkgcmV0dXJuIGYxOwoKICBjb25zdCBhbXAxID0gZ2V0QW1wKGYxKTsKICBjb25zdCBhbXAyID0gZ2V0QW1wKGYyKTsKCiAgLy8gU2UgbCdhcm1vbmljYSAyeCDDqCBzaWduaWZpY2F0aXZhbWVudGUgcGnDuSBmb3J0ZSBkZWxsYSBmb25kYW1lbnRhbGUgcmlsZXZhdGEsCiAgLy8gw6ggcHJvYmFiaWxlIGNoZSBsYSB2ZXJhIGZvbmRhbWVudGFsZSBzaWEgZjIgKHByb2JsZW1hIGRpIHBpdGNoIGRpbWV6emF0bykKICAvLyBQZXIgY2hpdGFycmEsIGxlIGNvcmRlIGFjdXRlIChCIGUgRSkgc3Blc3NvIGhhbm5vIGFybW9uaWNoZSBwacO5IGZvcnRpCiAgaWYoYW1wMiA+IGFtcDEgKiAxLjYpewogICAgLy8gVmVyaWZpY2EgY2hlIGYyIHNpYSB1bmEgbm90YSB2YWxpZGEgZGkgY2hpdGFycmEKICAgIGlmKGYyID49IEZSRVFfTUlOICYmIGYyIDw9IEZSRVFfTUFYKSByZXR1cm4gZjI7CiAgfQoKICByZXR1cm4gZjE7Cn0KCi8vIOKUgOKUgOKUgCBTTU9PVEhJTkcgRSBTVEFUTyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKbGV0IHNtb290aEZyZXE9bnVsbCwgbGFzdFN0YWJsZU1pZGk9bnVsbCwgc3RhYmxlRnJhbWVzPTA7CgpmdW5jdGlvbiBhZGFwdGl2ZUFscGhhKGZyZXEpewogIC8vIFBlciBub3RlIGFjdXRlICg+NTAwSHopIHNtb290aGluZyBwacO5IHZlbG9jZSBwZXIgbm9uIHBlcmRlcmUgc3RhYmlsaXTDoAogIGlmKGZyZXEgPiA1MDApIHJldHVybiAwLjQ1OwogIGlmKGZyZXEgPiAyNTApIHJldHVybiAwLjMyOwogIHJldHVybiAwLjIyOwp9CgovLyDilIDilIDilIAgVVBEQVRFIFVJIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgApsZXQgbGFzdFJhbmdlPTE1MDsKZnVuY3Rpb24gc2V0U3RhdHVzKHR5cGUsdGV4dCl7CiAgc3RhdHVzRWwuY2xhc3NOYW1lPSJzdGF0dXMiKyh0eXBlPygiICIrdHlwZSk6IiIpOwogIHN0YXR1c0VsLnRleHRDb250ZW50PXRleHQ7Cn0KZnVuY3Rpb24gdXBkYXRlVUkoZnJlcSl7CiAgY29uc3QgbWlkaT1mcmVxVG9NaWRpKGZyZXEpOwogIGNvbnN0IG1pZGlSPU1hdGgucm91bmQobWlkaSk7CiAgY29uc3QgdGFyZ2V0PW1pZGlUb0ZyZXEobWlkaVIpOwogIGNvbnN0IGNlbnRzPWNlbnRzRGlmZihmcmVxLHRhcmdldCk7CiAgY29uc3QgYWJzQz1NYXRoLmFicyhjZW50cyk7CiAgY29uc3QgcmFuZ2U9Z2V0Wm9vbVJhbmdlKGFic0MpOwoKICBpZihyYW5nZSE9PWxhc3RSYW5nZSl7IGxhc3RSYW5nZT1yYW5nZTsgZHJhd1NjYWxlKHJhbmdlKTsgfQoKICBjb25zdCBjbGFtcGVkPWNsYW1wKGNlbnRzLC1yYW5nZSxyYW5nZSk7CiAgY29uc3QgbWF4UGN0PTQ4OwogIGNvbnN0IHBjdD0oY2xhbXBlZC9yYW5nZSkqbWF4UGN0OwogIG5lZWRsZUVsLnN0eWxlLmxlZnQ9YGNhbGMoNTAlICsgJHtwY3R9JSlgOwoKICBpZihhYnNDPD0zKSBuZWVkbGVFbC5jbGFzc0xpc3QuYWRkKCJvayIpOyBlbHNlIG5lZWRsZUVsLmNsYXNzTGlzdC5yZW1vdmUoIm9rIik7CgogIG5vdGVOYW1lRWwudGV4dENvbnRlbnQ9Zm9ybWF0TmFtZUJvdGgobWlkaSk7CiAgZnJlcU5vd0VsLnRleHRDb250ZW50PWAke2ZyZXEudG9GaXhlZCgyKX0gSHpgOwogIGRlbHRhTm93RWwudGV4dENvbnRlbnQ9YCR7Y2VudHM+PTA/IisiOiIifSR7TWF0aC5yb3VuZChjZW50cyl9IGNlbnRzYDsKCiAgaWYoYWJzQzw9MykgICAgICBzZXRTdGF0dXMoImdvb2QiLCLinJMgUGVyZmV0dG8gKMKxMyBjZW50cykiKTsKICBlbHNlIGlmKGFic0M8PTgpIHNldFN0YXR1cyhjZW50czwwPyJsb3ciOiJoaWdoIiwgY2VudHM8MD8i4oaTIEFsemEgbGVnZ2VybWVudGUiOiLihpEgQWJiYXNzYSBsZWdnZXJtZW50ZSIpOwogIGVsc2UgICAgICAgICAgICAgc2V0U3RhdHVzKGNlbnRzPDA/ImxvdyI6ImhpZ2giLCBjZW50czwwPyLihpMgVHJvcHBvIGJhc3NhICh0aXJhKSI6IuKGkSBUcm9wcG8gYWx0YSAobW9sbGEpIik7Cn0KCi8vIOKUgOKUgOKUgCBCVUZGRVIgRkZUIFNFUEFSQVRPIHBlciBIUFMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACmNvbnN0IEZGVF9GUkVRX1NJWkUgPSA4MTkyOyAvLyBncmFuZGUgcGVyIHJpc29sdXppb25lIGluIGZyZXF1ZW56YQpsZXQgYW5hbHlzZXJGcmVxOwpjb25zdCBGUkVRX0JVRiA9IG5ldyBGbG9hdDMyQXJyYXkoRkZUX0ZSRVFfU0laRS8yKTsKCi8vIOKUgOKUgOKUgCBCVUZGRVIgUFJJTkNJUEFMRSDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKY29uc3QgQlVGID0gbmV3IEZsb2F0MzJBcnJheShGRlRfU0laRSk7CgovLyDilIDilIDilIAgTE9PUCBQUklOQ0lQQUxFIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgApmdW5jdGlvbiB0aWNrKCl7CiAgaWYoIWlzUnVubmluZykgcmV0dXJuOwoKICBhbmFseXNlci5nZXRGbG9hdFRpbWVEb21haW5EYXRhKEJVRik7CgogIC8vIENvcGlhIGJ1ZmZlciBwZXIgWUlOCiAgY29uc3QgdG1wID0gbmV3IEZsb2F0MzJBcnJheShCVUYpOwoKICAvLyBQaXRjaCBkZXRlY3Rpb24gY29uIFlJTgogIGxldCB7ZnJlcSwgY29uZmlkZW5jZSwgcm1zfSA9IGRldGVjdFBpdGNoWUlOKHRtcCwgYXVkaW9Db250ZXh0LnNhbXBsZVJhdGUpOwoKICBjb25zdCB2YWxpZCA9IChmcmVxID4gRlJFUV9NSU4gJiYgZnJlcSA8IEZSRVFfTUFYICYmIGNvbmZpZGVuY2UgPj0gQ09ORl9NSU4pOwoKICBpZighdmFsaWQpewogICAgc3RhYmxlRnJhbWVzID0gMDsKICAgIHNldFN0YXR1cygiIiwgIkFzY29sdG/igKYgKHN1b25hIHVuYSBub3RhKSIpOwogICAgcmFmSWQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGljayk7CiAgICByZXR1cm47CiAgfQoKICAvLyBDb3JyZXppb25lIG90dGF2YSBjb24gRkZUCiAgaWYoYW5hbHlzZXJGcmVxKXsKICAgIGFuYWx5c2VyRnJlcS5nZXRGbG9hdEZyZXF1ZW5jeURhdGEoRlJFUV9CVUYpOwogICAgZnJlcSA9IGNvcnJlY3RPY3RhdmVIUFMoZnJlcSwgRlJFUV9CVUYsIGF1ZGlvQ29udGV4dC5zYW1wbGVSYXRlKTsKICB9CgogIC8vIFNtb290aGluZyBhZGF0dGl2bwogIGNvbnN0IGFscGhhID0gYWRhcHRpdmVBbHBoYShmcmVxKTsKICBzbW9vdGhGcmVxID0gKHNtb290aEZyZXEgPT0gbnVsbCkgPyBmcmVxIDogKHNtb290aEZyZXEqKDEtYWxwaGEpICsgZnJlcSphbHBoYSk7CgogIGNvbnN0IG1pZGlOb3cgPSBmcmVxVG9NaWRpKHNtb290aEZyZXEpOwogIGNvbnN0IG1pZGlSICAgPSBNYXRoLnJvdW5kKG1pZGlOb3cpOwoKICBpZihsYXN0U3RhYmxlTWlkaSA9PSBudWxsKXsgbGFzdFN0YWJsZU1pZGk9bWlkaVI7IHN0YWJsZUZyYW1lcz0xOyB9CiAgZWxzZXsKICAgIGNvbnN0IHRhcmdldCA9IG1pZGlUb0ZyZXEobGFzdFN0YWJsZU1pZGkpOwogICAgY29uc3QgY2VudHNGcm9tID0gY2VudHNEaWZmKHNtb290aEZyZXEsIHRhcmdldCk7CiAgICBpZihNYXRoLmFicyhjZW50c0Zyb20pIDw9IE5PVEVfSFlTVEVSRVNJU19DRU5UUyl7CiAgICAgIHN0YWJsZUZyYW1lcysrOwogICAgfSBlbHNlIHsKICAgICAgc3RhYmxlRnJhbWVzID0gTWF0aC5tYXgoMCwgc3RhYmxlRnJhbWVzLTEpOwogICAgICBpZihzdGFibGVGcmFtZXMgPD0gMCl7IGxhc3RTdGFibGVNaWRpPW1pZGlSOyBzdGFibGVGcmFtZXM9MTsgfQogICAgfQogIH0KCiAgaWYoc3RhYmxlRnJhbWVzID49IFNUQUJMRV9GUkFNRVNfUkVRVUlSRUQpIHVwZGF0ZVVJKHNtb290aEZyZXEpOwogIGVsc2Ugc2V0U3RhdHVzKCIiLCAiU3RhYmlsaXp6b+KApiIpOwoKICByYWZJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTsKfQoKLy8g4pSA4pSA4pSAIEZVTExTQ1JFRU4g4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACmFzeW5jIGZ1bmN0aW9uIGVudGVyRnVsbHNjcmVlbigpewogIHRyeXsKICAgIGlmKCFkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCl7CiAgICAgIGF3YWl0IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZXF1ZXN0RnVsbHNjcmVlbih7bmF2aWdhdGlvblVJOiJoaWRlIn0pOwogICAgfQogIH1jYXRjaChlKXt9Cn0KYXN5bmMgZnVuY3Rpb24gZXhpdEZ1bGxzY3JlZW4oKXsKICB0cnl7IGlmKGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50KSBhd2FpdCBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpOyB9Y2F0Y2goZSl7fQp9CgovLyDilIDilIDilIAgU1RBUlQg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACmFzeW5jIGZ1bmN0aW9uIHN0YXJ0KCl7CiAgaGlkZUVycigpOwogIGlmKCF3aW5kb3cuaXNTZWN1cmVDb250ZXh0KXsKICAgIHNob3dFcnIoIkVSUk9SRTogbWljcm9mb25vIHJpY2hpZWRlIEhUVFBTLlxuQXByaSBsYSBwYWdpbmEgc3UgaHR0cHM6Ly8gKG5vbiBmaWxlOi8vKS4iKTsKICAgIHJldHVybjsKICB9CiAgaWYoIW5hdmlnYXRvci5tZWRpYURldmljZXMgfHwgIW5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKXsKICAgIHNob3dFcnIoIkVSUk9SRTogZ2V0VXNlck1lZGlhIG5vbiBzdXBwb3J0YXRvIGRhbCBicm93c2VyLiIpOwogICAgcmV0dXJuOwogIH0KCiAgc3RhcnRCdG4uZGlzYWJsZWQ9dHJ1ZTsKICBzdGFydEJ0bi50ZXh0Q29udGVudD0iQVZWSU/igKYiOwoKICB0cnl7CiAgICBzdHJlYW1SZWYgPSBhd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7CiAgICAgIGF1ZGlvOnsgZWNob0NhbmNlbGxhdGlvbjpmYWxzZSwgbm9pc2VTdXBwcmVzc2lvbjpmYWxzZSwgYXV0b0dhaW5Db250cm9sOmZhbHNlIH0KICAgIH0pOwoKICAgIGF1ZGlvQ29udGV4dCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpOwogICAgaWYoYXVkaW9Db250ZXh0LnN0YXRlPT09InN1c3BlbmRlZCIpIGF3YWl0IGF1ZGlvQ29udGV4dC5yZXN1bWUoKTsKCiAgICAvLyBBbmFseXNlciBwcmluY2lwYWxlIHBlciB0aW1lLWRvbWFpbiAoWUlOKQogICAgYW5hbHlzZXIgPSBhdWRpb0NvbnRleHQuY3JlYXRlQW5hbHlzZXIoKTsKICAgIGFuYWx5c2VyLmZmdFNpemUgPSBGRlRfU0laRTsKICAgIGFuYWx5c2VyLnNtb290aGluZ1RpbWVDb25zdGFudCA9IDA7IC8vIG5lc3N1bm8gc21vb3RoaW5nIGludGVybm8g4oCUIGxvIGZhY2NpYW1vIG5vaQoKICAgIC8vIEFuYWx5c2VyIHNlY29uZGFyaW8gcGVyIGZyZXF1ZW56ZSAoSFBTIG9jdGF2ZSBjb3JyZWN0aW9uKQogICAgYW5hbHlzZXJGcmVxID0gYXVkaW9Db250ZXh0LmNyZWF0ZUFuYWx5c2VyKCk7CiAgICBhbmFseXNlckZyZXEuZmZ0U2l6ZSA9IEZGVF9GUkVRX1NJWkU7CiAgICBhbmFseXNlckZyZXEuc21vb3RoaW5nVGltZUNvbnN0YW50ID0gMC41OwoKICAgIC8vIEZpbHRybyBwYXNzYS1hbHRvOiBlbGltaW5hIHJ1bW9yaSBzb3R0byB+NzBIeiAoYm90dGksIHZpYnJhemlvbmksIEFDKQogICAgY29uc3QgaGlwYXNzID0gYXVkaW9Db250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpOwogICAgaGlwYXNzLnR5cGUgPSAiaGlnaHBhc3MiOwogICAgaGlwYXNzLmZyZXF1ZW5jeS52YWx1ZSA9IDcwOwogICAgaGlwYXNzLlEudmFsdWUgPSAwLjc7CgogICAgLy8gRmlsdHJvIHBhc3NhLWJhc3NvOiBlbGltaW5hIGZyZXF1ZW56ZSBzb3ByYSByYW5nZSBjaGl0YXJyYSAofjE0MDBIeikKICAgIGNvbnN0IGxvcGFzcyA9IGF1ZGlvQ29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTsKICAgIGxvcGFzcy50eXBlID0gImxvd3Bhc3MiOwogICAgbG9wYXNzLmZyZXF1ZW5jeS52YWx1ZSA9IDE0MDA7CiAgICBsb3Bhc3MuUS52YWx1ZSA9IDAuNzsKCiAgICBtaWNTb3VyY2UgPSBhdWRpb0NvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2Uoc3RyZWFtUmVmKTsKICAgIG1pY1NvdXJjZS5jb25uZWN0KGhpcGFzcyk7CiAgICBoaXBhc3MuY29ubmVjdChsb3Bhc3MpOwogICAgbG9wYXNzLmNvbm5lY3QoYW5hbHlzZXIpOwogICAgbG9wYXNzLmNvbm5lY3QoYW5hbHlzZXJGcmVxKTsKCiAgICBpc1J1bm5pbmcgPSB0cnVlOwogICAgc21vb3RoRnJlcT1udWxsOyBsYXN0U3RhYmxlTWlkaT1udWxsOyBzdGFibGVGcmFtZXM9MDsKCiAgICBsYXN0UmFuZ2UgPSA5OTk7CiAgICBkcmF3U2NhbGUoMTUwKTsKICAgIGxhc3RSYW5nZSA9IDE1MDsKCiAgICBzZXRTdGF0dXMoIiIsICJBc2NvbHRv4oCmIChzdW9uYSB1bmEgbm90YSkiKTsKICAgIHN0b3BCdG4uc3R5bGUuZGlzcGxheT0iaW5saW5lLWZsZXgiOwogICAgc3RhcnRPdmVybGF5LnN0eWxlLmRpc3BsYXk9Im5vbmUiOwoKICAgIGF3YWl0IGVudGVyRnVsbHNjcmVlbigpOwoKICAgIGlmKHJhZklkKSBjYW5jZWxBbmltYXRpb25GcmFtZShyYWZJZCk7CiAgICByYWZJZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTsKCiAgfWNhdGNoKGVycil7CiAgICBjb25zb2xlLmVycm9yKGVycik7CiAgICBjb25zdCBuYW1lID0gZXJyICYmIGVyci5uYW1lID8gZXJyLm5hbWUgOiAiIjsKICAgIGxldCBtc2cgPSAiUGVybWVzc28gbWljcm9mb25vIG5lZ2F0by9ub24gZGlzcG9uaWJpbGUuXG4iOwogICAgaWYobmFtZT09PSJOb3RBbGxvd2VkRXJyb3IifHxuYW1lPT09IlNlY3VyaXR5RXJyb3IiKSBtc2crPSJDb25zZW50aSBpbCBtaWNyb2Zvbm8gKGx1Y2NoZXR0byBkZWwgYnJvd3NlcikgZSByaWNhcmljYS4iOwogICAgZWxzZSBpZihuYW1lPT09Ik5vdEZvdW5kRXJyb3IiKSBtc2crPSJOZXNzdW4gbWljcm9mb25vIHJpbGV2YXRvIHN1bCBkaXNwb3NpdGl2by4iOwogICAgZWxzZSBpZihuYW1lPT09Ik5vdFJlYWRhYmxlRXJyb3IiKSBtc2crPSJNaWNyb2Zvbm8gb2NjdXBhdG8gZGEgdW4nYWx0cmEgYXBwLiBDaGl1ZGkgYWx0cmUgYXBwIGUgcmlwcm92YS4iOwogICAgZWxzZSBtc2crPSJSaXByb3ZhIG8gY2FtYmlhIGJyb3dzZXIgKENocm9tZS9FZGdlL1NhZmFyaSkuIjsKICAgIHNob3dFcnIobXNnKTsKICAgIHN0YXJ0T3ZlcmxheS5zdHlsZS5kaXNwbGF5PSJmbGV4IjsKICB9IGZpbmFsbHkgewogICAgc3RhcnRCdG4uZGlzYWJsZWQ9ZmFsc2U7CiAgICBzdGFydEJ0bi50ZXh0Q29udGVudD0iQVZWSUEiOwogIH0KfQoKLy8g4pSA4pSA4pSAIFNUT1Ag4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSACmZ1bmN0aW9uIHN0b3AoKXsKICBpc1J1bm5pbmc9ZmFsc2U7CiAgaWYocmFmSWQpIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHJhZklkKTsKICByYWZJZD1udWxsOwoKICB0cnl7IGlmKG1pY1NvdXJjZSkgbWljU291cmNlLmRpc2Nvbm5lY3QoKTsgfWNhdGNoKGUpe30KICB0cnl7IGlmKGF1ZGlvQ29udGV4dCkgYXVkaW9Db250ZXh0LmNsb3NlKCk7IH1jYXRjaChlKXt9CiAgaWYoc3RyZWFtUmVmKXsgdHJ5eyBzdHJlYW1SZWYuZ2V0VHJhY2tzKCkuZm9yRWFjaCh0PT50LnN0b3AoKSk7IH1jYXRjaChlKXt9IH0KCiAgbWljU291cmNlPW51bGw7IGFuYWx5c2VyPW51bGw7IGFuYWx5c2VyRnJlcT1udWxsOyBhdWRpb0NvbnRleHQ9bnVsbDsgc3RyZWFtUmVmPW51bGw7CiAgc21vb3RoRnJlcT1udWxsOyBsYXN0U3RhYmxlTWlkaT1udWxsOyBzdGFibGVGcmFtZXM9MDsKCiAgc3RvcEJ0bi5zdHlsZS5kaXNwbGF5PSJub25lIjsKICBzZXRTdGF0dXMoIiIsICJGZXJtYXRvIik7CiAgbm90ZU5hbWVFbC50ZXh0Q29udGVudD0i4oCUIjsKICBmcmVxTm93RWwudGV4dENvbnRlbnQ9IuKAlCBIeiI7CiAgZGVsdGFOb3dFbC50ZXh0Q29udGVudD0iMCBjZW50cyI7CiAgbmVlZGxlRWwuc3R5bGUubGVmdD0iNTAlIjsKICBuZWVkbGVFbC5jbGFzc0xpc3QucmVtb3ZlKCJvayIpOwoKICBzdGFydE92ZXJsYXkuc3R5bGUuZGlzcGxheT0iZmxleCI7CiAgZXhpdEZ1bGxzY3JlZW4oKTsKfQoKLy8g4pSA4pSA4pSAIFJJRkVSSU1FTlRPIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgApmdW5jdGlvbiBzZXRSZWZlcmVuY2UodmFsKXsKICByZWZlcmVuY2VBNCA9IGNsYW1wKE51bWJlcih2YWx8fDQ0MCksIDM4MCwgNTIwKTsKICByZWZWYWwudGV4dENvbnRlbnQgID0gYCR7cmVmZXJlbmNlQTQudG9GaXhlZCgxKX0gSHpgOwogIG92ZXJsYXlSZWYudGV4dENvbnRlbnQgPSBgJHtyZWZlcmVuY2VBNC50b0ZpeGVkKDEpfSBIemA7CiAgcmVmSW5wdXQudmFsdWUgPSByZWZlcmVuY2VBNC50b0ZpeGVkKDEpOwp9CnNldFJlZmVyZW5jZSg0NDApOwoKZnVuY3Rpb24gb3BlblJlZk1vZGFsKCl7IHJlZk1vZGFsLmNsYXNzTGlzdC5hZGQoInNob3ciKTsgfQpmdW5jdGlvbiBjbG9zZVJlZk1vZGFsKCl7IHJlZk1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoInNob3ciKTsgfQoKLy8g4pSA4pSA4pSAIEVWRU5USSDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIAKc3RhcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBzdGFydCk7CnN0b3BCdG4uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBzdG9wKTsKb3ZlcmxheVJlZkJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIG9wZW5SZWZNb2RhbCk7CnJlZkJ0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIG9wZW5SZWZNb2RhbCk7CnJlZkFwcGx5LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCk9Pnsgc2V0UmVmZXJlbmNlKHJlZklucHV0LnZhbHVlKTsgY2xvc2VSZWZNb2RhbCgpOyB9KTsKcmVmQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBjbG9zZVJlZk1vZGFsKTsKcmVmTW9kYWwuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoZSk9PnsgaWYoZS50YXJnZXQ9PT1yZWZNb2RhbCkgY2xvc2VSZWZNb2RhbCgpOyB9KTsKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigidmlzaWJpbGl0eWNoYW5nZSIsICgpPT57IGlmKGRvY3VtZW50LmhpZGRlbiAmJiBpc1J1bm5pbmcpIHN0b3AoKTsgfSk7CgpzdGFydE92ZXJsYXkuc3R5bGUuZGlzcGxheT0iZmxleCI7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4="}, "02": {"title": "Loop", "b64": "PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9Iml0Ij4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0idXRmLTgiIC8+CiAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCxpbml0aWFsLXNjYWxlPTEiIC8+CiAgPHRpdGxlPk1hcmFjYWxvb3AgQSDigJQgOCBUcmFjY2U8L3RpdGxlPgogIDxzdHlsZT4KICAgIEBpbXBvcnQgdXJsKCdodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PVNwYWNlK01vbm86d2dodEA0MDA7NzAwJmZhbWlseT1ETStTYW5zOndnaHRAMzAwOzQwMDs2MDAmZGlzcGxheT1zd2FwJyk7CgogICAgOnJvb3R7CiAgICAgIC0tYmc6IzA4MGIxMDsgLS1wYW5lbDojMGUxNDIwOyAtLXRleHQ6I2U4ZWVmZjsKICAgICAgLS1tdXRlZDojNmE3ODk5OyAtLXJlZDojZmYzYTNhOyAtLWdyZWVuOiMyZGZmOGY7CiAgICAgIC0tY3lhbjojMDBkNGZmOyAtLW9yYW5nZTojZmZhYTAwOwogICAgICAtLXN0cm9rZTojMWUyODQwOyAtLXN0cm9rZTI6IzE1MWMyZTsgLS1yOjE2cHg7CiAgICB9CiAgICAqe2JveC1zaXppbmc6Ym9yZGVyLWJveDttYXJnaW46MDtwYWRkaW5nOjB9CiAgICBib2R5ewogICAgICBmb250LWZhbWlseTonRE0gU2Fucycsc2Fucy1zZXJpZjsKICAgICAgYmFja2dyb3VuZDp2YXIoLS1iZyk7CiAgICAgIGJhY2tncm91bmQtaW1hZ2U6CiAgICAgICAgcmFkaWFsLWdyYWRpZW50KGVsbGlwc2UgODAwcHggNDAwcHggYXQgMjAlIDEwJSxyZ2JhKDAsMTAwLDI1NSwuMDcpIDAlLHRyYW5zcGFyZW50IDcwJSksCiAgICAgICAgcmFkaWFsLWdyYWRpZW50KGVsbGlwc2UgNjAwcHggNDAwcHggYXQgODAlIDYwJSxyZ2JhKDAsMjIwLDEwMCwuMDUpIDAlLHRyYW5zcGFyZW50IDcwJSk7CiAgICAgIGNvbG9yOnZhcigtLXRleHQpOyBtaW4taGVpZ2h0OjEwMHZoOwogICAgfQogICAgaGVhZGVyewogICAgICBtYXgtd2lkdGg6MTEyMHB4OyBtYXJnaW46MCBhdXRvOyBwYWRkaW5nOjE4cHggMjBweCAxMnB4OwogICAgICBkaXNwbGF5OmZsZXg7IGFsaWduLWl0ZW1zOmNlbnRlcjsganVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47CiAgICAgIGZsZXgtd3JhcDp3cmFwOyBnYXA6MTJweDsgYm9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tc3Ryb2tlKTsKICAgIH0KICAgIC5sb2dve2ZvbnQtZmFtaWx5OidTcGFjZSBNb25vJyxtb25vc3BhY2U7Zm9udC1zaXplOjIwcHg7Zm9udC13ZWlnaHQ6NzAwO2xldHRlci1zcGFjaW5nOi4xNWVtO30KICAgIC5sb2dvIHNwYW57Y29sb3I6dmFyKC0tY3lhbik7fQogICAgLnRvcC1jb250cm9sc3tkaXNwbGF5OmZsZXg7Z2FwOjEwcHg7ZmxleC13cmFwOndyYXA7YWxpZ24taXRlbXM6Y2VudGVyO30KICAgIHNlbGVjdHsKICAgICAgZm9udDppbmhlcml0O2JhY2tncm91bmQ6dmFyKC0tcGFuZWwpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tc3Ryb2tlKTsKICAgICAgY29sb3I6dmFyKC0tdGV4dCk7cGFkZGluZzo4cHggMTJweDtib3JkZXItcmFkaXVzOjEwcHg7b3V0bGluZTpub25lO2N1cnNvcjpwb2ludGVyOwogICAgfQogICAgc2VsZWN0OmZvY3Vze2JvcmRlci1jb2xvcjpyZ2JhKDAsMjEyLDI1NSwuNCk7fQogICAgYnV0dG9uewogICAgICBmb250OmluaGVyaXQ7Y3Vyc29yOnBvaW50ZXI7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1zdHJva2UpOwogICAgICBiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KTtwYWRkaW5nOjhweCAxNHB4OwogICAgICBib3JkZXItcmFkaXVzOjEwcHg7dHJhbnNpdGlvbjpiYWNrZ3JvdW5kIC4xNXMsYm9yZGVyLWNvbG9yIC4xNXMsdHJhbnNmb3JtIC4wNnM7CiAgICAgIGRpc3BsYXk6aW5saW5lLWZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo2cHg7CiAgICB9CiAgICBidXR0b246YWN0aXZle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDFweCk7fQogICAgYnV0dG9uOmhvdmVye2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuMDYpO30KICAgIGJ1dHRvbjpkaXNhYmxlZHtvcGFjaXR5Oi4zNTtjdXJzb3I6bm90LWFsbG93ZWQ7cG9pbnRlci1ldmVudHM6bm9uZTt9CiAgICAuYnRuLWluaXR7Ym9yZGVyLWNvbG9yOnJnYmEoMCwyMTIsMjU1LC40KTtjb2xvcjp2YXIoLS1jeWFuKTt9CiAgICAuYnRuLXBsYXl7Ym9yZGVyLWNvbG9yOnJnYmEoNDUsMjU1LDE0MywuNCk7Y29sb3I6dmFyKC0tZ3JlZW4pO30KICAgIC5idG4tc3RvcHtib3JkZXItY29sb3I6cmdiYSgyNTUsNTgsNTgsLjMpO2NvbG9yOiNmZjgwODA7fQoKICAgIC5zdGF0dXNiYXJ7CiAgICAgIG1heC13aWR0aDoxMTIwcHg7bWFyZ2luOjAgYXV0bztwYWRkaW5nOjEwcHggMjBweDsKICAgICAgZGlzcGxheTpmbGV4O2dhcDoxMHB4O2ZsZXgtd3JhcDp3cmFwO2FsaWduLWl0ZW1zOmNlbnRlcjsKICAgIH0KICAgIC5iYWRnZXsKICAgICAgZm9udC1mYW1pbHk6J1NwYWNlIE1vbm8nLG1vbm9zcGFjZTtmb250LXNpemU6MTFweDsKICAgICAgcGFkZGluZzo1cHggMTBweDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLXN0cm9rZSk7CiAgICAgIGJhY2tncm91bmQ6cmdiYSgwLDAsMCwuMyk7Ym9yZGVyLXJhZGl1czo5OTlweDsKICAgICAgZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjdweDtjb2xvcjp2YXIoLS1tdXRlZCk7CiAgICB9CiAgICAuZG90e3dpZHRoOjhweDtoZWlnaHQ6OHB4O2JvcmRlci1yYWRpdXM6NTAlO2JhY2tncm91bmQ6IzMzMztmbGV4LXNocmluazowO30KICAgIC5kb3Qub257YmFja2dyb3VuZDp2YXIoLS1ncmVlbik7Ym94LXNoYWRvdzowIDAgNnB4IHZhcigtLWdyZWVuKTt9CgogICAgLm1ldHJvLWJhcnsKICAgICAgbWF4LXdpZHRoOjExMjBweDttYXJnaW46MCBhdXRvOwogICAgICBwYWRkaW5nOjE0cHggMjBweCAxNnB4OwogICAgICBib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1zdHJva2UpOwogICAgICBkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxNHB4O2ZsZXgtd3JhcDp3cmFwOwogICAgfQogICAgLm1ldHJvLWxhYmVsewogICAgICBmb250LWZhbWlseTonU3BhY2UgTW9ubycsbW9ub3NwYWNlO2ZvbnQtc2l6ZToxMnB4OwogICAgICBjb2xvcjp2YXIoLS1tdXRlZCk7d2hpdGUtc3BhY2U6bm93cmFwO2xldHRlci1zcGFjaW5nOi4xZW07CiAgICB9CiAgICAubGVkLXN0cmlwewogICAgICBkaXNwbGF5OmZsZXg7Z2FwOjRweDthbGlnbi1pdGVtczpjZW50ZXI7ZmxleDoxO21pbi13aWR0aDoxNjBweDsKICAgIH0KICAgIC5sZWR7CiAgICAgIGZsZXg6MTtoZWlnaHQ6MjBweDtib3JkZXItcmFkaXVzOjVweDsKICAgICAgYmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LC4wNCk7CiAgICAgIGJvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMDYpOwogICAgICB0cmFuc2l0aW9uOmJhY2tncm91bmQgLjA1cyxib3gtc2hhZG93IC4wNXM7CiAgICAgIHBvc2l0aW9uOnJlbGF0aXZlOwogICAgfQogICAgLmxlZC5iZWF0MXtib3JkZXItY29sb3I6cmdiYSgyNTUsNTgsNTgsLjIpO30KICAgIC5sZWQubGl0ewogICAgICBiYWNrZ3JvdW5kOnJnYmEoMjU1LDU4LDU4LC44NSk7CiAgICAgIGJveC1zaGFkb3c6MCAwIDhweCByZ2JhKDI1NSw1OCw1OCwuNyk7CiAgICB9CiAgICAubGVkLmJlYXQxLmxpdHsKICAgICAgYmFja2dyb3VuZDojZmY1NTU1OwogICAgICBib3gtc2hhZG93OjAgMCAxNnB4IHJnYmEoMjU1LDU4LDU4LC45KSwwIDAgNHB4IHJnYmEoMjU1LDU4LDU4LC42KTsKICAgIH0KICAgIC5sZWQgLmJlYXQtbnsKICAgICAgcG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7CiAgICAgIGZvbnQtZmFtaWx5OidTcGFjZSBNb25vJyxtb25vc3BhY2U7Zm9udC1zaXplOjlweDtmb250LXdlaWdodDo3MDA7CiAgICAgIGNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjI1KTtwb2ludGVyLWV2ZW50czpub25lOwogICAgfQogICAgLmxlZC5saXQgLmJlYXQtbiwubGVkLmJlYXQxLmxpdCAuYmVhdC1ue2NvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjgpO30KCiAgICAubGVkLXNlcHt3aWR0aDoxcHg7aGVpZ2h0OjIwcHg7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LC4wOCk7ZmxleC1zaHJpbms6MDt9CgogICAgLmJwbS13cmFwe2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjhweDtmbGV4LXNocmluazowO30KICAgIC5icG0td3JhcCBsYWJlbHtmb250LWZhbWlseTonU3BhY2UgTW9ubycsbW9ub3NwYWNlO2ZvbnQtc2l6ZToxMnB4O2NvbG9yOnZhcigtLW11dGVkKTt9CiAgICBpbnB1dFt0eXBlPSJudW1iZXIiXXsKICAgICAgZm9udDppbmhlcml0O3dpZHRoOjcwcHg7YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7CiAgICAgIGJvcmRlcjoxcHggc29saWQgdmFyKC0tc3Ryb2tlKTtjb2xvcjp2YXIoLS10ZXh0KTsKICAgICAgcGFkZGluZzo3cHggMTBweDtib3JkZXItcmFkaXVzOjEwcHg7b3V0bGluZTpub25lO3RleHQtYWxpZ246Y2VudGVyOwogICAgfQogICAgaW5wdXRbdHlwZT0ibnVtYmVyIl06Zm9jdXN7Ym9yZGVyLWNvbG9yOnJnYmEoMjU1LDU4LDU4LC41KTt9CiAgICAubWV0cm8tdG9nZ2xlewogICAgICBmb250LWZhbWlseTonU3BhY2UgTW9ubycsbW9ub3NwYWNlO2ZvbnQtc2l6ZToxMnB4OwogICAgICBwYWRkaW5nOjdweCAxNHB4O2JvcmRlci1yYWRpdXM6MTBweDsKICAgICAgYm9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSw1OCw1OCwuMzUpO2NvbG9yOiNmZjgwODA7CiAgICAgIHdoaXRlLXNwYWNlOm5vd3JhcDsKICAgIH0KICAgIC5tZXRyby10b2dnbGUuYWN0aXZlewogICAgICBiYWNrZ3JvdW5kOnJnYmEoMjU1LDU4LDU4LC4xMik7CiAgICAgIGJvcmRlci1jb2xvcjpyZ2JhKDI1NSw1OCw1OCwuNik7Y29sb3I6dmFyKC0tcmVkKTsKICAgIH0KICAgIC5iZWF0LW51bXsKICAgICAgZm9udC1mYW1pbHk6J1NwYWNlIE1vbm8nLG1vbm9zcGFjZTtmb250LXNpemU6MjJweDtmb250LXdlaWdodDo3MDA7CiAgICAgIGNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjE1KTttaW4td2lkdGg6MzJweDt0ZXh0LWFsaWduOmNlbnRlcjsKICAgICAgdHJhbnNpdGlvbjpjb2xvciAuMDVzOwogICAgfQogICAgLmJlYXQtbnVtLmZsYXNoe2NvbG9yOnZhcigtLXJlZCk7fQoKICAgIG1haW57CiAgICAgIG1heC13aWR0aDoxMTIwcHg7bWFyZ2luOjAgYXV0bzsKICAgICAgcGFkZGluZzoxOHB4IDIwcHggMjRweDsKICAgICAgZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczpyZXBlYXQoNCwxZnIpO2dhcDoxNHB4OwogICAgfQogICAgQG1lZGlhKG1heC13aWR0aDo5ODBweCl7bWFpbntncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KDIsMWZyKTt9fQogICAgQG1lZGlhKG1heC13aWR0aDo1MjBweCl7bWFpbntncmlkLXRlbXBsYXRlLWNvbHVtbnM6MWZyO319CgogICAgLnRyYWNrewogICAgICBiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLXN0cm9rZSk7CiAgICAgIGJvcmRlci1yYWRpdXM6dmFyKC0tcik7cGFkZGluZzoxM3B4OwogICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW47dHJhbnNpdGlvbjpib3JkZXItY29sb3IgLjJzOwogICAgfQogICAgLnRyYWNrLmlzLXJlY3tib3JkZXItY29sb3I6cmdiYSgyNTUsNTgsNTgsLjUpO30KICAgIC50cmFjay5pcy1jb3VudGlue2JvcmRlci1jb2xvcjpyZ2JhKDI1NSwxNzAsMCwuNSk7fQogICAgLnRyYWNrLmlzLXBsYXl7Ym9yZGVyLWNvbG9yOnJnYmEoMCwyMTIsMjU1LC40KTt9CiAgICAudHJhY2suaGFzLWJ1ZmZlcntib3JkZXItY29sb3I6cmdiYSg0NSwyNTUsMTQzLC4yNSk7fQoKICAgIC50cmFjay1nbG93ewogICAgICBwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowO3BvaW50ZXItZXZlbnRzOm5vbmU7b3BhY2l0eTowO3RyYW5zaXRpb246b3BhY2l0eSAuM3M7CiAgICAgIGJhY2tncm91bmQ6cmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCA1MCUgMCUscmdiYSgyNTUsNTgsNTgsLjA4KSx0cmFuc3BhcmVudCA2MCUpOwogICAgfQogICAgLnRyYWNrLmlzLXJlYyAudHJhY2stZ2xvd3tvcGFjaXR5OjE7fQogICAgLnRyYWNrLmlzLWNvdW50aW4gLnRyYWNrLWdsb3d7CiAgICAgIGJhY2tncm91bmQ6cmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCA1MCUgMCUscmdiYSgyNTUsMTcwLDAsLjEpLHRyYW5zcGFyZW50IDYwJSk7CiAgICAgIG9wYWNpdHk6MTsKICAgIH0KICAgIC50cmFjay5pcy1wbGF5IC50cmFjay1nbG93ewogICAgICBiYWNrZ3JvdW5kOnJhZGlhbC1ncmFkaWVudChjaXJjbGUgYXQgNTAlIDAlLHJnYmEoMCwyMTIsMjU1LC4wNyksdHJhbnNwYXJlbnQgNjAlKTsKICAgICAgb3BhY2l0eToxOwogICAgfQogICAgLnRyYWNrPio6bm90KC50cmFjay1nbG93KXtwb3NpdGlvbjpyZWxhdGl2ZTt9CgogICAgLnRyYWNrLWhlYWR7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmZsZXgtc3RhcnQ7bWFyZ2luLWJvdHRvbTo4cHg7fQogICAgLnRyYWNrLW51bXtmb250LWZhbWlseTonU3BhY2UgTW9ubycsbW9ub3NwYWNlO2ZvbnQtc2l6ZToyMnB4O2ZvbnQtd2VpZ2h0OjcwMDtjb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC4xMik7bGluZS1oZWlnaHQ6MTt9CiAgICAudHJhY2stc3RhdGV7CiAgICAgIGZvbnQtc2l6ZToxMHB4O2ZvbnQtZmFtaWx5OidTcGFjZSBNb25vJyxtb25vc3BhY2U7CiAgICAgIHBhZGRpbmc6M3B4IDdweDtib3JkZXItcmFkaXVzOjk5OXB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tc3Ryb2tlMik7CiAgICAgIGNvbG9yOnZhcigtLW11dGVkKTtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjMpO2xldHRlci1zcGFjaW5nOi4wNWVtOwogICAgfQogICAgLnRyYWNrLXN0YXRlLnMtcmVje2JvcmRlci1jb2xvcjpyZ2JhKDI1NSw1OCw1OCwuNSk7Y29sb3I6I2ZmODA4MDt9CiAgICAudHJhY2stc3RhdGUucy1jb3VudGlue2JvcmRlci1jb2xvcjpyZ2JhKDI1NSwxNzAsMCwuNSk7Y29sb3I6dmFyKC0tb3JhbmdlKTt9CiAgICAudHJhY2stc3RhdGUucy1wbGF5e2JvcmRlci1jb2xvcjpyZ2JhKDAsMjEyLDI1NSwuNCk7Y29sb3I6dmFyKC0tY3lhbik7fQogICAgLnRyYWNrLXN0YXRlLnMtcmVhZHl7Ym9yZGVyLWNvbG9yOnJnYmEoNDUsMjU1LDE0MywuMyk7Y29sb3I6dmFyKC0tZ3JlZW4pO30KCiAgICAudHJhY2stbGVkc3tkaXNwbGF5OmZsZXg7Z2FwOjNweDttYXJnaW4tYm90dG9tOjdweDt9CiAgICAudC1sZWR7CiAgICAgIGZsZXg6MTtoZWlnaHQ6NXB4O2JvcmRlci1yYWRpdXM6M3B4OwogICAgICBiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsLjA1KTsKICAgICAgdHJhbnNpdGlvbjpiYWNrZ3JvdW5kIC4wNnMsYm94LXNoYWRvdyAuMDZzOwogICAgfQogICAgLnQtbGVkLmxpdHtiYWNrZ3JvdW5kOnZhcigtLW9yYW5nZSk7Ym94LXNoYWRvdzowIDAgNHB4IHZhcigtLW9yYW5nZSk7fQogICAgLnQtbGVkLmRvbmV7YmFja2dyb3VuZDp2YXIoLS1yZWQpO2JveC1zaGFkb3c6MCAwIDRweCB2YXIoLS1yZWQpO30KCiAgICAuYnRuLW1haW4td3JhcHtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjttYXJnaW46NXB4IDAgOHB4O30KICAgIC5idG4tbWFpbnsKICAgICAgd2lkdGg6OTBweDtoZWlnaHQ6OTBweDtib3JkZXItcmFkaXVzOjUwJTsKICAgICAgYm9yZGVyOjJweCBzb2xpZCB2YXIoLS1zdHJva2UpO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMzUpOwogICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtjdXJzb3I6cG9pbnRlcjsKICAgICAgdHJhbnNpdGlvbjpib3JkZXItY29sb3IgLjJzLHRyYW5zZm9ybSAuMXM7CiAgICAgIGRpc3BsYXk6Z3JpZDtwbGFjZS1pdGVtczpjZW50ZXI7CiAgICB9CiAgICAuYnRuLW1haW46aG92ZXJ7dHJhbnNmb3JtOnNjYWxlKDEuMDQpO30KICAgIC5idG4tbWFpbjphY3RpdmV7dHJhbnNmb3JtOnNjYWxlKC45Nyk7fQogICAgLnNwaW4tcmluZ3sKICAgICAgcG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6LTZweDtib3JkZXItcmFkaXVzOjUwJTsKICAgICAgYm9yZGVyOjNweCBzb2xpZCB0cmFuc3BhcmVudDsKICAgICAgYm9yZGVyLXRvcC1jb2xvcjp2YXIoLS1yZWQpO2JvcmRlci1yaWdodC1jb2xvcjpyZ2JhKDI1NSw1OCw1OCwuMyk7CiAgICAgIG9wYWNpdHk6MDt0cmFuc2l0aW9uOm9wYWNpdHkgLjJzOwogICAgfQogICAgLnRyYWNrLmlzLXJlYyAuc3Bpbi1yaW5ne29wYWNpdHk6MTthbmltYXRpb246c3BpbiAxLjJzIGxpbmVhciBpbmZpbml0ZTt9CiAgICAudHJhY2suaXMtY291bnRpbiAuc3Bpbi1yaW5newogICAgICBib3JkZXItdG9wLWNvbG9yOnZhcigtLW9yYW5nZSk7Ym9yZGVyLXJpZ2h0LWNvbG9yOnJnYmEoMjU1LDE3MCwwLC4zKTsKICAgICAgb3BhY2l0eToxO2FuaW1hdGlvbjpzcGluIDAuNnMgbGluZWFyIGluZmluaXRlOwogICAgfQogICAgLnRyYWNrLmlzLXBsYXkgLnNwaW4tcmluZ3sKICAgICAgYm9yZGVyLXRvcC1jb2xvcjp2YXIoLS1jeWFuKTtib3JkZXItcmlnaHQtY29sb3I6cmdiYSgwLDIxMiwyNTUsLjMpOwogICAgICBvcGFjaXR5OjE7YW5pbWF0aW9uOnNwaW4gMnMgbGluZWFyIGluZmluaXRlOwogICAgfQogICAgQGtleWZyYW1lcyBzcGlue3Rve3RyYW5zZm9ybTpyb3RhdGUoMzYwZGVnKTt9fQogICAgLmJ0bi1tYWluIHN2Z3t3aWR0aDozMnB4O2hlaWdodDozMnB4O30KCiAgICAudHJhY2staW5mb3sKICAgICAgZm9udC1zaXplOjExcHg7Y29sb3I6dmFyKC0tbXV0ZWQpO3RleHQtYWxpZ246Y2VudGVyOwogICAgICBtaW4taGVpZ2h0OjE0cHg7bWFyZ2luLWJvdHRvbTo4cHg7Zm9udC1mYW1pbHk6J1NwYWNlIE1vbm8nLG1vbm9zcGFjZTsKICAgIH0KCiAgICAuY291bnRpbi1yb3d7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6NXB4O21hcmdpbi1ib3R0b206OHB4O30KICAgIC5jaS1sYmx7Zm9udC1zaXplOjlweDtmb250LWZhbWlseTonU3BhY2UgTW9ubycsbW9ub3NwYWNlO2NvbG9yOnZhcigtLW11dGVkKTt3aGl0ZS1zcGFjZTpub3dyYXA7fQogICAgLmNpLWJ0bnsKICAgICAgZm9udC1zaXplOjEwcHg7Zm9udC1mYW1pbHk6J1NwYWNlIE1vbm8nLG1vbm9zcGFjZTsKICAgICAgcGFkZGluZzo0cHggNnB4O2JvcmRlci1yYWRpdXM6OHB4O2ZsZXg6MTsKICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlcjtib3JkZXI6MXB4IHNvbGlkIHZhcigtLXN0cm9rZTIpOwogICAgICBjb2xvcjp2YXIoLS1tdXRlZCk7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC4yKTsKICAgIH0KICAgIC5jaS1idG4uc2VsewogICAgICBib3JkZXItY29sb3I6cmdiYSgyNTUsMTcwLDAsLjUpO2NvbG9yOnZhcigtLW9yYW5nZSk7CiAgICAgIGJhY2tncm91bmQ6cmdiYSgyNTUsMTcwLDAsLjA4KTsKICAgIH0KCiAgICAudm9sLXJvd3tkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo3cHg7bWFyZ2luLWJvdHRvbTo4cHg7fQogICAgLnZvbC1sYWJlbHtmb250LXNpemU6OXB4O2ZvbnQtZmFtaWx5OidTcGFjZSBNb25vJyxtb25vc3BhY2U7Y29sb3I6dmFyKC0tbXV0ZWQpO21pbi13aWR0aDoyNHB4O30KICAgIGlucHV0W3R5cGU9InJhbmdlIl17CiAgICAgIC13ZWJraXQtYXBwZWFyYW5jZTpub25lO2FwcGVhcmFuY2U6bm9uZTsKICAgICAgZmxleDoxO2hlaWdodDo0cHg7Ym9yZGVyLXJhZGl1czo5OTlweDsKICAgICAgYmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LC4wOCk7b3V0bGluZTpub25lOwogICAgfQogICAgaW5wdXRbdHlwZT0icmFuZ2UiXTo6LXdlYmtpdC1zbGlkZXItdGh1bWJ7CiAgICAgIC13ZWJraXQtYXBwZWFyYW5jZTpub25lO3dpZHRoOjEzcHg7aGVpZ2h0OjEzcHg7CiAgICAgIGJvcmRlci1yYWRpdXM6NTAlO2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuOCk7CiAgICAgIGJvcmRlcjoxcHggc29saWQgcmdiYSgwLDAsMCwuNCk7Y3Vyc29yOnBvaW50ZXI7CiAgICB9CiAgICAudm9sLXBjdHtmb250LXNpemU6OXB4O2ZvbnQtZmFtaWx5OidTcGFjZSBNb25vJyxtb25vc3BhY2U7Y29sb3I6dmFyKC0tbXV0ZWQpO21pbi13aWR0aDoyOHB4O3RleHQtYWxpZ246cmlnaHQ7fQoKICAgIC50cmFjay1idG5ze2Rpc3BsYXk6ZmxleDtnYXA6NnB4O30KICAgIC50cmFjay1idG5zIGJ1dHRvbntmbGV4OjE7cGFkZGluZzo3cHggNXB4O2ZvbnQtc2l6ZToxMXB4O2p1c3RpZnktY29udGVudDpjZW50ZXI7Ym9yZGVyLXJhZGl1czoxMHB4O30KICAgIC5idG4tbXV0ZWR7Y29sb3I6I2ZmODA4MDtib3JkZXItY29sb3I6cmdiYSgyNTUsNTgsNTgsLjM1KTt9CgogICAgLndhdmVmb3JtewogICAgICB3aWR0aDoxMDAlO2hlaWdodDozMHB4O2Rpc3BsYXk6YmxvY2s7CiAgICAgIGJvcmRlci1yYWRpdXM6N3B4O2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMik7bWFyZ2luLWJvdHRvbTo4cHg7b3BhY2l0eTouNzU7CiAgICB9CgogICAgZm9vdGVyewogICAgICBtYXgtd2lkdGg6MTEyMHB4O21hcmdpbjowIGF1dG87cGFkZGluZzoxMnB4IDIwcHggMjhweDsKICAgICAgZm9udC1zaXplOjEycHg7Y29sb3I6dmFyKC0tbXV0ZWQpO2xpbmUtaGVpZ2h0OjEuNztib3JkZXItdG9wOjFweCBzb2xpZCB2YXIoLS1zdHJva2UpOwogICAgfQogICAgY29kZXtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjM1KTtwYWRkaW5nOjJweCA2cHg7Ym9yZGVyLXJhZGl1czo2cHg7Zm9udC1mYW1pbHk6J1NwYWNlIE1vbm8nLG1vbm9zcGFjZTt9CgogICAgLmVycm9yLXRvYXN0ewogICAgICBwb3NpdGlvbjpmaXhlZDtib3R0b206MjBweDtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTsKICAgICAgYmFja2dyb3VuZDpyZ2JhKDI1NSw1OCw1OCwuMTUpO2JvcmRlcjoxcHggc29saWQgcmdiYSgyNTUsNTgsNTgsLjQpOwogICAgICBjb2xvcjojZmZhYWFhO3BhZGRpbmc6MTFweCAyMHB4O2JvcmRlci1yYWRpdXM6MTJweDsKICAgICAgZm9udC1zaXplOjEzcHg7ei1pbmRleDo5OTk7bWF4LXdpZHRoOjkwdnc7dGV4dC1hbGlnbjpjZW50ZXI7ZGlzcGxheTpub25lOwogICAgfQogIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+Cgo8ZGl2IGNsYXNzPSJlcnJvci10b2FzdCIgaWQ9InRvYXN0Ij48L2Rpdj4KCjxoZWFkZXI+CiAgPGRpdiBjbGFzcz0ibG9nbyI+TUFSQUNBPHNwYW4+TE9PUDwvc3Bhbj48L2Rpdj4KICA8ZGl2IGNsYXNzPSJ0b3AtY29udHJvbHMiPgogICAgPHNlbGVjdCBpZD0ic291cmNlU2VsZWN0Ij4KICAgICAgPG9wdGlvbiB2YWx1ZT0ibWljIj7wn46ZIE1pY3JvZm9ubzwvb3B0aW9uPgogICAgICA8b3B0aW9uIHZhbHVlPSJzY3JlZW4iPvCflqUgU2NoZXJtbyAvIFRhYjwvb3B0aW9uPgogICAgPC9zZWxlY3Q+CiAgICA8YnV0dG9uIGNsYXNzPSJidG4taW5pdCIgaWQ9ImJ0bkluaXQiPuKaoSBBdHRpdmEgQXVkaW88L2J1dHRvbj4KICAgIDxidXR0b24gY2xhc3M9ImJ0bi1wbGF5IiBpZD0iYnRuUGxheUFsbCIgZGlzYWJsZWQ+4pa2IFBsYXkgQWxsPC9idXR0b24+CiAgICA8YnV0dG9uIGNsYXNzPSJidG4tc3RvcCIgaWQ9ImJ0blN0b3BBbGwiIGRpc2FibGVkPuKWoCBTdG9wIEFsbDwvYnV0dG9uPgogICAgPGJ1dHRvbiBpZD0iYnRuQ2xlYXJBbGwiIGRpc2FibGVkPuKclSBDbGVhciBBbGw8L2J1dHRvbj4KICA8L2Rpdj4KPC9oZWFkZXI+Cgo8ZGl2IGNsYXNzPSJzdGF0dXNiYXIiPgogIDxzcGFuIGNsYXNzPSJiYWRnZSI+PHNwYW4gY2xhc3M9ImRvdCIgaWQ9ImRvdEF1ZGlvIj48L3NwYW4+IEF1ZGlvQ29udGV4dDwvc3Bhbj4KICA8c3BhbiBjbGFzcz0iYmFkZ2UiPjxzcGFuIGNsYXNzPSJkb3QiIGlkPSJkb3RJbnB1dCI+PC9zcGFuPiBJbmdyZXNzbzwvc3Bhbj4KICA8c3BhbiBjbGFzcz0iYmFkZ2UiPkxvb3A6IDxiIGlkPSJtYXN0ZXJMZW4iPuKAlDwvYj48L3NwYW4+CiAgPHNwYW4gY2xhc3M9ImJhZGdlIj5TUjogPGIgaWQ9InNyIj7igJQ8L2I+PC9zcGFuPgo8L2Rpdj4KCjxkaXYgY2xhc3M9Im1ldHJvLWJhciI+CiAgPHNwYW4gY2xhc3M9Im1ldHJvLWxhYmVsIj5NRVRST05PTU88L3NwYW4+CgogIDxkaXYgY2xhc3M9ImxlZC1zdHJpcCIgaWQ9ImxlZFN0cmlwIj48L2Rpdj4KCiAgPGRpdiBjbGFzcz0iYmVhdC1udW0iIGlkPSJiZWF0TnVtIj7igJQ8L2Rpdj4KCiAgPGRpdiBjbGFzcz0iYnBtLXdyYXAiPgogICAgPGxhYmVsIGZvcj0iYnBtSW5wdXQiPkJQTTwvbGFiZWw+CiAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBpZD0iYnBtSW5wdXQiIG1pbj0iNjAiIG1heD0iMTgwIiB2YWx1ZT0iMTIwIiBzdGVwPSIxIi8+CiAgPC9kaXY+CgogIDxidXR0b24gY2xhc3M9Im1ldHJvLXRvZ2dsZSIgaWQ9ImJ0bk1ldHJvIj7ilrYgU3RhcnQ8L2J1dHRvbj4KPC9kaXY+Cgo8bWFpbiBpZD0iZ3JpZCI+PC9tYWluPgoKPGZvb3Rlcj4KICDimqAgVXNhIDxjb2RlPmh0dHBzOi8vPC9jb2RlPiBvIDxjb2RlPmxvY2FsaG9zdDwvY29kZT4gcGVyIGlsIG1pY3JvZm9uby4gJm5ic3A7fCZuYnNwOwogIExhIDxiPnByaW1hIHRyYWNjaWE8L2I+IGRlZmluaXNjZSBsYSBkdXJhdGEgZGVsIGxvb3AgbWFzdGVyLiAmbmJzcDt8Jm5ic3A7CiAgPGI+Q291bnQtaW48L2I+OiA4IG8gMTYgYmF0dHV0ZSBwcmltYSBkZWxsYSByZWdpc3RyYXppb25lLiBJbCBtZXRyb25vbW8gc2kgc2luY3Jvbml6emEgYXV0b21hdGljYW1lbnRlLgo8L2Zvb3Rlcj4KCjxzY3JpcHQ+CmNvbnN0IExFRFMgPSAxNjsKbGV0IG1ldHJvUnVubmluZyA9IGZhbHNlOwpsZXQgYnBtID0gMTIwOwpsZXQgY3VycmVudEJlYXQgPSAtMTsKbGV0IG1ldHJvSW50ZXJ2YWxJZCA9IG51bGw7CmxldCBsYXN0QmVhdFRpbWUgPSAwOwoKY29uc3QgbGVkU3RyaXAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxlZFN0cmlwIik7CmNvbnN0IGJwbUlucHV0ICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJicG1JbnB1dCIpOwpjb25zdCBidG5NZXRybyAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnRuTWV0cm8iKTsKY29uc3QgYmVhdE51bSAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJlYXROdW0iKTsKCmNvbnN0IGxlZEVscyA9IFtdOwpmb3IobGV0IGk9MDsgaTxMRURTOyBpKyspewogIGlmKGk+MCAmJiBpJTQ9PT0wKXsKICAgIGNvbnN0IHNlcD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIHNlcC5jbGFzc05hbWU9ImxlZC1zZXAiOwogICAgbGVkU3RyaXAuYXBwZW5kQ2hpbGQoc2VwKTsKICB9CiAgY29uc3QgZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICBjb25zdCBpc0FjY2VudCA9IChpJTQ9PT0wKTsKICBkLmNsYXNzTmFtZT0ibGVkIisoaXNBY2NlbnQ/IiBiZWF0MSI6IiIpOwogIC8vIFNob3cgYmVhdCBudW1iZXIgaW5zaWRlIGFjY2VudCBMRURzCiAgaWYoaXNBY2NlbnQpewogICAgY29uc3Qgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIG4uY2xhc3NOYW1lPSJiZWF0LW4iOwogICAgbi50ZXh0Q29udGVudD0oaS80KzEpOwogICAgZC5hcHBlbmRDaGlsZChuKTsKICB9CiAgbGVkU3RyaXAuYXBwZW5kQ2hpbGQoZCk7CiAgbGVkRWxzLnB1c2goZCk7Cn0KCmZ1bmN0aW9uIHNldExlZChiZWF0KXsKICBsZWRFbHMuZm9yRWFjaCgobCxpKT0+ewogICAgY29uc3Qgd2FzID0gbC5jbGFzc0xpc3QuY29udGFpbnMoImxpdCIpOwogICAgbC5jbGFzc0xpc3QudG9nZ2xlKCJsaXQiLCBpPT09YmVhdCk7CiAgfSk7CiAgaWYoYmVhdD49MCl7CiAgICBiZWF0TnVtLnRleHRDb250ZW50ID0gKGJlYXQrMSk7CiAgICBiZWF0TnVtLmNsYXNzTGlzdC5hZGQoImZsYXNoIik7CiAgICBjbGVhclRpbWVvdXQoYmVhdE51bS5fZnQpOwogICAgYmVhdE51bS5fZnQgPSBzZXRUaW1lb3V0KCgpPT5iZWF0TnVtLmNsYXNzTGlzdC5yZW1vdmUoImZsYXNoIiksIDgwKTsKICB9IGVsc2UgewogICAgYmVhdE51bS50ZXh0Q29udGVudD0i4oCUIjsKICAgIGJlYXROdW0uY2xhc3NMaXN0LnJlbW92ZSgiZmxhc2giKTsKICB9Cn0KCmZ1bmN0aW9uIG1ldHJvVGljaygpewogIGN1cnJlbnRCZWF0ID0gKGN1cnJlbnRCZWF0KzEpICUgTEVEUzsKICBzZXRMZWQoY3VycmVudEJlYXQpOwogIG5vdGlmeVRyYWNrc0JlYXQoY3VycmVudEJlYXQpOwp9CgpmdW5jdGlvbiBzdGFydE1ldHJvKCl7CiAgaWYobWV0cm9SdW5uaW5nKSByZXR1cm47CiAgbWV0cm9SdW5uaW5nPXRydWU7CiAgY3VycmVudEJlYXQ9LTE7CiAgY29uc3QgbXMgPSA2MDAwMC9icG07CiAgLy8gRmlyZSBpbW1lZGlhdGVseSB0aGVuIHJlcGVhdAogIG1ldHJvVGljaygpOwogIG1ldHJvSW50ZXJ2YWxJZCA9IHNldEludGVydmFsKG1ldHJvVGljaywgbXMpOwogIGJ0bk1ldHJvLnRleHRDb250ZW50PSLilqAgU3RvcCI7CiAgYnRuTWV0cm8uY2xhc3NMaXN0LmFkZCgiYWN0aXZlIik7Cn0KCmZ1bmN0aW9uIHN0b3BNZXRybygpewogIGlmKCFtZXRyb1J1bm5pbmcpIHJldHVybjsKICBjbGVhckludGVydmFsKG1ldHJvSW50ZXJ2YWxJZCk7CiAgbWV0cm9JbnRlcnZhbElkPW51bGw7CiAgbWV0cm9SdW5uaW5nPWZhbHNlOwogIGN1cnJlbnRCZWF0PS0xOwogIHNldExlZCgtMSk7CiAgYnRuTWV0cm8udGV4dENvbnRlbnQ9IuKWtiBTdGFydCI7CiAgYnRuTWV0cm8uY2xhc3NMaXN0LnJlbW92ZSgiYWN0aXZlIik7Cn0KCmZ1bmN0aW9uIHJlc3RhcnRNZXRybygpewogIHN0b3BNZXRybygpOwogIHN0YXJ0TWV0cm8oKTsKfQoKYnBtSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwoKT0+ewogIGxldCB2PXBhcnNlSW50KGJwbUlucHV0LnZhbHVlKXx8MTIwOwogIHY9TWF0aC5tYXgoNjAsTWF0aC5taW4oMTgwLHYpKTsKICBicG1JbnB1dC52YWx1ZT12OyBicG09djsKICByZXN0YXJ0TWV0cm8oKTsKfSk7CmJwbUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLGU9PnsgaWYoZS5rZXk9PT0iRW50ZXIiKSBicG1JbnB1dC5ibHVyKCk7IH0pOwpidG5NZXRyby5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9PnsgbWV0cm9SdW5uaW5nP3N0b3BNZXRybygpOnN0YXJ0TWV0cm8oKTsgfSk7CgpmdW5jdGlvbiBub3RpZnlUcmFja3NCZWF0KGJlYXQpewogIGZvcihjb25zdCB0IG9mIHRyYWNrcyl7CiAgICBpZighdC5jb3VudGluQXJtZWQgJiYgIXQuY291bnRpbkFjdGl2ZSkgY29udGludWU7CgogICAgLy8gQXNwZXR0YSBiZWF0IDAgcGVyIHBhcnRpcmUgc2luY3Jvbml6emF0bwogICAgaWYodC5jb3VudGluQXJtZWQgJiYgIXQuY291bnRpbkFjdGl2ZSl7CiAgICAgIGlmKGJlYXQ9PT0wKXsKICAgICAgICB0LmNvdW50aW5BY3RpdmU9dHJ1ZTsKICAgICAgICB0LmNvdW50aW5SZW1haW5pbmc9dC5jb3VudGluQmVhdHM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGludWU7IC8vIG5vbiBhbmNvcmEKICAgICAgfQogICAgfQoKICAgIGlmKHQuY291bnRpbkFjdGl2ZSl7CiAgICAgIHQuY291bnRpblJlbWFpbmluZy0tOwogICAgICByZWZyZXNoQ291bnRpbkxlZHModCk7CiAgICAgIHJlZnJlc2hDb3VudGluU3ZnKHQpOwogICAgICBpZih0LnVpLmluZm8pIHQudWkuaW5mby50ZXh0Q29udGVudD1gY291bnQtaW46ICR7TWF0aC5tYXgoMCx0LmNvdW50aW5SZW1haW5pbmcpfSBiZWF0YDsKCiAgICAgIGlmKHQuY291bnRpblJlbWFpbmluZzw9MCl7CiAgICAgICAgdC5jb3VudGluQXJtZWQ9ZmFsc2U7CiAgICAgICAgdC5jb3VudGluQWN0aXZlPWZhbHNlOwogICAgICAgIHN0YXJ0UmVjb3JkaW5nTm93KHQpOwogICAgICB9CiAgICB9CiAgfQp9CgpmdW5jdGlvbiByZWZyZXNoQ291bnRpbkxlZHModCl7CiAgaWYoIXQudWkudHJhY2tMZWRzKSByZXR1cm47CiAgY29uc3QgdG90YWw9dC5jb3VudGluQmVhdHM7CiAgY29uc3QgZG9uZT10b3RhbC10LmNvdW50aW5SZW1haW5pbmc7CiAgY29uc3QgbGVkcz10LnVpLnRyYWNrTGVkczsKICBjb25zdCBuPWxlZHMubGVuZ3RoOyAvLyA4CiAgbGVkcy5mb3JFYWNoKChsLGkpPT57CiAgICBjb25zdCB0aHJlc2g9TWF0aC5yb3VuZCgoaSsxKSp0b3RhbC9uKTsKICAgIGNvbnN0IHByZXY9TWF0aC5yb3VuZChpKnRvdGFsL24pOwogICAgbC5jbGFzc0xpc3QucmVtb3ZlKCJsaXQiLCJkb25lIik7CiAgICBpZihkb25lPj10aHJlc2gpIGwuY2xhc3NMaXN0LmFkZCgiZG9uZSIpOwogICAgZWxzZSBpZihkb25lPnByZXYpIGwuY2xhc3NMaXN0LmFkZCgibGl0Iik7CiAgfSk7Cn0KCmZ1bmN0aW9uIGNsZWFyQ291bnRpbkxlZHModCl7CiAgaWYoIXQudWkudHJhY2tMZWRzKSByZXR1cm47CiAgdC51aS50cmFja0xlZHMuZm9yRWFjaChsPT5sLmNsYXNzTGlzdC5yZW1vdmUoImxpdCIsImRvbmUiKSk7Cn0KCmZ1bmN0aW9uIHJlZnJlc2hDb3VudGluU3ZnKHQpewogIGNvbnN0IHN2Zz10LnVpLmJ0bk1haW4/LnF1ZXJ5U2VsZWN0b3IoInN2ZyIpOwogIGlmKCFzdmcpIHJldHVybjsKICBjb25zdCBuPU1hdGgubWF4KDAsdC5jb3VudGluUmVtYWluaW5nKTsKICBzdmcuaW5uZXJIVE1MPWA8dGV4dCB4PSIxNyIgeT0iMjMiIHRleHQtYW5jaG9yPSJtaWRkbGUiCiAgICBmb250LWZhbWlseT0iU3BhY2UgTW9ubyxtb25vc3BhY2UiIGZvbnQtc2l6ZT0iMTYiIGZvbnQtd2VpZ2h0PSI3MDAiCiAgICBmaWxsPSJyZ2JhKDI1NSwxNzAsMCwuOTUpIj4ke24+MD9uOiJHTyEifTwvdGV4dD5gOwp9CgpsZXQgYXVkaW9DdHg9bnVsbCwgaW5wdXRTdHJlYW09bnVsbCwgbWFzdGVyR2Fpbj1udWxsOwpsZXQgaXNJbml0aWFsaXplZD1mYWxzZSwgbWFzdGVyTG9vcFNlY29uZHM9bnVsbDsKY29uc3QgVFJBQ0tTPTg7CmNvbnN0IHRyYWNrcz1bXTsKCmNvbnN0IGdyaWQgICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ3JpZCIpOwpjb25zdCBidG5Jbml0ICAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ0bkluaXQiKTsKY29uc3QgYnRuUGxheUFsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJidG5QbGF5QWxsIik7CmNvbnN0IGJ0blN0b3BBbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnRuU3RvcEFsbCIpOwpjb25zdCBidG5DbGVhckFsbD0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ0bkNsZWFyQWxsIik7CmNvbnN0IHNvdXJjZVNlbGVjdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic291cmNlU2VsZWN0Iik7CmNvbnN0IGRvdEF1ZGlvICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZG90QXVkaW8iKTsKY29uc3QgZG90SW5wdXQgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkb3RJbnB1dCIpOwpjb25zdCBtYXN0ZXJMZW5FbD0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1hc3RlckxlbiIpOwpjb25zdCBzckVsICAgICAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNyIik7CmNvbnN0IHRvYXN0RWwgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidG9hc3QiKTsKCmZ1bmN0aW9uIHNob3dUb2FzdChtc2csZHVyPTQ1MDApewogIHRvYXN0RWwudGV4dENvbnRlbnQ9bXNnO3RvYXN0RWwuc3R5bGUuZGlzcGxheT0iYmxvY2siOwogIGNsZWFyVGltZW91dCh0b2FzdEVsLl90KTsKICB0b2FzdEVsLl90PXNldFRpbWVvdXQoKCk9Pnt0b2FzdEVsLnN0eWxlLmRpc3BsYXk9Im5vbmUiO30sZHVyKTsKfQpmdW5jdGlvbiBmbXRTZWMocyl7cmV0dXJuKHM9PW51bGx8fCFpc0Zpbml0ZShzKSk/IuKAlCI6czwxMD9zLnRvRml4ZWQoMikrInMiOnMudG9GaXhlZCgxKSsicyI7fQpmdW5jdGlvbiBzZXREb3RzKCl7CiAgZG90QXVkaW8uY2xhc3NOYW1lPSJkb3QiKyhhdWRpb0N0eCYmYXVkaW9DdHguc3RhdGU9PT0icnVubmluZyI/IiBvbiI6IiIpOwogIGRvdElucHV0LmNsYXNzTmFtZT0iZG90IisoaW5wdXRTdHJlYW0/IiBvbiI6IiIpOwp9CmZ1bmN0aW9uIHNldE1hc3Rlckxvb3Aoc2VjKXttYXN0ZXJMb29wU2Vjb25kcz1zZWM7bWFzdGVyTGVuRWwudGV4dENvbnRlbnQ9Zm10U2VjKHNlYyk7fQoKZnVuY3Rpb24gdXBkYXRlR2xvYmFsQnV0dG9ucygpewogIGNvbnN0IGFueUJ1Zj10cmFja3Muc29tZSh0PT4hIXQuYnVmZmVyKTsKICBjb25zdCBhbnlQbGF5PXRyYWNrcy5zb21lKHQ9PnQuaXNQbGF5aW5nKTsKICBidG5QbGF5QWxsLmRpc2FibGVkPSFpc0luaXRpYWxpemVkfHwhYW55QnVmOwogIGJ0blN0b3BBbGwuZGlzYWJsZWQ9IWlzSW5pdGlhbGl6ZWR8fCFhbnlQbGF5OwogIGJ0bkNsZWFyQWxsLmRpc2FibGVkPSFpc0luaXRpYWxpemVkfHwhYW55QnVmOwp9Cgphc3luYyBmdW5jdGlvbiBibG9iVG9BdWRpb0J1ZmZlcihibG9iKXsKICBjb25zdCBhYj1hd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgcmV0dXJuIGF3YWl0IGF1ZGlvQ3R4LmRlY29kZUF1ZGlvRGF0YShhYik7Cn0KCmZ1bmN0aW9uIHF1YW50aXplQnVmZmVyKGJ1Zil7CiAgaWYobWFzdGVyTG9vcFNlY29uZHM9PW51bGwpIHJldHVybiBidWY7CiAgY29uc3Qgc3I9YnVmLnNhbXBsZVJhdGUsIHRhcmdldD1NYXRoLnJvdW5kKG1hc3Rlckxvb3BTZWNvbmRzKnNyKTsKICBjb25zdCBjaHM9YnVmLm51bWJlck9mQ2hhbm5lbHM7CiAgY29uc3Qgb3V0PWF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlcihjaHMsdGFyZ2V0LHNyKTsKICBmb3IobGV0IGM9MDtjPGNocztjKyspewogICAgY29uc3QgaW5wPWJ1Zi5nZXRDaGFubmVsRGF0YShjKSwgb3V0cD1vdXQuZ2V0Q2hhbm5lbERhdGEoYyk7CiAgICBpZihpbnAubGVuZ3RoPj10YXJnZXQpIG91dHAuc2V0KGlucC5zdWJhcnJheSgwLHRhcmdldCkpOwogICAgZWxzZSBvdXRwLnNldChpbnApOwogIH0KICByZXR1cm4gb3V0Owp9CgpmdW5jdGlvbiBkcmF3V2F2ZWZvcm0oY2FudmFzLGF1ZGlvQnVmZmVyKXsKICBjb25zdCBjdHg9Y2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgY29uc3QgVz1jYW52YXMud2lkdGg9Y2FudmFzLm9mZnNldFdpZHRoKmRldmljZVBpeGVsUmF0aW87CiAgY29uc3QgSD1jYW52YXMuaGVpZ2h0PWNhbnZhcy5vZmZzZXRIZWlnaHQqZGV2aWNlUGl4ZWxSYXRpbzsKICBjdHguY2xlYXJSZWN0KDAsMCxXLEgpOwogIGlmKCFhdWRpb0J1ZmZlcikgcmV0dXJuOwogIGNvbnN0IGRhdGE9YXVkaW9CdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7CiAgY29uc3Qgc3RlcD1NYXRoLmNlaWwoZGF0YS5sZW5ndGgvVyksIG1pZD1ILzI7CiAgY3R4LnN0cm9rZVN0eWxlPSJyZ2JhKDAsMjEyLDI1NSwuNykiO2N0eC5saW5lV2lkdGg9MTtjdHguYmVnaW5QYXRoKCk7CiAgZm9yKGxldCB4PTA7eDxXO3grKyl7CiAgICBsZXQgbW49MSxteD0tMTsKICAgIGZvcihsZXQgaj0wO2o8c3RlcDtqKyspe2NvbnN0IHY9ZGF0YVt4KnN0ZXAral18fDA7aWYodjxtbiltbj12O2lmKHY+bXgpbXg9djt9CiAgICBjdHgubW92ZVRvKHgsbWlkK21uKm1pZCouOSk7Y3R4LmxpbmVUbyh4LG1pZCtteCptaWQqLjkpOwogIH0KICBjdHguc3Ryb2tlKCk7Cn0KZnVuY3Rpb24gc3RvcFBsYXliYWNrKHQpewogIGlmKHQuc291cmNlKXt0cnl7dC5zb3VyY2Uuc3RvcCgpO31jYXRjaHt9dHJ5e3Quc291cmNlLmRpc2Nvbm5lY3QoKTt9Y2F0Y2h7fXQuc291cmNlPW51bGw7fQogIHQuaXNQbGF5aW5nPWZhbHNlO3VwZGF0ZVRyYWNrVUkodCk7dXBkYXRlR2xvYmFsQnV0dG9ucygpOwp9CmZ1bmN0aW9uIHN0YXJ0UGxheWJhY2sodCl7CiAgaWYoIXQuYnVmZmVyfHwhYXVkaW9DdHgpIHJldHVybjsKICBzdG9wUGxheWJhY2sodCk7CiAgY29uc3Qgc3JjPWF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpOwogIHNyYy5idWZmZXI9dC5idWZmZXI7c3JjLmxvb3A9dHJ1ZTtzcmMubG9vcFN0YXJ0PTA7c3JjLmxvb3BFbmQ9dC5idWZmZXIuZHVyYXRpb247CiAgc3JjLmNvbm5lY3QodC5nYWluTm9kZSk7c3JjLnN0YXJ0KCk7CiAgdC5zb3VyY2U9c3JjO3QuaXNQbGF5aW5nPXRydWU7dXBkYXRlVHJhY2tVSSh0KTt1cGRhdGVHbG9iYWxCdXR0b25zKCk7Cn0KZnVuY3Rpb24gY2xlYXJUcmFjayh0KXsKICBzdG9wUGxheWJhY2sodCk7YWJvcnRSZWNvcmRpbmcodCk7Y2FuY2VsQ291bnRpbih0KTsKICB0LmJ1ZmZlcj1udWxsO2RyYXdXYXZlZm9ybSh0LnVpLmNhbnZhcyxudWxsKTt1cGRhdGVUcmFja1VJKHQpO3VwZGF0ZUdsb2JhbEJ1dHRvbnMoKTsKfQpmdW5jdGlvbiBhYm9ydFJlY29yZGluZyh0KXsKICBpZih0Lm1lZGlhUmVjJiZ0LmlzUmVjb3JkaW5nKXsKICAgIHQubWVkaWFSZWMub25kYXRhYXZhaWxhYmxlPW51bGw7dC5tZWRpYVJlYy5vbnN0b3A9bnVsbDsKICAgIHRyeXt0Lm1lZGlhUmVjLnN0b3AoKTt9Y2F0Y2h7fQogIH0KICB0LmlzUmVjb3JkaW5nPWZhbHNlO3QucmVjQ2h1bmtzPVtdOwp9CmZ1bmN0aW9uIGNhbmNlbENvdW50aW4odCl7CiAgdC5jb3VudGluQXJtZWQ9ZmFsc2U7dC5jb3VudGluQWN0aXZlPWZhbHNlO3QuY291bnRpblJlbWFpbmluZz0wOwogIGNsZWFyQ291bnRpbkxlZHModCk7Cn0KCmZ1bmN0aW9uIHN0YXJ0UmVjb3JkaW5nTm93KHQpewogIGlmKCFpbnB1dFN0cmVhbSl7c2hvd1RvYXN0KCJQcmltYSBhdHRpdmEgbCdhdWRpbyEiKTtyZXR1cm47fQogIGNvbnN0IG1pbWVzPVsiYXVkaW8vd2VibTtjb2RlY3M9b3B1cyIsImF1ZGlvL3dlYm0iLCJhdWRpby9vZ2c7Y29kZWNzPW9wdXMiLCJhdWRpby9vZ2ciLCJhdWRpby9tcDQiXTsKICBjb25zdCBtaW1lPW1pbWVzLmZpbmQobT0+TWVkaWFSZWNvcmRlci5pc1R5cGVTdXBwb3J0ZWQobSkpfHwiIjsKICB0cnl7CiAgICB0LnJlY0NodW5rcz1bXTsKICAgIGNvbnN0IG9wdGlvbnM9bWltZT97bWltZVR5cGU6bWltZX06e307CiAgICB0Lm1lZGlhUmVjPW5ldyBNZWRpYVJlY29yZGVyKGlucHV0U3RyZWFtLG9wdGlvbnMpOwogICAgdC5tZWRpYVJlYy5vbmRhdGFhdmFpbGFibGU9KGUpPT57aWYoZS5kYXRhJiZlLmRhdGEuc2l6ZT4wKXQucmVjQ2h1bmtzLnB1c2goZS5kYXRhKTt9OwogICAgdC5tZWRpYVJlYy5vbnN0b3A9YXN5bmMoKT0+ewogICAgICB0LmlzUmVjb3JkaW5nPWZhbHNlOwogICAgICBpZighdC5yZWNDaHVua3MubGVuZ3RoKXtzaG93VG9hc3QoIlJlZ2lzdHJhemlvbmUgdnVvdGEuIik7dXBkYXRlVHJhY2tVSSh0KTt1cGRhdGVHbG9iYWxCdXR0b25zKCk7cmV0dXJuO30KICAgICAgdHJ5ewogICAgICAgIGNvbnN0IGJsb2I9bmV3IEJsb2IodC5yZWNDaHVua3Mse3R5cGU6bWltZXx8ImF1ZGlvL3dlYm0ifSk7CiAgICAgICAgdC5yZWNDaHVua3M9W107CiAgICAgICAgbGV0IGJ1Zj1hd2FpdCBibG9iVG9BdWRpb0J1ZmZlcihibG9iKTsKICAgICAgICBpZihidWYuZHVyYXRpb248MC4wNSl7c2hvd1RvYXN0KCJUcm9wcG8gYnJldmUuIik7dXBkYXRlVHJhY2tVSSh0KTt1cGRhdGVHbG9iYWxCdXR0b25zKCk7cmV0dXJuO30KICAgICAgICBpZihtYXN0ZXJMb29wU2Vjb25kcz09bnVsbCl7c2V0TWFzdGVyTG9vcChidWYuZHVyYXRpb24pO3QuYnVmZmVyPWJ1Zjt9CiAgICAgICAgZWxzZXt0LmJ1ZmZlcj1xdWFudGl6ZUJ1ZmZlcihidWYpO30KICAgICAgICBkcmF3V2F2ZWZvcm0odC51aS5jYW52YXMsdC5idWZmZXIpOwogICAgICB9Y2F0Y2goZXJyKXtjb25zb2xlLmVycm9yKGVycik7c2hvd1RvYXN0KCJFcnJvcmUgZGVjb2RpZmljYTogIitlcnIubWVzc2FnZSk7fQogICAgICB1cGRhdGVUcmFja1VJKHQpO3VwZGF0ZUdsb2JhbEJ1dHRvbnMoKTsKICAgIH07CiAgICB0Lm1lZGlhUmVjLm9uZXJyb3I9KGUpPT57CiAgICAgIHNob3dUb2FzdCgiRXJyb3JlIE1lZGlhUmVjb3JkZXI6ICIrKGUuZXJyb3I/Lm1lc3NhZ2V8fGUpKTsKICAgICAgdC5pc1JlY29yZGluZz1mYWxzZTt1cGRhdGVUcmFja1VJKHQpO3VwZGF0ZUdsb2JhbEJ1dHRvbnMoKTsKICAgIH07CiAgICB0Lm1lZGlhUmVjLnN0YXJ0KDEwMCk7CiAgICB0LmlzUmVjb3JkaW5nPXRydWU7CiAgICBjbGVhckNvdW50aW5MZWRzKHQpOwogICAgdXBkYXRlVHJhY2tVSSh0KTt1cGRhdGVHbG9iYWxCdXR0b25zKCk7CiAgfWNhdGNoKGVycil7c2hvd1RvYXN0KCJJbXBvc3NpYmlsZSByZWdpc3RyYXJlOiAiK2Vyci5tZXNzYWdlKTt9Cn0KZnVuY3Rpb24gc3RvcFJlY29yZGluZyh0KXsKICBpZighdC5tZWRpYVJlY3x8IXQuaXNSZWNvcmRpbmcpIHJldHVybjsKICB0cnl7dC5tZWRpYVJlYy5zdG9wKCk7fQogIGNhdGNoKGVycil7dC5pc1JlY29yZGluZz1mYWxzZTt1cGRhdGVUcmFja1VJKHQpO30KfQoKZnVuY3Rpb24gdG9nZ2xlTWFpbkJ1dHRvbih0KXsKICBpZighaXNJbml0aWFsaXplZCl7c2hvd1RvYXN0KCJQcmltYSBjbGljY2Eg4pqhIEF0dGl2YSBBdWRpbyIpO3JldHVybjt9CiAgY29uc3QgaW5Db3VudGluPXQuY291bnRpbkFybWVkfHx0LmNvdW50aW5BY3RpdmU7CiAgaWYoaW5Db3VudGluKXtjYW5jZWxDb3VudGluKHQpO3VwZGF0ZVRyYWNrVUkodCk7cmV0dXJuO30KCiAgaWYoIXQuYnVmZmVyKXsKICAgIGlmKCF0LmlzUmVjb3JkaW5nKXsKICAgICAgaWYodC5jb3VudGluQmVhdHM+MCl7CiAgICAgICAgLy8gQXZ2aWEgbWV0cm9ub21vIHNlIG5vbiBnaXJhCiAgICAgICAgaWYoIW1ldHJvUnVubmluZykgc3RhcnRNZXRybygpOwogICAgICAgIGVsc2UgcmVzdGFydE1ldHJvKCk7IC8vIHJlcGFydCBkYSBiZWF0IDAKICAgICAgICB0LmNvdW50aW5Bcm1lZD10cnVlO3QuY291bnRpbkFjdGl2ZT1mYWxzZTsKICAgICAgICB0LmNvdW50aW5SZW1haW5pbmc9dC5jb3VudGluQmVhdHM7CiAgICAgICAgdXBkYXRlVHJhY2tVSSh0KTt1cGRhdGVHbG9iYWxCdXR0b25zKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhcnRSZWNvcmRpbmdOb3codCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHN0b3BSZWNvcmRpbmcodCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmKCF0LmlzUGxheWluZykgc3RhcnRQbGF5YmFjayh0KTsKICAgIGVsc2Ugc3RvcFBsYXliYWNrKHQpOwogIH0KfQoKZnVuY3Rpb24gdXBkYXRlVHJhY2tVSSh0KXsKICBjb25zdHtlbCxidG5NYWluLHN0YXRlVGFnLGluZm8sY2xlYXJCdG59PXQudWk7CiAgY29uc3QgaW5Db3VudGluPXQuY291bnRpbkFybWVkfHx0LmNvdW50aW5BY3RpdmU7CgogIGVsLmNsYXNzTGlzdC50b2dnbGUoImlzLXJlYyIsdC5pc1JlY29yZGluZyk7CiAgZWwuY2xhc3NMaXN0LnRvZ2dsZSgiaXMtY291bnRpbiIsaW5Db3VudGluJiYhdC5pc1JlY29yZGluZyk7CiAgZWwuY2xhc3NMaXN0LnRvZ2dsZSgiaXMtcGxheSIsdC5pc1BsYXlpbmcmJiF0LmlzUmVjb3JkaW5nJiYhaW5Db3VudGluKTsKICBlbC5jbGFzc0xpc3QudG9nZ2xlKCJoYXMtYnVmZmVyIiwhIXQuYnVmZmVyJiYhdC5pc1BsYXlpbmcmJiF0LmlzUmVjb3JkaW5nJiYhaW5Db3VudGluKTsKCiAgaWYoaW5Db3VudGluKXsKICAgIHN0YXRlVGFnLnRleHRDb250ZW50PSJDT1VOVOKApiI7c3RhdGVUYWcuY2xhc3NOYW1lPSJ0cmFjay1zdGF0ZSBzLWNvdW50aW4iOwogICAgY29uc3QgcmVtPU1hdGgubWF4KDAsdC5jb3VudGluUmVtYWluaW5nKTsKICAgIGluZm8udGV4dENvbnRlbnQ9dC5jb3VudGluQXJtZWQmJiF0LmNvdW50aW5BY3RpdmUKICAgICAgPyBgaW4gYXR0ZXNhIGJhdHR1dGEgMeKApmAKICAgICAgOiBgY291bnQtaW46ICR7cmVtfSBiZWF0YDsKICB9IGVsc2UgaWYodC5pc1JlY29yZGluZyl7CiAgICBzdGF0ZVRhZy50ZXh0Q29udGVudD0i4pePIFJFQyI7c3RhdGVUYWcuY2xhc3NOYW1lPSJ0cmFjay1zdGF0ZSBzLXJlYyI7CiAgICBpbmZvLnRleHRDb250ZW50PSJyZWdpc3RyYXppb25l4oCmIjsKICB9IGVsc2UgaWYodC5pc1BsYXlpbmcpewogICAgc3RhdGVUYWcudGV4dENvbnRlbnQ9IuKWtiBQTEFZIjtzdGF0ZVRhZy5jbGFzc05hbWU9InRyYWNrLXN0YXRlIHMtcGxheSI7CiAgICBpbmZvLnRleHRDb250ZW50PWZtdFNlYyh0LmJ1ZmZlcj8uZHVyYXRpb24pOwogIH0gZWxzZSBpZih0LmJ1ZmZlcil7CiAgICBzdGF0ZVRhZy50ZXh0Q29udGVudD0i4pagIFJFQURZIjtzdGF0ZVRhZy5jbGFzc05hbWU9InRyYWNrLXN0YXRlIHMtcmVhZHkiOwogICAgaW5mby50ZXh0Q29udGVudD1mbXRTZWModC5idWZmZXIuZHVyYXRpb24pOwogIH0gZWxzZSB7CiAgICBzdGF0ZVRhZy50ZXh0Q29udGVudD0iSURMRSI7c3RhdGVUYWcuY2xhc3NOYW1lPSJ0cmFjay1zdGF0ZSI7CiAgICBpbmZvLnRleHRDb250ZW50PSJwcmVtaSBwZXIgcmVnaXN0cmFyZSI7CiAgfQoKICAvLyBTVkcgaWNvbgogIGNvbnN0IHN2Zz1idG5NYWluLnF1ZXJ5U2VsZWN0b3IoInN2ZyIpOwogIGlmKGluQ291bnRpbil7CiAgICBjb25zdCBuPXQuY291bnRpbkFybWVkJiYhdC5jb3VudGluQWN0aXZlPyI/IjpNYXRoLm1heCgwLHQuY291bnRpblJlbWFpbmluZyk7CiAgICBzdmcuaW5uZXJIVE1MPWA8dGV4dCB4PSIxNyIgeT0iMjMiIHRleHQtYW5jaG9yPSJtaWRkbGUiCiAgICAgIGZvbnQtZmFtaWx5PSJTcGFjZSBNb25vLG1vbm9zcGFjZSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjcwMCIKICAgICAgZmlsbD0icmdiYSgyNTUsMTcwLDAsLjk1KSI+JHtufTwvdGV4dD5gOwogIH0gZWxzZSBpZighdC5idWZmZXIpewogICAgaWYodC5pc1JlY29yZGluZykKICAgICAgc3ZnLmlubmVySFRNTD1gPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiByeD0iMyIgZmlsbD0icmdiYSgyNTUsNTgsNTgsLjkpIiBzdHJva2U9Im5vbmUiLz5gOwogICAgZWxzZQogICAgICBzdmcuaW5uZXJIVE1MPWA8Y2lyY2xlIGN4PSIxNyIgY3k9IjE3IiByPSI5IiBmaWxsPSJyZ2JhKDI1NSw1OCw1OCwuODUpIiBzdHJva2U9Im5vbmUiLz5gOwogIH0gZWxzZSB7CiAgICBpZih0LmlzUGxheWluZykKICAgICAgc3ZnLmlubmVySFRNTD1gPHJlY3QgeD0iOCIgeT0iOCIgd2lkdGg9IjciIGhlaWdodD0iMTgiIHJ4PSIyIiBmaWxsPSJyZ2JhKDAsMjEyLDI1NSwuOSkiIHN0cm9rZT0ibm9uZSIvPgogICAgICAgICAgICAgICAgICAgICA8cmVjdCB4PSIxOSIgeT0iOCIgd2lkdGg9IjciIGhlaWdodD0iMTgiIHJ4PSIyIiBmaWxsPSJyZ2JhKDAsMjEyLDI1NSwuOSkiIHN0cm9rZT0ibm9uZSIvPmA7CiAgICBlbHNlCiAgICAgIHN2Zy5pbm5lckhUTUw9YDxwb2x5Z29uIHBvaW50cz0iMTAsOCAyOCwxNyAxMCwyNiIgZmlsbD0icmdiYSg0NSwyNTUsMTQzLC45KSIgc3Ryb2tlPSJub25lIi8+YDsKICB9CgogIGNsZWFyQnRuLmRpc2FibGVkPSF0LmJ1ZmZlciYmIXQuaXNSZWNvcmRpbmcmJiFpbkNvdW50aW47CiAgLy8gdXBkYXRlIGNvdW50LWluIGJ1dHRvbiBzdHlsZXMKICB1cGRhdGVDaUJ0bnModCk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZUNpQnRucyh0KXsKICBpZighdC51aS5jaU9mZikgcmV0dXJuOwogIGNvbnN0IGRpcz10LmlzUmVjb3JkaW5nfHx0LmNvdW50aW5Bcm1lZHx8dC5jb3VudGluQWN0aXZlOwogIFt0LnVpLmNpT2ZmLHQudWkuY2k4LHQudWkuY2kxNl0uZm9yRWFjaChiPT5iLmRpc2FibGVkPWRpcyk7CiAgdC51aS5jaU9mZi5jbGFzc0xpc3QudG9nZ2xlKCJzZWwiLHQuY291bnRpbkJlYXRzPT09MCk7CiAgdC51aS5jaTguY2xhc3NMaXN0LnRvZ2dsZSgic2VsIix0LmNvdW50aW5CZWF0cz09PTgpOwogIHQudWkuY2kxNi5jbGFzc0xpc3QudG9nZ2xlKCJzZWwiLHQuY291bnRpbkJlYXRzPT09MTYpOwp9CgpmdW5jdGlvbiBjcmVhdGVUcmFjayhpKXsKICByZXR1cm57CiAgICBpbmRleDppLGJ1ZmZlcjpudWxsLHNvdXJjZTpudWxsLGdhaW5Ob2RlOm51bGwsCiAgICBtZWRpYVJlYzpudWxsLHJlY0NodW5rczpbXSwKICAgIGlzUmVjb3JkaW5nOmZhbHNlLGlzUGxheWluZzpmYWxzZSxpc011dGVkOmZhbHNlLF9wcmV2Vm9sOjAuODUsCiAgICBjb3VudGluQmVhdHM6MCxjb3VudGluQXJtZWQ6ZmFsc2UsY291bnRpbkFjdGl2ZTpmYWxzZSxjb3VudGluUmVtYWluaW5nOjAsCiAgICB1aTp7fQogIH07Cn0KCmZ1bmN0aW9uIGJ1aWxkVHJhY2tDYXJkKHQpewogIGNvbnN0IGVsPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNlY3Rpb24iKTsKICBlbC5jbGFzc05hbWU9InRyYWNrIjsKICBjb25zdCBsZWRzSHRtbD1BcnJheS5mcm9tKHtsZW5ndGg6OH0sKCk9PmA8ZGl2IGNsYXNzPSJ0LWxlZCI+PC9kaXY+YCkuam9pbigiIik7CiAgZWwuaW5uZXJIVE1MPWAKICAgIDxkaXYgY2xhc3M9InRyYWNrLWdsb3ciPjwvZGl2PgogICAgPGRpdiBjbGFzcz0idHJhY2staGVhZCI+CiAgICAgIDxkaXYgY2xhc3M9InRyYWNrLW51bSI+JHtTdHJpbmcodC5pbmRleCsxKS5wYWRTdGFydCgyLCIwIil9PC9kaXY+CiAgICAgIDxzcGFuIGNsYXNzPSJ0cmFjay1zdGF0ZSIgaWQ9InN0Ij5JRExFPC9zcGFuPgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJ0cmFjay1sZWRzIiBpZD0idGxzIj4ke2xlZHNIdG1sfTwvZGl2PgogICAgPGNhbnZhcyBjbGFzcz0id2F2ZWZvcm0iIGlkPSJjdnMiIHdpZHRoPSIyMDAiIGhlaWdodD0iMzAiPjwvY2FudmFzPgogICAgPGRpdiBjbGFzcz0iYnRuLW1haW4td3JhcCI+CiAgICAgIDxidXR0b24gY2xhc3M9ImJ0bi1tYWluIiBpZD0iYm0iIGFyaWEtbGFiZWw9IlJlY29yZC9QbGF5Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJzcGluLXJpbmciPjwvZGl2PgogICAgICAgIDxzdmcgdmlld0JveD0iMCAwIDM0IDM0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogICAgICAgICAgPGNpcmNsZSBjeD0iMTciIGN5PSIxNyIgcj0iOSIgZmlsbD0icmdiYSgyNTUsNTgsNTgsLjg1KSIgc3Ryb2tlPSJub25lIi8+CiAgICAgICAgPC9zdmc+CiAgICAgIDwvYnV0dG9uPgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJ0cmFjay1pbmZvIiBpZD0iaW5mIj5wcmVtaSBwZXIgcmVnaXN0cmFyZTwvZGl2PgogICAgPGRpdiBjbGFzcz0iY291bnRpbi1yb3ciPgogICAgICA8c3BhbiBjbGFzcz0iY2ktbGJsIj5DT1VOVC1JTjwvc3Bhbj4KICAgICAgPGJ1dHRvbiBjbGFzcz0iY2ktYnRuIHNlbCIgaWQ9ImNpT2ZmIj5PRkY8L2J1dHRvbj4KICAgICAgPGJ1dHRvbiBjbGFzcz0iY2ktYnRuIiBpZD0iY2k4Ij44PC9idXR0b24+CiAgICAgIDxidXR0b24gY2xhc3M9ImNpLWJ0biIgaWQ9ImNpMTYiPjE2PC9idXR0b24+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9InZvbC1yb3ciPgogICAgICA8c3BhbiBjbGFzcz0idm9sLWxhYmVsIj5WT0w8L3NwYW4+CiAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9InZvbCIgbWluPSIwIiBtYXg9IjEiIHN0ZXA9IjAuMDEiIHZhbHVlPSIwLjg1Ii8+CiAgICAgIDxzcGFuIGNsYXNzPSJ2b2wtcGN0IiBpZD0idnAiPjg1JTwvc3Bhbj4KICAgIDwvZGl2PgogICAgPGRpdiBjbGFzcz0idHJhY2stYnRucyI+CiAgICAgIDxidXR0b24gaWQ9Im11dGVCdG4iPk11dGU8L2J1dHRvbj4KICAgICAgPGJ1dHRvbiBpZD0iY2xlYXJCdG4iIGRpc2FibGVkPkNsZWFyPC9idXR0b24+CiAgICA8L2Rpdj4KICBgOwogIGNvbnN0IGJ0bk1haW49ZWwucXVlcnlTZWxlY3RvcigiI2JtIik7CiAgY29uc3Qgc3RhdGVUYWc9ZWwucXVlcnlTZWxlY3RvcigiI3N0Iik7CiAgY29uc3QgaW5mbz1lbC5xdWVyeVNlbGVjdG9yKCIjaW5mIik7CiAgY29uc3Qgdm9sPWVsLnF1ZXJ5U2VsZWN0b3IoIiN2b2wiKTsKICBjb25zdCB2b2xwY3Q9ZWwucXVlcnlTZWxlY3RvcigiI3ZwIik7CiAgY29uc3QgbXV0ZUJ0bj1lbC5xdWVyeVNlbGVjdG9yKCIjbXV0ZUJ0biIpOwogIGNvbnN0IGNsZWFyQnRuPWVsLnF1ZXJ5U2VsZWN0b3IoIiNjbGVhckJ0biIpOwogIGNvbnN0IGNhbnZhcz1lbC5xdWVyeVNlbGVjdG9yKCIjY3ZzIik7CiAgY29uc3QgY2lPZmY9ZWwucXVlcnlTZWxlY3RvcigiI2NpT2ZmIik7CiAgY29uc3QgY2k4PWVsLnF1ZXJ5U2VsZWN0b3IoIiNjaTgiKTsKICBjb25zdCBjaTE2PWVsLnF1ZXJ5U2VsZWN0b3IoIiNjaTE2Iik7CiAgY29uc3QgdHJhY2tMZWRzPUFycmF5LmZyb20oZWwucXVlcnlTZWxlY3RvcigiI3RscyIpLnF1ZXJ5U2VsZWN0b3JBbGwoIi50LWxlZCIpKTsKCiAgdC51aT17ZWwsYnRuTWFpbixzdGF0ZVRhZyxpbmZvLHZvbCx2b2xwY3QsbXV0ZUJ0bixjbGVhckJ0bixjYW52YXMsY2lPZmYsY2k4LGNpMTYsdHJhY2tMZWRzfTsKCiAgYnRuTWFpbi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9PnRvZ2dsZU1haW5CdXR0b24odCkpOwogIGJ0bk1haW4uYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsZT0+e2lmKGUua2V5PT09IkVudGVyInx8ZS5rZXk9PT0iICIpe2UucHJldmVudERlZmF1bHQoKTtidG5NYWluLmNsaWNrKCk7fX0pOwoKICBjaU9mZi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9Pnt0LmNvdW50aW5CZWF0cz0wO3VwZGF0ZUNpQnRucyh0KTt9KTsKICBjaTguYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCgpPT57dC5jb3VudGluQmVhdHM9ODt1cGRhdGVDaUJ0bnModCk7fSk7CiAgY2kxNi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9Pnt0LmNvdW50aW5CZWF0cz0xNjt1cGRhdGVDaUJ0bnModCk7fSk7CgogIHZvbC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsKCk9PnsKICAgIGNvbnN0IHY9cGFyc2VGbG9hdCh2b2wudmFsdWUpOwogICAgdm9scGN0LnRleHRDb250ZW50PU1hdGgucm91bmQodioxMDApKyIlIjsKICAgIGlmKHQuZ2Fpbk5vZGUpIHQuZ2Fpbk5vZGUuZ2Fpbi5zZXRUYXJnZXRBdFRpbWUodixhdWRpb0N0eC5jdXJyZW50VGltZSwuMDEpOwogICAgaWYodj4wLjAwMSkgdC5pc011dGVkPWZhbHNlOwogIH0pOwoKICBtdXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+ewogICAgaWYoIXQuZ2Fpbk5vZGUpIHJldHVybjsKICAgIGlmKCF0LmlzTXV0ZWQpewogICAgICB0Ll9wcmV2Vm9sPXBhcnNlRmxvYXQodm9sLnZhbHVlKTsKICAgICAgdC5nYWluTm9kZS5nYWluLnNldFRhcmdldEF0VGltZSgwLGF1ZGlvQ3R4LmN1cnJlbnRUaW1lLC4wMSk7CiAgICAgIHZvbC52YWx1ZT0iMCI7dm9scGN0LnRleHRDb250ZW50PSIwJSI7CiAgICAgIHQuaXNNdXRlZD10cnVlO211dGVCdG4uY2xhc3NOYW1lPSJidG4tbXV0ZWQiO211dGVCdG4udGV4dENvbnRlbnQ9IlVubXV0ZSI7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBwdj10Ll9wcmV2Vm9sfHwwLjg1OwogICAgICB0LmdhaW5Ob2RlLmdhaW4uc2V0VGFyZ2V0QXRUaW1lKHB2LGF1ZGlvQ3R4LmN1cnJlbnRUaW1lLC4wMSk7CiAgICAgIHZvbC52YWx1ZT1TdHJpbmcocHYpO3ZvbHBjdC50ZXh0Q29udGVudD1NYXRoLnJvdW5kKHB2KjEwMCkrIiUiOwogICAgICB0LmlzTXV0ZWQ9ZmFsc2U7bXV0ZUJ0bi5jbGFzc05hbWU9IiI7bXV0ZUJ0bi50ZXh0Q29udGVudD0iTXV0ZSI7CiAgICB9CiAgfSk7CgogIGNsZWFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+Y2xlYXJUcmFjayh0KSk7CiAgdXBkYXRlVHJhY2tVSSh0KTsKICByZXR1cm4gZWw7Cn0KCmZ1bmN0aW9uIGJ1aWxkVUkoKXsKICBncmlkLmlubmVySFRNTD0iIjt0cmFja3MubGVuZ3RoPTA7CiAgZm9yKGxldCBpPTA7aTxUUkFDS1M7aSsrKXsKICAgIGNvbnN0IHQ9Y3JlYXRlVHJhY2soaSk7CiAgICB0cmFja3MucHVzaCh0KTsKICAgIGdyaWQuYXBwZW5kQ2hpbGQoYnVpbGRUcmFja0NhcmQodCkpOwogIH0KICB1cGRhdGVHbG9iYWxCdXR0b25zKCk7Cn0KCmFzeW5jIGZ1bmN0aW9uIGluaXRBdWRpbygpewogIGlmKGlzSW5pdGlhbGl6ZWQpIHJldHVybjsKICBhdWRpb0N0eD1uZXcod2luZG93LkF1ZGlvQ29udGV4dHx8d2luZG93LndlYmtpdEF1ZGlvQ29udGV4dCkoKTsKICBzckVsLnRleHRDb250ZW50PWF1ZGlvQ3R4LnNhbXBsZVJhdGUrIiBIeiI7CiAgbWFzdGVyR2Fpbj1hdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgbWFzdGVyR2Fpbi5nYWluLnZhbHVlPTAuOTsKICBtYXN0ZXJHYWluLmNvbm5lY3QoYXVkaW9DdHguZGVzdGluYXRpb24pOwogIGNvbnN0IG1vZGU9c291cmNlU2VsZWN0LnZhbHVlOwogIGlmKG1vZGU9PT0ibWljIil7CiAgICBpbnB1dFN0cmVhbT1hd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7CiAgICAgIGF1ZGlvOntlY2hvQ2FuY2VsbGF0aW9uOmZhbHNlLG5vaXNlU3VwcHJlc3Npb246ZmFsc2UsYXV0b0dhaW5Db250cm9sOmZhbHNlfSx2aWRlbzpmYWxzZX0pOwogIH0gZWxzZSB7CiAgICBpbnB1dFN0cmVhbT1hd2FpdCBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYSh7YXVkaW86dHJ1ZSx2aWRlbzp0cnVlfSk7CiAgfQogIGZvcihjb25zdCB0IG9mIHRyYWNrcyl7CiAgICB0LmdhaW5Ob2RlPWF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgIHQuZ2Fpbk5vZGUuZ2Fpbi52YWx1ZT1wYXJzZUZsb2F0KHQudWkudm9sLnZhbHVlKTsKICAgIHQuZ2Fpbk5vZGUuY29ubmVjdChtYXN0ZXJHYWluKTsKICB9CiAgYXdhaXQgYXVkaW9DdHgucmVzdW1lKCk7CiAgaXNJbml0aWFsaXplZD10cnVlO3NldERvdHMoKTsKICBidG5Jbml0LnRleHRDb250ZW50PSLinJMgQXVkaW8gYXR0aXZvIjtidG5Jbml0LmRpc2FibGVkPXRydWU7CiAgdXBkYXRlR2xvYmFsQnV0dG9ucygpOwp9CgpidG5Jbml0LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIixhc3luYygpPT57CiAgdHJ5e2J0bkluaXQudGV4dENvbnRlbnQ9IuKApiI7YnRuSW5pdC5kaXNhYmxlZD10cnVlO2F3YWl0IGluaXRBdWRpbygpO30KICBjYXRjaChlKXtjb25zb2xlLmVycm9yKGUpO2J0bkluaXQuZGlzYWJsZWQ9ZmFsc2U7YnRuSW5pdC50ZXh0Q29udGVudD0i4pqhIEF0dGl2YSBBdWRpbyI7c2hvd1RvYXN0KCJFcnJvcmU6ICIrKGU/Lm1lc3NhZ2V8fGUpKTt9CiAgZmluYWxseXtzZXREb3RzKCk7fQp9KTsKYnRuUGxheUFsbC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9Pntmb3IoY29uc3QgdCBvZiB0cmFja3MpaWYodC5idWZmZXImJiF0LmlzUGxheWluZylzdGFydFBsYXliYWNrKHQpO3VwZGF0ZUdsb2JhbEJ1dHRvbnMoKTt9KTsKYnRuU3RvcEFsbC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9Pntmb3IoY29uc3QgdCBvZiB0cmFja3Mpe2lmKHQuaXNQbGF5aW5nKXN0b3BQbGF5YmFjayh0KTtpZih0LmlzUmVjb3JkaW5nKXN0b3BSZWNvcmRpbmcodCk7Y2FuY2VsQ291bnRpbih0KTt9dXBkYXRlR2xvYmFsQnV0dG9ucygpO30pOwpidG5DbGVhckFsbC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9PnsKICBpZighY29uZmlybSgiQ2FuY2VsbGFyZSB0dXR0ZSBsZSB0cmFjY2U/IikpIHJldHVybjsKICBmb3IoY29uc3QgdCBvZiB0cmFja3MpIGNsZWFyVHJhY2sodCk7CiAgbWFzdGVyTG9vcFNlY29uZHM9bnVsbDttYXN0ZXJMZW5FbC50ZXh0Q29udGVudD0i4oCUIjt1cGRhdGVHbG9iYWxCdXR0b25zKCk7Cn0pOwpzb3VyY2VTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwoKT0+e2lmKGlzSW5pdGlhbGl6ZWQpc2hvd1RvYXN0KCJSaWNhcmljYSBsYSBwYWdpbmEgcGVyIGNhbWJpYXJlIHNvcmdlbnRlLiIpO30pOwpzZXRJbnRlcnZhbChzZXREb3RzLDYwMCk7CndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCgpPT57Zm9yKGNvbnN0IHQgb2YgdHJhY2tzKWlmKHQuYnVmZmVyKWRyYXdXYXZlZm9ybSh0LnVpLmNhbnZhcyx0LmJ1ZmZlcik7fSk7CgpidWlsZFVJKCk7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4="}, "03": {"title": "DJ", "b64": "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9Iml0Ij4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgo8dGl0bGU+TUFSQUNBLURKIOKAoiBUUlVFIEtFWSBMT0NLIOKAoiBMT09QIExJQkVSTzwvdGl0bGU+CjxzdHlsZT4KOnJvb3QgewogIC0tYmc6ICMwYTBjMGU7CiAgLS1kZWNrLWJnOiAjMTUxODFiOwogIC0tcGFuZWw6ICMxZTIyMjY7CiAgLS1hY2NlbnQ6ICMyZWYwZDA7CiAgLS13YXJuOiAjZmZiMzQ3OwogIC0tZGFuZ2VyOiAjZmY1ZjZkOwogIC0tdGV4dDogI2YwZjJmNDsKICAtLXN1YjogIzlhYTZiMjsKICAtLWJvcmRlcjogIzJmMzUzYjsKICAtLWJlYXQ6IHJnYmEoNDYsIDI0MCwgMjA4LCAwLjQpOwogIC0tYmVhdC1kb3duOiByZ2JhKDI1NSwgOTUsIDEwOSwgMC44KTsKfQoKKiB7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICBtYXJnaW46IDA7CiAgcGFkZGluZzogMDsKfQoKYm9keSB7CiAgZm9udC1mYW1pbHk6ICdJbnRlcicsICdTZWdvZSBVSScsIHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKICBiYWNrZ3JvdW5kOiB2YXIoLS1iZyk7CiAgY29sb3I6IHZhcigtLXRleHQpOwogIHBhZGRpbmc6IDE2cHg7Cn0KCmgxIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgbGV0dGVyLXNwYWNpbmc6IDRweDsKICBmb250LXNpemU6IDEuMnJlbTsKICBmb250LXdlaWdodDogNDAwOwogIGNvbG9yOiB2YXIoLS1hY2NlbnQpOwogIHBhZGRpbmc6IDhweCAwIDIwcHg7CiAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICB3b3JkLXNwYWNpbmc6IDZweDsKfQoKLmNvbnNvbGUgewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoNCwgMWZyKTsKICBnYXA6IDE0cHg7CiAgbWF4LXdpZHRoOiAxODAwcHg7CiAgbWFyZ2luOiAwIGF1dG87Cn0KCi8qIERFQ0sgKi8KLmRlY2sgewogIGJhY2tncm91bmQ6IHZhcigtLWRlY2stYmcpOwogIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWJvcmRlcik7CiAgYm9yZGVyLXJhZGl1czogMTRweDsKICBwYWRkaW5nOiAxNHB4IDEycHggMTZweDsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgZ2FwOiAxMnB4OwogIHRyYW5zaXRpb246IGJvcmRlciAwLjJzLCBib3gtc2hhZG93IDAuMnM7CiAgYm94LXNoYWRvdzogMCA2cHggMTJweCByZ2JhKDAsMCwwLDAuNSk7Cn0KCi5kZWNrLmFjdGl2ZSB7CiAgYm9yZGVyLWNvbG9yOiB2YXIoLS1hY2NlbnQpOwp9CgouZGVjay5tYXN0ZXIgewogIGJvcmRlci1jb2xvcjogdmFyKC0td2Fybik7CiAgYm94LXNoYWRvdzogMCAwIDE2cHggcmdiYSgyNTUsIDE4MCwgNzAsIDAuMyk7Cn0KCi5kZWNrLnBsYXlpbmcgLmR0aXRsZSB7CiAgY29sb3I6ICM5MGZmYzA7CiAgdGV4dC1zaGFkb3c6IDAgMCA1cHggIzJlZjBkMDsKfQoKLyogSEVBREVSICovCi5kZWNrLWhkciB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGdhcDogNnB4OwogIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogIHBhZGRpbmctYm90dG9tOiAxMHB4Owp9CgouZHRpdGxlIHsKICBmb250LXdlaWdodDogNjAwOwogIGNvbG9yOiB2YXIoLS1hY2NlbnQpOwogIGZvbnQtc2l6ZTogMXJlbTsKICBmbGV4OiAxOwogIGxldHRlci1zcGFjaW5nOiAxcHg7Cn0KCi5tYmFkZ2UgewogIGZvbnQtc2l6ZTogMC42cmVtOwogIGJhY2tncm91bmQ6IHZhcigtLXdhcm4pOwogIGNvbG9yOiAjMDAwOwogIHBhZGRpbmc6IDNweCA3cHg7CiAgYm9yZGVyLXJhZGl1czogMjBweDsKICBmb250LXdlaWdodDogNzAwOwogIGRpc3BsYXk6IG5vbmU7CiAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKfQoKLmRlY2subWFzdGVyIC5tYmFkZ2UgewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKfQoKLmJwbS1ib3ggewogIGZvbnQtZmFtaWx5OiAnSmV0QnJhaW5zIE1vbm8nLCAnQ291cmllciBOZXcnLCBtb25vc3BhY2U7CiAgZm9udC1zaXplOiAxLjFyZW07CiAgYmFja2dyb3VuZDogIzBmMTExNDsKICBjb2xvcjogdmFyKC0tYWNjZW50KTsKICBwYWRkaW5nOiAzcHggOXB4OwogIGJvcmRlci1yYWRpdXM6IDMwcHg7CiAgYm9yZGVyOiAxcHggc29saWQgIzNhNDA0ODsKICBmb250LXdlaWdodDogNjAwOwp9Cgoua2V5LWJveCB7CiAgZm9udC1mYW1pbHk6ICdKZXRCcmFpbnMgTW9ubycsIG1vbm9zcGFjZTsKICBmb250LXNpemU6IDAuODVyZW07CiAgYmFja2dyb3VuZDogIzBmMTExNDsKICBjb2xvcjogI2NmYWFmZjsKICBwYWRkaW5nOiAzcHggOHB4OwogIGJvcmRlci1yYWRpdXM6IDMwcHg7CiAgYm9yZGVyOiAxcHggc29saWQgIzRhM2Y2MDsKICBtaW4td2lkdGg6IDQ4cHg7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KCi50bmFtZSB7CiAgZm9udC1zaXplOiAwLjc1cmVtOwogIGNvbG9yOiAjY2NjOwogIGJhY2tncm91bmQ6ICMxYTFlMjM7CiAgcGFkZGluZzogNnB4IDEwcHg7CiAgYm9yZGVyLXJhZGl1czogMzBweDsKICB3aGl0ZS1zcGFjZTogbm93cmFwOwogIG92ZXJmbG93OiBoaWRkZW47CiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgYm9yZGVyOiAxcHggc29saWQgIzJhMmYzNjsKfQoKLyogV0FWRUZPUk0gQ09OVEFJTkVSICovCi53dyB7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIGhlaWdodDogODBweDsKICBiYWNrZ3JvdW5kOiAjMGMwZjEyOwogIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKICBjdXJzb3I6IGNyb3NzaGFpcjsKICBib3JkZXI6IDFweCBzb2xpZCAjMmMzMjNhOwogIGJveC1zaGFkb3c6IGluc2V0IDAgMnB4IDRweCAjMDAwMDAwNTU7Cn0KCmNhbnZhcyB7CiAgZGlzcGxheTogYmxvY2s7CiAgd2lkdGg6IDEwMCU7CiAgaGVpZ2h0OiAxMDAlOwp9CgouYmdjIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAwOwogIGxlZnQ6IDA7CiAgd2lkdGg6IDEwMCU7CiAgaGVpZ2h0OiAxMDAlOwogIHBvaW50ZXItZXZlbnRzOiBub25lOwp9CgoucGggewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDA7CiAgYm90dG9tOiAwOwogIHdpZHRoOiAycHg7CiAgYmFja2dyb3VuZDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjk1KTsKICBib3gtc2hhZG93OiAwIDAgOHB4IHdoaXRlOwogIHBvaW50ZXItZXZlbnRzOiBub25lOwogIHdpbGwtY2hhbmdlOiBsZWZ0OwogIHotaW5kZXg6IDEwOwp9CgovKiBaT09NIENPTlRST0xTICovCi56b29tLXJvdyB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGdhcDogOHB4OwogIG1hcmdpbi10b3A6IDJweDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1wYW5lbCk7CiAgcGFkZGluZzogNnB4IDEwcHg7CiAgYm9yZGVyLXJhZGl1czogMzBweDsKICBmbGV4LXdyYXA6IHdyYXA7Cn0KCi56b29tLXJvdyBsYWJlbCB7CiAgZm9udC1zaXplOiAwLjc1cmVtOwogIGNvbG9yOiB2YXIoLS1hY2NlbnQpOwogIG1pbi13aWR0aDogMzVweDsKICBmb250LXdlaWdodDogYm9sZDsKfQoKLnpvb20tcm93IGlucHV0IHsKICBmbGV4OiAyOwogIG1pbi13aWR0aDogMTAwcHg7CiAgaGVpZ2h0OiA1cHg7CiAgYWNjZW50LWNvbG9yOiB2YXIoLS1hY2NlbnQpOwp9Cgouem9vbS12YWx1ZSB7CiAgZm9udC1mYW1pbHk6ICdKZXRCcmFpbnMgTW9ubycsIG1vbm9zcGFjZTsKICBmb250LXNpemU6IDAuNzVyZW07CiAgYmFja2dyb3VuZDogIzBmMTExNDsKICBjb2xvcjogdmFyKC0tYWNjZW50KTsKICBwYWRkaW5nOiAzcHggOHB4OwogIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgYm9yZGVyOiAxcHggc29saWQgIzNhNDA0ODsKICBtaW4td2lkdGg6IDU1cHg7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9Cgouem9vbS1idG5zIHsKICBkaXNwbGF5OiBmbGV4OwogIGdhcDogNHB4OwogIGZsZXgtd3JhcDogd3JhcDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOwp9Cgouem9vbS1idG4gewogIGJhY2tncm91bmQ6ICMyZjM1M2Y7CiAgYm9yZGVyOiBub25lOwogIGNvbG9yOiB3aGl0ZTsKICBwYWRkaW5nOiA0cHggOHB4OwogIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgZm9udC1zaXplOiAwLjY1cmVtOwogIGZvbnQtd2VpZ2h0OiBib2xkOwogIGN1cnNvcjogcG9pbnRlcjsKICB0cmFuc2l0aW9uOiAwLjFzOwogIG1pbi13aWR0aDogNDBweDsKfQoKLnpvb20tYnRuOmhvdmVyIHsKICBiYWNrZ3JvdW5kOiAjNDA0ODU0Owp9Cgouem9vbS1idG4uYWN0aXZlIHsKICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQpOwogIGNvbG9yOiAjMDAwOwp9CgovKiBMT09QIENPTlRST0xTIC0gTlVPVkkgKi8KLmxvb3Atc2VjdGlvbiB7CiAgYmFja2dyb3VuZDogdmFyKC0tcGFuZWwpOwogIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgcGFkZGluZzogOHB4IDEwcHg7Cn0KCi5sb29wLXRpdGxlIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIG1hcmdpbi1ib3R0b206IDZweDsKfQoKLmxvb3AtdGl0bGUgc3BhbiB7CiAgZm9udC1zaXplOiAwLjY4cmVtOwogIGNvbG9yOiB2YXIoLS1hY2NlbnQpOwogIGZvbnQtd2VpZ2h0OiA2MDA7CiAgbGV0dGVyLXNwYWNpbmc6IDFweDsKICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwp9CgoubG9vcC1tb2RlLWJ0biB7CiAgYmFja2dyb3VuZDogIzJmMzUzZjsKICBjb2xvcjogI2FhYTsKICBib3JkZXI6IG5vbmU7CiAgcGFkZGluZzogM3B4IDhweDsKICBib3JkZXItcmFkaXVzOiAyMHB4OwogIGZvbnQtc2l6ZTogMC42cmVtOwogIGZvbnQtd2VpZ2h0OiBib2xkOwogIGN1cnNvcjogcG9pbnRlcjsKfQoKLmxvb3AtbW9kZS1idG4uYWN0aXZlIHsKICBiYWNrZ3JvdW5kOiB2YXIoLS1hY2NlbnQpOwogIGNvbG9yOiAjMDAwOwp9CgoubG9vcC1ncmlkIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDQsIDFmcik7CiAgZ2FwOiA0cHg7CiAgbWFyZ2luLWJvdHRvbTogNnB4Owp9CgoubG9vcC1idG4gewogIGJhY2tncm91bmQ6ICMyZDMzM2I7CiAgY29sb3I6ICNiMGMwZDA7CiAgYm9yZGVyOiBub25lOwogIHBhZGRpbmc6IDZweCAwOwogIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgZm9udC1zaXplOiAwLjY1cmVtOwogIGZvbnQtd2VpZ2h0OiBib2xkOwogIGN1cnNvcjogcG9pbnRlcjsKICB0cmFuc2l0aW9uOiAwLjFzOwp9CgoubG9vcC1idG4ub24gewogIGJhY2tncm91bmQ6ICNjNTZiZjA7CiAgY29sb3I6ICNmZmY7Cn0KCi5sb29wLWJ0bi5mcmVlIHsKICBiYWNrZ3JvdW5kOiAjM2EyZTRhOwogIGNvbG9yOiAjZDBiMGZmOwp9CgoubG9vcC1mcmVlLWNvbnRyb2xzIHsKICBkaXNwbGF5OiBmbGV4OwogIGdhcDogNHB4OwogIG1hcmdpbi10b3A6IDZweDsKfQoKLmxvb3AtZnJlZS1idG4gewogIGZsZXg6IDE7CiAgYmFja2dyb3VuZDogIzM1MmQ0MjsKICBjb2xvcjogI2NmYWFmZjsKICBib3JkZXI6IG5vbmU7CiAgcGFkZGluZzogNnB4IDA7CiAgYm9yZGVyLXJhZGl1czogMjBweDsKICBmb250LXNpemU6IDAuNjVyZW07CiAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgY3Vyc29yOiBwb2ludGVyOwogIHRyYW5zaXRpb246IDAuMXM7Cn0KCi5sb29wLWZyZWUtYnRuOmhvdmVyIHsKICBiYWNrZ3JvdW5kOiAjNGEzYTVhOwp9CgoubG9vcC1mcmVlLWJ0bi5hY3RpdmUgewogIGJhY2tncm91bmQ6ICNhYTg4ZmY7CiAgY29sb3I6ICMwMDA7Cn0KCi5sb29wLW9mZi1idG4gewogIGJhY2tncm91bmQ6ICM1YTNhM2E7CiAgY29sb3I6ICNkZGQ7CiAgYm9yZGVyOiBub25lOwogIHBhZGRpbmc6IDZweCAwOwogIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgZm9udC1zaXplOiAwLjY1cmVtOwogIGZvbnQtd2VpZ2h0OiBib2xkOwogIGN1cnNvcjogcG9pbnRlcjsKICB3aWR0aDogMTAwJTsKICBtYXJnaW4tdG9wOiA0cHg7Cn0KCi8qIFBBTkVMUyAqLwouc3ViIHsKICBiYWNrZ3JvdW5kOiB2YXIoLS1wYW5lbCk7CiAgYm9yZGVyLXJhZGl1czogMTJweDsKICBwYWRkaW5nOiAxMHB4IDEwcHg7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIGdhcDogOHB4Owp9Cgouc3ViLXRpdGxlIHsKICBmb250LXNpemU6IDAuNjhyZW07CiAgY29sb3I6IHZhcigtLWFjY2VudCk7CiAgZm9udC13ZWlnaHQ6IDYwMDsKICBsZXR0ZXItc3BhY2luZzogMXB4OwogIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgb3BhY2l0eTogMC45Owp9Cgoucm93IHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgZ2FwOiA2cHg7CiAgZmxleC13cmFwOiB3cmFwOwp9CgovKiBCVVRUT05TICovCmJ1dHRvbiB7CiAgYm9yZGVyOiBub25lOwogIGJvcmRlci1yYWRpdXM6IDMwcHg7CiAgY3Vyc29yOiBwb2ludGVyOwogIGZvbnQtd2VpZ2h0OiA2MDA7CiAgZm9udC1zaXplOiAwLjdyZW07CiAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICB0cmFuc2l0aW9uOiAwLjA4czsKICBsZXR0ZXItc3BhY2luZzogMC4zcHg7Cn0KCmJ1dHRvbjphY3RpdmUgewogIHRyYW5zZm9ybTogc2NhbGUoMC45Nik7Cn0KCi5icCB7CiAgYmFja2dyb3VuZDogIzJjYzU2ZTsKICBjb2xvcjogIzAwMDsKICBwYWRkaW5nOiA4cHg7Cn0KCi5icyB7CiAgYmFja2dyb3VuZDogdmFyKC0tZGFuZ2VyKTsKICBjb2xvcjogI2ZmZjsKICBwYWRkaW5nOiA4cHg7Cn0KCi5ibSB7CiAgYmFja2dyb3VuZDogdmFyKC0td2Fybik7CiAgY29sb3I6ICMwMDA7CiAgcGFkZGluZzogOHB4Owp9CgouYnN5bmMgewogIGJhY2tncm91bmQ6ICMzZjdlZTA7CiAgY29sb3I6ICNmZmY7CiAgcGFkZGluZzogOHB4Owp9CgouYmRlZiB7CiAgYmFja2dyb3VuZDogIzNhNDA0YTsKICBjb2xvcjogI2RkZDsKICBwYWRkaW5nOiA1cHggMTBweDsKfQoKLmJsb2NrIHsKICBiYWNrZ3JvdW5kOiAjNDQ0YzU4OwogIGNvbG9yOiAjZmZmOwogIGZsZXg6IDE7CiAgcGFkZGluZzogOHB4Owp9CgouYmxvY2subG9ja2VkIHsKICBiYWNrZ3JvdW5kOiAjZmY0NDQ0OwogIGNvbG9yOiAjZmZmOwogIGJveC1zaGFkb3c6IDAgMCAxNXB4ICNmZjQ0NDQ7CiAgYW5pbWF0aW9uOiBwdWxzZSAxLjVzIGluZmluaXRlOwp9CgpAa2V5ZnJhbWVzIHB1bHNlIHsKICAwJSB7IG9wYWNpdHk6IDE7IH0KICA1MCUgeyBvcGFjaXR5OiAwLjg7IGJveC1zaGFkb3c6IDAgMCAyMHB4ICNmZjQ0NDQ7IH0KICAxMDAlIHsgb3BhY2l0eTogMTsgfQp9CgouYm51ZGdlIHsKICBiYWNrZ3JvdW5kOiAjMmEyZjM3OwogIGNvbG9yOiAjYWFhOwogIHBhZGRpbmc6IDVweCAxMHB4OwogIGZvbnQtc2l6ZTogMC43cmVtOwp9CgovKiBHUklEUyAqLwouZzIgewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgMWZyOwogIGdhcDogOHB4Owp9CgovKiBTTElERVJTICovCi5zZyB7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIGdhcDogNHB4Owp9Cgouc2cgbGFiZWwgewogIGZvbnQtc2l6ZTogMC43cmVtOwogIGNvbG9yOiB2YXIoLS1zdWIpOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwp9CgppbnB1dFt0eXBlPXJhbmdlXSB7CiAgd2lkdGg6IDEwMCU7CiAgY3Vyc29yOiBwb2ludGVyOwogIGFjY2VudC1jb2xvcjogdmFyKC0tYWNjZW50KTsKICBoZWlnaHQ6IDZweDsKfQoKaW5wdXRbdHlwZT1udW1iZXJdLAppbnB1dC5udW0gewogIGJhY2tncm91bmQ6ICMwZDBmMTM7CiAgYm9yZGVyOiAxcHggc29saWQgIzQwNDg1NDsKICBjb2xvcjogdmFyKC0tYWNjZW50KTsKICBwYWRkaW5nOiA1cHggNnB4OwogIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgZm9udC1zaXplOiAwLjc1cmVtOwogIGZvbnQtZmFtaWx5OiAnSmV0QnJhaW5zIE1vbm8nLCBtb25vc3BhY2U7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9CgovKiBTVEFUVVMgQkFSICovCi5zYmFyIHsKICBmb250LXNpemU6IDAuNjVyZW07CiAgY29sb3I6IHZhcigtLXN1Yik7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIG1pbi1oZWlnaHQ6IDE4cHg7CiAgYmFja2dyb3VuZDogIzFlMjMyODsKICBwYWRkaW5nOiA0cHggOHB4OwogIGJvcmRlci1yYWRpdXM6IDMwcHg7Cn0KCi8qIFpPT00gTkFWICovCi56b29tLW5hdiB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGdhcDogNHB4OwogIG1hcmdpbi10b3A6IDJweDsKICBiYWNrZ3JvdW5kOiAjMWExZjI0OwogIHBhZGRpbmc6IDRweCA4cHg7CiAgYm9yZGVyLXJhZGl1czogMjBweDsKfQoKLnpvb20tbmF2IGxhYmVsIHsKICBmb250LXNpemU6IDAuNnJlbTsKICBjb2xvcjogdmFyKC0tc3ViKTsKfQoKLnpvb20tbmF2IGlucHV0IHsKICBmbGV4OiAxOwogIGhlaWdodDogNHB4OwogIGFjY2VudC1jb2xvcjogdmFyKC0tYWNjZW50KTsKfQoKLnpvb20tcG9zIHsKICBmb250LXNpemU6IDAuNnJlbTsKICBjb2xvcjogdmFyKC0tYWNjZW50KTsKICBiYWNrZ3JvdW5kOiAjMGYxMTE0OwogIHBhZGRpbmc6IDJweCA2cHg7CiAgYm9yZGVyLXJhZGl1czogMTBweDsKICBtaW4td2lkdGg6IDQ1cHg7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9CgovKiBNSVhFUiAqLwoubWl4ZXIgewogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgYmFja2dyb3VuZDogIzE0MWExZjsKICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOwogIGJvcmRlci1yYWRpdXM6IDQwcHg7CiAgcGFkZGluZzogMThweCAyMnB4OwogIG1hcmdpbi10b3A6IDEwcHg7Cn0KCi5teC10aXRsZSB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIGZvbnQtc2l6ZTogMC44cmVtOwogIGZvbnQtd2VpZ2h0OiA2MDA7CiAgY29sb3I6IHZhcigtLWFjY2VudCk7CiAgbGV0dGVyLXNwYWNpbmc6IDNweDsKICBtYXJnaW4tYm90dG9tOiAxMnB4OwogIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7Cn0KCi5teC1pbm5lciB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGdhcDogNDBweDsKICBmbGV4LXdyYXA6IHdyYXA7Cn0KCi5teC1pdGVtIHsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICBnYXA6IDZweDsKICBtaW4td2lkdGg6IDIwMHB4Owp9CgouY2YtbGFiIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICB3aWR0aDogMTAwJTsKICBmb250LXNpemU6IDAuN3JlbTsKICBjb2xvcjogI2FhYTsKfQoKLyogUkVTUE9OU0lWRSAqLwpAbWVkaWEgKG1heC13aWR0aDogMTIwMHB4KSB7CiAgLmNvbnNvbGUgeyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCgyLCAxZnIpOyB9Cn0KQG1lZGlhIChtYXgtd2lkdGg6IDcwMHB4KSB7CiAgLmNvbnNvbGUgeyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmcjsgfQp9Cjwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CjxoMT7imqEgTUFSQUNBLURKIMK3IFRSVUUgS0VZIExPQ0sgwrcgTE9PUCBMSUJFUk8vTUFOVUFMIOKaoTwvaDE+CjxkaXYgY2xhc3M9ImNvbnNvbGUiIGlkPSJjb25zb2xlIj48L2Rpdj4KCjxzY3JpcHQ+CihmdW5jdGlvbigpIHsKICBjb25zdCBBQyA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDsKICBjb25zdCBjdHggPSBuZXcgQUMoKTsKICAKICAvLyBJTVBPUlRBTlRFOiBBYmlsaXRhIGlsIHRpbWUgc3RyZXRjaGluZyBkaSBhbHRhIHF1YWxpdMOgCiAgaWYgKGN0eC5jcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2UpIHsKICAgIC8vIEdpw6AgYWJpbGl0YXRvIGRpIGRlZmF1bHQKICB9CgogIGNvbnN0IG1hc3RlckdhaW4gPSBjdHguY3JlYXRlR2FpbigpOwogIG1hc3RlckdhaW4uZ2Fpbi52YWx1ZSA9IDAuODsKICBtYXN0ZXJHYWluLmNvbm5lY3QoY3R4LmRlc3RpbmF0aW9uKTsKCiAgbGV0IG1hc3RlcklkeCA9IDA7CiAgbGV0IGNmVmFsID0gMC41OwogIGNvbnN0IE4gPSA0OwoKICAvLyAtLS0gQ3JlYSBkZWNrIGRhdGEgY29uIFNVUFBPUlRPIEtFWSBMT0NLIFZFUk8gLS0tCiAgZnVuY3Rpb24gY3JlYXRlRGVja0RhdGEoKSB7CiAgICBjb25zdCBnYWluTm9kZSA9IGN0eC5jcmVhdGVHYWluKCk7CiAgICBnYWluTm9kZS5jb25uZWN0KG1hc3RlckdhaW4pOwogICAgCiAgICByZXR1cm4gewogICAgICBidWY6IG51bGwsCiAgICAgIHNyYzogbnVsbCwKICAgICAgZ2Fpbk5vZGU6IGdhaW5Ob2RlLAogICAgICBicG06IDEyMCwKICAgICAgYnBtTmF0aXZlOiAxMjAsCiAgICAgIGtleTogbnVsbCwKICAgICAga2V5U2hpZnQ6IDAsCiAgICAgIHNwZWVkOiAxLjAsCiAgICAgIHZvbDogMS4wLAogICAgICBwbGF5aW5nOiBmYWxzZSwKICAgICAgb2ZmOiAwLAogICAgICBzdDogMCwKICAgICAgYmVhdE9mZk1zOiAwLAogICAgICAKICAgICAgLy8gTG9vcCBzZXR0aW5ncwogICAgICBsb29wQmVhdHM6IDAsCiAgICAgIGxvb3BTdGFydDogMCwKICAgICAgbG9vcE1vZGU6ICdiZWF0JywgLy8gJ2JlYXQnIG8gJ2ZyZWUnCiAgICAgIGZyZWVMb29wU3RhcnQ6IDAsCiAgICAgIGZyZWVMb29wRW5kOiAwLAogICAgICAKICAgICAgLy8gVFJVRSBLRVkgTE9DSwogICAgICBsb2NrS2V5OiBmYWxzZSwgICAgIC8vIFF1YW5kbyB0cnVlLCBwaXRjaCByaW1hbmUgY29zdGFudGUKICAgICAgCiAgICAgIHBlYWtzOiBudWxsLAogICAgICB6b29tOiAxLjAsCiAgICAgIHpvb21Qb3M6IDAuNQogICAgfTsKICB9CgogIGNvbnN0IEQgPSBbXTsKICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgRC5wdXNoKGNyZWF0ZURlY2tEYXRhKCkpOwogIH0KCiAgLy8gLS0tIFV0aWxpdHkgLS0tCiAgY29uc3QgJCA9IGlkID0+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKICBjb25zdCBzdGF0dXMgPSAoaSwgbXNnKSA9PiB7IGNvbnN0IGVsID0gJChgc2ItJHtpfWApOyBpZiAoZWwpIGVsLnRleHRDb250ZW50ID0gbXNnOyB9OwoKICBjb25zdCByZXN1bWVDdHggPSAoKSA9PiB7IGlmIChjdHguc3RhdGUgPT09ICdzdXNwZW5kZWQnKSBjdHgucmVzdW1lKCk7IH07CgogIC8vIC0tLSBDcm9zc2ZhZGVyIC0tLQogIGZ1bmN0aW9uIGNmR2FpbihpZHgpIHsKICAgIHJldHVybiBpZHggPT09IDAgPyAxIC0gY2ZWYWwgOiBpZHggPT09IDEgPyBjZlZhbCA6IDEuMDsKICB9CgogIGZ1bmN0aW9uIGFwcGx5Vm9sdW1lKGkpIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgZC5nYWluTm9kZS5nYWluLnNldFRhcmdldEF0VGltZShkLnZvbCAqIGNmR2FpbihpKSwgY3R4LmN1cnJlbnRUaW1lLCAwLjAxNSk7CiAgfQoKICBmdW5jdGlvbiBzZXRWb2x1bWUoaSwgdikgewogICAgRFtpXS52b2wgPSArdjsKICAgICQoYHZ2LSR7aX1gKS50ZXh0Q29udGVudCA9IE1hdGgucm91bmQoK3YgKiAxMDApOwogICAgYXBwbHlWb2x1bWUoaSk7CiAgfQoKICBmdW5jdGlvbiBzZXRNYXN0ZXJWb2wodikgewogICAgbWFzdGVyR2Fpbi5nYWluLnNldFRhcmdldEF0VGltZSgrdiwgY3R4LmN1cnJlbnRUaW1lLCAwLjAxNSk7CiAgICAkKCdtdnYnKS50ZXh0Q29udGVudCA9IE1hdGgucm91bmQoK3YgKiAxMDApOwogIH0KCiAgZnVuY3Rpb24gc2V0Q0YodikgewogICAgY2ZWYWwgPSArdjsKICAgIGFwcGx5Vm9sdW1lKDApOwogICAgYXBwbHlWb2x1bWUoMSk7CiAgfQoKICAvLyAtLS0gUmVuZGVyIGRlY2tzIC0tLQogIGZ1bmN0aW9uIHJlbmRlckRlY2tzKCkgewogICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnNvbGUnKTsKICAgIGxldCBodG1sID0gJyc7CiAgICBjb25zdCBkZWNrTmFtZXMgPSBbJ0EnLCAnQicsICdDJywgJ0QnXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTjsgaSsrKSB7CiAgICAgIGh0bWwgKz0gYAogICAgICAgIDxkaXYgY2xhc3M9ImRlY2siIGlkPSJkay0ke2l9Ij4KICAgICAgICAgIDxkaXYgY2xhc3M9ImRlY2staGRyIj4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImR0aXRsZSIgaWQ9ImR0LSR7aX0iPkRFQ0sgJHtkZWNrTmFtZXNbaV19PC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ibWJhZGdlIiBpZD0ibWItJHtpfSI+TUFTVEVSPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ia2V5LWJveCIgaWQ9Imtib3gtJHtpfSI+LS08L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJicG0tYm94IiBpZD0iYmItJHtpfSI+LS08L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxpbnB1dCB0eXBlPSJmaWxlIiBhY2NlcHQ9ImF1ZGlvLyoiIHN0eWxlPSJmb250LXNpemU6MC43NXJlbTsgYmFja2dyb3VuZDojMWYyNTJiOyBib3JkZXI6bm9uZTsgY29sb3I6I2NjYzsgcGFkZGluZzo1cHg7IGJvcmRlci1yYWRpdXM6MzBweDsiIG9uY2hhbmdlPSJ3aW5kb3cubG9hZFRyYWNrKCR7aX0sIHRoaXMpIj4KICAgICAgICAgIDxkaXYgY2xhc3M9InRuYW1lIiBpZD0idG4tJHtpfSI+TmVzc3VuYSB0cmFjY2lhPC9kaXY+CgogICAgICAgICAgPCEtLSBXQVZFRk9STSArIFpPT00gLS0+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJ3dyIgaWQ9Ind3LSR7aX0iIG9uY2xpY2s9IndpbmRvdy5zZWVrQ2xpY2soJHtpfSwgZXZlbnQpIj4KICAgICAgICAgICAgPGNhbnZhcyBpZD0id2MtJHtpfSI+PC9jYW52YXM+CiAgICAgICAgICAgIDxjYW52YXMgY2xhc3M9ImJnYyIgaWQ9ImdjLSR7aX0iPjwvY2FudmFzPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJwaCIgaWQ9InBoLSR7aX0iPjwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICAKICAgICAgICAgIDwhLS0gWk9PTSBDT05UUk9MUyAtLT4KICAgICAgICAgIDxkaXYgY2xhc3M9Inpvb20tcm93Ij4KICAgICAgICAgICAgPGxhYmVsPvCflI08L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGlkPSJ6b29tLSR7aX0iIG1pbj0iMSIgbWF4PSIxMCIgc3RlcD0iMC4xIiB2YWx1ZT0iMSIgb25pbnB1dD0id2luZG93LnNldFpvb20oJHtpfSwgdGhpcy52YWx1ZSkiPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0iem9vbS12YWx1ZSIgaWQ9Inpvb20tdmFsLSR7aX0iPjEuMHg8L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIAogICAgICAgICAgPCEtLSBOQVZJR0FaSU9ORSBaT09NIC0tPgogICAgICAgICAgPGRpdiBjbGFzcz0iem9vbS1uYXYiPgogICAgICAgICAgICA8bGFiZWw+4o+677iPPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBpZD0iem9vbS1wb3MtJHtpfSIgbWluPSIwIiBtYXg9IjEiIHN0ZXA9IjAuMDAxIiB2YWx1ZT0iMC41IiBvbmlucHV0PSJ3aW5kb3cuc2V0Wm9vbVBvcygke2l9LCB0aGlzLnZhbHVlKSI+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ6b29tLXBvcyIgaWQ9Inpvb20tcG9zLXZhbC0ke2l9Ij41MCU8L3NwYW4+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIAogICAgICAgICAgPGRpdiBjbGFzcz0iem9vbS1idG5zIj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iem9vbS1idG4iIG9uY2xpY2s9IndpbmRvdy5zZXRab29tKCR7aX0sIDEpIj4xeDwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ6b29tLWJ0biIgb25jbGljaz0id2luZG93LnNldFpvb20oJHtpfSwgMikiPjJ4PC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Inpvb20tYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2V0Wm9vbSgke2l9LCA0KSI+NHg8L2J1dHRvbj4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iem9vbS1idG4iIG9uY2xpY2s9IndpbmRvdy5zZXRab29tKCR7aX0sIDYpIj42eDwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJ6b29tLWJ0biIgb25jbGljaz0id2luZG93LnNldFpvb20oJHtpfSwgOCkiPjh4PC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Inpvb20tYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2V0Wm9vbSgke2l9LCAxMCkiPjEweDwvYnV0dG9uPgogICAgICAgICAgPC9kaXY+CgogICAgICAgICAgPGRpdiBjbGFzcz0ic3ViIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3ViLXRpdGxlIj7impnvuI8gQmVhdCBHcmlkIDQvNDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgICAgIDxsYWJlbCBzdHlsZT0id2hpdGUtc3BhY2U6bm93cmFwIj5PZmZzZXQgKG1zKTo8L2xhYmVsPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJudWRnZSIgb25jbGljaz0id2luZG93Lm51ZGdlKCR7aX0sIC0xMCkiPi0xMDwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJudWRnZSIgb25jbGljaz0id2luZG93Lm51ZGdlKCR7aX0sIC0xKSI+LTE8L2J1dHRvbj4KICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBjbGFzcz0ibnVtIiBpZD0iYm9mZi0ke2l9IiB2YWx1ZT0iMCIgc3RlcD0iMSIgc3R5bGU9IndpZHRoOjYwcHgiIG9uaW5wdXQ9IndpbmRvdy5zZXRPZmZzZXQoJHtpfSwgdGhpcy52YWx1ZSkiPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJudWRnZSIgb25jbGljaz0id2luZG93Lm51ZGdlKCR7aX0sIDEpIj4rMTwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJudWRnZSIgb25jbGljaz0id2luZG93Lm51ZGdlKCR7aX0sIDEwKSI+KzEwPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgICAgIDxsYWJlbD5CUE0gbWFudWFsZTo8L2xhYmVsPgogICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJudW1iZXIiIGNsYXNzPSJudW0iIGlkPSJibS0ke2l9IiBzdGVwPSIwLjEiIG1pbj0iNDAiIG1heD0iMjUwIiBwbGFjZWhvbGRlcj0iYXV0byIgc3R5bGU9IndpZHRoOjcwcHgiIG9uaW5wdXQ9IndpbmRvdy5zZXRNYW51YWxCUE0oJHtpfSwgdGhpcy52YWx1ZSkiPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJkZWYiIHN0eWxlPSJwYWRkaW5nOjVweCAxMHB4OyIgb25jbGljaz0id2luZG93LnJlc2V0QlBNKCR7aX0pIj5BdXRvPC9idXR0b24+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPC9kaXY+CgogICAgICAgICAgPGRpdiBjbGFzcz0ic3ViIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3ViLXRpdGxlIj7wn468IFRvbmFsaXTDoDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgICAgIDxsYWJlbD5SaWxldmF0YTo8L2xhYmVsPgogICAgICAgICAgICAgIDxzcGFuIGlkPSJrZGV0LSR7aX0iIHN0eWxlPSJjb2xvcjojY2ZhYWZmO2ZvbnQtc2l6ZTowLjhyZW07bWluLXdpZHRoOjMwcHgiPi0tPC9zcGFuPgogICAgICAgICAgICAgIDxsYWJlbD5TaGlmdCAoc2VtaSk6PC9sYWJlbD4KICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBjbGFzcz0ibnVtIiBpZD0ia3MtJHtpfSIgdmFsdWU9IjAiIHN0ZXA9IjEiIG1pbj0iLTEyIiBtYXg9IjEyIiBzdHlsZT0id2lkdGg6NTVweCIgb25pbnB1dD0id2luZG93LnNldEtleVNoaWZ0KCR7aX0sIHRoaXMudmFsdWUpIj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICA8ZGl2IGNsYXNzPSJnMiI+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJwIiBvbmNsaWNrPSJ3aW5kb3cucGxheURlY2soJHtpfSkiPuKWtiBQbGF5PC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJzIiBvbmNsaWNrPSJ3aW5kb3cuc3RvcERlY2soJHtpfSkiPuKPuSBTdG9wPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJtIiBzdHlsZT0iZm9udC1zaXplOjAuNjVyZW0iIG9uY2xpY2s9IndpbmRvdy5zZXRNYXN0ZXIoJHtpfSkiPvCfkZEgTWFzdGVyPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJzeW5jIiBzdHlsZT0iZm9udC1zaXplOjAuNjVyZW0iIG9uY2xpY2s9IndpbmRvdy5zeW5jRGVjaygke2l9KSI+8J+UgSBTeW5jPC9idXR0b24+CiAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICA8ZGl2IGNsYXNzPSJyb3ciPgogICAgICAgICAgICA8bGFiZWw+8J+UkiBUUlVFIEtFWSBMT0NLOjwvbGFiZWw+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJsb2NrIiBpZD0ibGstJHtpfSIgb25jbGljaz0id2luZG93LnRvZ2dsZUtleUxvY2soJHtpfSkiPktFWSBMT0NLIE9GRjwvYnV0dG9uPgogICAgICAgICAgPC9kaXY+CgogICAgICAgICAgPGRpdiBjbGFzcz0ic2ciPgogICAgICAgICAgICA8bGFiZWw+VmVsb2NpdMOgOiA8c3BhbiBpZD0icnYtJHtpfSI+MS4wMDA8L3NwYW4+eDwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9InJzLSR7aX0iIG1pbj0iMC41IiBtYXg9IjIuMCIgc3RlcD0iMC4wMDEiIHZhbHVlPSIxIiBvbmlucHV0PSJ3aW5kb3cuc2V0U3BlZWQoJHtpfSwgdGhpcy52YWx1ZSkiPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzZyI+CiAgICAgICAgICAgIDxsYWJlbD5Wb2x1bWU6IDxzcGFuIGlkPSJ2di0ke2l9Ij4xMDA8L3NwYW4+JTwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9InZzLSR7aX0iIG1pbj0iMCIgbWF4PSIxIiBzdGVwPSIwLjAxIiB2YWx1ZT0iMSIgb25pbnB1dD0id2luZG93LnNldFZvbHVtZSgke2l9LCB0aGlzLnZhbHVlKSI+CiAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICA8IS0tIExPT1AgU0VDVElPTiAtIE5VT1ZBIFZFUlNJT05FIENPTiBMT09QIExJQkVSTyAtLT4KICAgICAgICAgIDxkaXYgY2xhc3M9Imxvb3Atc2VjdGlvbiI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Imxvb3AtdGl0bGUiPgogICAgICAgICAgICAgIDxzcGFuPvCflIQgTE9PUDwvc3Bhbj4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJsb29wLW1vZGUtYnRuIiBpZD0ibG9vcC1tb2RlLSR7aX0iIG9uY2xpY2s9IndpbmRvdy50b2dnbGVMb29wTW9kZSgke2l9KSI+TU9ERTogQkVBVDwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgCiAgICAgICAgICAgIDwhLS0gQkVBVCBMT09QIChiYXNhdG8gc3UgYmF0dHV0ZSkgLS0+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Imxvb3AtZ3JpZCIgaWQ9ImJlYXQtbG9vcC0ke2l9Ij4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJsb29wLWJ0biIgb25jbGljaz0id2luZG93LnNldEJlYXRMb29wKCR7aX0sIDEpIj4xPC9idXR0b24+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibG9vcC1idG4iIG9uY2xpY2s9IndpbmRvdy5zZXRCZWF0TG9vcCgke2l9LCAyKSI+MjwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imxvb3AtYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2V0QmVhdExvb3AoJHtpfSwgMykiPjM8L2J1dHRvbj4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJsb29wLWJ0biIgb25jbGljaz0id2luZG93LnNldEJlYXRMb29wKCR7aX0sIDQpIj40PC9idXR0b24+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibG9vcC1idG4iIG9uY2xpY2s9IndpbmRvdy5zZXRCZWF0TG9vcCgke2l9LCA1KSI+NTwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imxvb3AtYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2V0QmVhdExvb3AoJHtpfSwgNikiPjY8L2J1dHRvbj4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJsb29wLWJ0biIgb25jbGljaz0id2luZG93LnNldEJlYXRMb29wKCR7aX0sIDcpIj43PC9idXR0b24+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibG9vcC1idG4iIG9uY2xpY2s9IndpbmRvdy5zZXRCZWF0TG9vcCgke2l9LCA4KSI+ODwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imxvb3AtYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2V0QmVhdExvb3AoJHtpfSwgMTIpIj4xMjwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imxvb3AtYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2V0QmVhdExvb3AoJHtpfSwgMTYpIj4xNjwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imxvb3AtYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2V0QmVhdExvb3AoJHtpfSwgMjQpIj4yNDwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imxvb3AtYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2V0QmVhdExvb3AoJHtpfSwgMzIpIj4zMjwvYnV0dG9uPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgCiAgICAgICAgICAgIDwhLS0gRlJFRSBMT09QIChtYW51YWxlKSAtLT4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibG9vcC1mcmVlLWNvbnRyb2xzIiBpZD0iZnJlZS1sb29wLSR7aX0iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+CiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibG9vcC1mcmVlLWJ0biIgaWQ9Imxvb3AtaW4tJHtpfSIgb25jbGljaz0id2luZG93LnNldExvb3BJbigke2l9KSI+4o+6IExPT1AgSU48L2J1dHRvbj4KICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJsb29wLWZyZWUtYnRuIiBpZD0ibG9vcC1vdXQtJHtpfSIgb25jbGljaz0id2luZG93LnNldExvb3BPdXQoJHtpfSkiPuKPuSBMT09QIE9VVDwvYnV0dG9uPgogICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Imxvb3AtZnJlZS1idG4iIGlkPSJjbGVhci1mcmVlLSR7aX0iIG9uY2xpY2s9IndpbmRvdy5jbGVhckZyZWVMb29wKCR7aX0pIj7inYwgQ0xFQVI8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIAogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJsb29wLW9mZi1idG4iIG9uY2xpY2s9IndpbmRvdy5jbGVhckFsbExvb3AoJHtpfSkiPkxPT1AgT0ZGPC9idXR0b24+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIAogICAgICAgICAgPGRpdiBjbGFzcz0ic2JhciIgaWQ9InNiLSR7aX0iPjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICBgOwogICAgfQogICAgLy8gTWl4ZXIKICAgIGh0bWwgKz0gYAogICAgICA8ZGl2IGNsYXNzPSJtaXhlciI+CiAgICAgICAgPGRpdiBjbGFzcz0ibXgtdGl0bGUiPvCfjpogTUFTVEVSIE1JWEVSPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ibXgtaW5uZXIiPgogICAgICAgICAgPGRpdiBjbGFzcz0ibXgtaXRlbSI+CiAgICAgICAgICAgIDxsYWJlbD5NYXN0ZXIgVm9sdW1lOiA8c3BhbiBpZD0ibXZ2Ij44MDwvc3Bhbj4lPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhbmdlIiBtaW49IjAiIG1heD0iMSIgc3RlcD0iMC4wMSIgdmFsdWU9IjAuOCIgb25pbnB1dD0id2luZG93LnNldE1hc3RlclZvbCh0aGlzLnZhbHVlKSI+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9Im14LWl0ZW0iPgogICAgICAgICAgICA8bGFiZWw+Q3Jvc3NmYWRlciBBIOKHhCBCPC9sYWJlbD4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2YtbGFiIj48c3Bhbj5ERUNLIEE8L3NwYW4+PHNwYW4+REVDSyBCPC9zcGFuPjwvZGl2PgogICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGlkPSJjZiIgbWluPSIwIiBtYXg9IjEiIHN0ZXA9IjAuMDAxIiB2YWx1ZT0iMC41IiBvbmlucHV0PSJ3aW5kb3cuc2V0Q0YodGhpcy52YWx1ZSkiPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgYDsKICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBodG1sOwogIH0KCiAgcmVuZGVyRGVja3MoKTsKCiAgLy8gLS0tIEVzcG9uaSBmdW56aW9uaSBiYXNlIC0tLQogIHdpbmRvdy5zZXRWb2x1bWUgPSBzZXRWb2x1bWU7CiAgd2luZG93LnNldE1hc3RlclZvbCA9IHNldE1hc3RlclZvbDsKICB3aW5kb3cuc2V0Q0YgPSBzZXRDRjsKCiAgLy8gLS0tIFRSVUUgS0VZIExPQ0sgLSBWRVJTSU9ORSBDT1JSRVRUQSAtLS0KICB3aW5kb3cudG9nZ2xlS2V5TG9jayA9IGZ1bmN0aW9uKGkpIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgZC5sb2NrS2V5ID0gIWQubG9ja0tleTsKICAgIGNvbnN0IGJ0biA9ICQoYGxrLSR7aX1gKTsKICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdsb2NrZWQnLCBkLmxvY2tLZXkpOwogICAgYnRuLnRleHRDb250ZW50ID0gZC5sb2NrS2V5ID8gJ/CflJIgS0VZIExPQ0tFRCAocGl0Y2ggZmlzc28pJyA6ICdLRVkgTE9DSyBPRkYnOwogICAgCiAgICBpZiAoZC5sb2NrS2V5KSB7CiAgICAgIHN0YXR1cyhpLCAn4pyTIFRSVUUgS0VZIExPQ0sgYXR0aXZvIC0gTGEgdmVsb2NpdMOgIE5PTiBhbHRlcmEgaWwgcGl0Y2gnKTsKICAgIH0gZWxzZSB7CiAgICAgIHN0YXR1cyhpLCAnS2V5IExvY2sgZGlzYXR0aXZhdG8nKTsKICAgIH0KICAgIAogICAgLy8gQWdnaW9ybmEgaW1tZWRpYXRhbWVudGUgaWwgcGxheWJhY2sgcmF0ZSBzZSBpbiByaXByb2R1emlvbmUKICAgIGlmIChkLnBsYXlpbmcgJiYgZC5zcmMpIHsKICAgICAgLy8gQ29uIGtleSBsb2NrIGF0dGl2bzogcGl0Y2ggZmFjdG9yID0gMSAoTk9OIHVzYXJlIGtleVNoaWZ0KQogICAgICAvLyBTZW56YSBrZXkgbG9jazogcGl0Y2ggZmFjdG9yID0gMl4oa2V5U2hpZnQvMTIpCiAgICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gZC5sb2NrS2V5ID8gMSA6IE1hdGgucG93KDIsIGQua2V5U2hpZnQgLyAxMik7CiAgICAgIGNvbnN0IHRhcmdldFJhdGUgPSBkLnNwZWVkICogcGl0Y2hGYWN0b3I7CiAgICAgIAogICAgICAvLyBBcHBsaWNhIGlsIG51b3ZvIHJhdGUKICAgICAgZC5zcmMucGxheWJhY2tSYXRlLnNldFRhcmdldEF0VGltZSh0YXJnZXRSYXRlLCBjdHguY3VycmVudFRpbWUsIDAuMDEpOwogICAgICAKICAgICAgY29uc29sZS5sb2coYEtleUxvY2sgJHtkLmxvY2tLZXkgPyAnT04nIDogJ09GRid9OiBzcGVlZD0ke2Quc3BlZWR9LCBwaXRjaEZhY3Rvcj0ke3BpdGNoRmFjdG9yfSwgcmF0ZT0ke3RhcmdldFJhdGV9YCk7CiAgICB9CiAgfTsKCiAgLy8gLS0tIFNwZWVkIC0gQ09SUkVUVEEgY29uIHJpc3BldHRvIGtleSBsb2NrIC0tLQogIHdpbmRvdy5zZXRTcGVlZCA9IGZ1bmN0aW9uKGksIHYpIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgZC5zcGVlZCA9ICt2OwogICAgJChgcnYtJHtpfWApLnRleHRDb250ZW50ID0gKCt2KS50b0ZpeGVkKDMpOwogICAgJChgcnMtJHtpfWApLnZhbHVlID0gK3Y7CiAgICAKICAgIC8vIENhbGNvbGEgaWwgcmF0ZSBmaW5hbGU6CiAgICAvLyAtIFNlIGtleSBsb2NrIGF0dGl2bzogcGl0Y2ggZmFjdG9yID0gMSAocGl0Y2ggb3JpZ2luYWxlKQogICAgLy8gLSBTZSBrZXkgbG9jayBub24gYXR0aXZvOiBwaXRjaCBmYWN0b3IgPSAyXihrZXlTaGlmdC8xMikKICAgIGNvbnN0IHBpdGNoRmFjdG9yID0gZC5sb2NrS2V5ID8gMSA6IE1hdGgucG93KDIsIGQua2V5U2hpZnQgLyAxMik7CiAgICBjb25zdCB0b3RhbFJhdGUgPSBkLnNwZWVkICogcGl0Y2hGYWN0b3I7CiAgICAKICAgIGlmIChkLnNyYykgewogICAgICBkLnNyYy5wbGF5YmFja1JhdGUuc2V0VGFyZ2V0QXRUaW1lKHRvdGFsUmF0ZSwgY3R4LmN1cnJlbnRUaW1lLCAwLjAxKTsKICAgICAgY29uc29sZS5sb2coYHNldFNwZWVkOiBzcGVlZD0ke2Quc3BlZWR9LCBwaXRjaEZhY3Rvcj0ke3BpdGNoRmFjdG9yfSwgcmF0ZT0ke3RvdGFsUmF0ZX0sIGxvY2tLZXk9JHtkLmxvY2tLZXl9YCk7CiAgICB9CiAgICAKICAgIC8vIENhbGNvbGEgQlBNIGVmZmV0dGl2byAoc2VtcHJlIGJhc2F0byBzdWxsYSB2ZWxvY2l0w6ApCiAgICBjb25zdCBlZmZCUE0gPSBkLmJwbU5hdGl2ZSAqIGQuc3BlZWQ7CiAgICAkKGBiYi0ke2l9YCkudGV4dENvbnRlbnQgPSBlZmZCUE0udG9GaXhlZCgxKTsKICAgIAogICAgZHJhd0JHKGkpOwogICAgCiAgICBpZiAoZC5sb2NrS2V5KSB7CiAgICAgIHN0YXR1cyhpLCBgQlBNOiAke2VmZkJQTS50b0ZpeGVkKDEpfSDCtyBLRVkgTE9DS0VEIChwaXRjaCBmaXNzbyBhICR7ZC5rZXkgfHwgJy0tJ30pYCk7CiAgICB9IGVsc2UgewogICAgICBzdGF0dXMoaSwgYEJQTSBlZmZldHRpdm86ICR7ZWZmQlBNLnRvRml4ZWQoMSl9YCk7CiAgICB9CiAgfTsKCiAgLy8gLS0tIEtleSBzaGlmdCAtIENPUlJFVFRBIC0tLQogIHdpbmRvdy5zZXRLZXlTaGlmdCA9IGZ1bmN0aW9uKGksIHYpIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgZC5rZXlTaGlmdCA9IHBhcnNlSW50KHYpIHx8IDA7CiAgICAKICAgIC8vIEFwcGxpY2Egc29sbyBzZSBrZXkgbG9jayBOT04gw6ggYXR0aXZvCiAgICBpZiAoIWQubG9ja0tleSAmJiBkLnNyYykgewogICAgICBjb25zdCBwaXRjaEZhY3RvciA9IE1hdGgucG93KDIsIGQua2V5U2hpZnQgLyAxMik7CiAgICAgIGNvbnN0IHRvdGFsUmF0ZSA9IGQuc3BlZWQgKiBwaXRjaEZhY3RvcjsKICAgICAgZC5zcmMucGxheWJhY2tSYXRlLnNldFRhcmdldEF0VGltZSh0b3RhbFJhdGUsIGN0eC5jdXJyZW50VGltZSwgMC4wMSk7CiAgICAgIGNvbnNvbGUubG9nKGBzZXRLZXlTaGlmdDogc2hpZnQ9JHtkLmtleVNoaWZ0fSwgcmF0ZT0ke3RvdGFsUmF0ZX1gKTsKICAgIH0KICAgIAogICAgLy8gQWdnaW9ybmEgZGlzcGxheSB0b25hbGl0w6AKICAgIHVwZGF0ZUtleURpc3BsYXkoaSk7CiAgfTsKCiAgZnVuY3Rpb24gdXBkYXRlS2V5RGlzcGxheShpKSB7CiAgICBjb25zdCBkID0gRFtpXTsKICAgIGlmIChkLmtleSkgewogICAgICBjb25zdCBub3RlcyA9IFsnQycsICdDIycsICdEJywgJ0QjJywgJ0UnLCAnRicsICdGIycsICdHJywgJ0cjJywgJ0EnLCAnQSMnLCAnQiddOwogICAgICBjb25zdCBpc01pbiA9IGQua2V5LmVuZHNXaXRoKCdtJyk7CiAgICAgIGNvbnN0IGJhc2VOb3RlID0gZC5rZXkucmVwbGFjZSgnbScsICcnKTsKICAgICAgY29uc3QgaWR4ID0gbm90ZXMuaW5kZXhPZihiYXNlTm90ZSk7CiAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgY29uc3QgbmV3SWR4ID0gKGlkeCArIGQua2V5U2hpZnQgKyAxMjApICUgMTI7CiAgICAgICAgY29uc3QgbmV3Tm90ZSA9IG5vdGVzW25ld0lkeF0gKyAoaXNNaW4gPyAnbScgOiAnJyk7CiAgICAgICAgJChga2JveC0ke2l9YCkudGV4dENvbnRlbnQgPSBuZXdOb3RlOwogICAgICAgIAogICAgICAgIGlmIChkLmxvY2tLZXkpIHsKICAgICAgICAgIHN0YXR1cyhpLCBgS2V5IHZpc3VhbDogJHtuZXdOb3RlfSAocGl0Y2ggb3JpZ2luYWxlOiAke2Qua2V5fSlgKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICQoYGtib3gtJHtpfWApLnRleHRDb250ZW50ID0gJy0tJzsKICAgIH0KICB9CgogIC8vIC0tLSBMb29wIE1vZGUgVG9nZ2xlIChCRUFUIC8gRlJFRSkgLS0tCiAgd2luZG93LnRvZ2dsZUxvb3BNb2RlID0gZnVuY3Rpb24oaSkgewogICAgY29uc3QgZCA9IERbaV07CiAgICBkLmxvb3BNb2RlID0gZC5sb29wTW9kZSA9PT0gJ2JlYXQnID8gJ2ZyZWUnIDogJ2JlYXQnOwogICAgY29uc3QgYnRuID0gJChgbG9vcC1tb2RlLSR7aX1gKTsKICAgIGJ0bi50ZXh0Q29udGVudCA9IGBNT0RFOiAke2QubG9vcE1vZGUudG9VcHBlckNhc2UoKX1gOwogICAgCiAgICAvLyBNb3N0cmEvbmFzY29uZGkgY29udHJvbGxpIGFwcHJvcHJpYXRpCiAgICBjb25zdCBiZWF0RGl2ID0gJChgYmVhdC1sb29wLSR7aX1gKTsKICAgIGNvbnN0IGZyZWVEaXYgPSAkKGBmcmVlLWxvb3AtJHtpfWApOwogICAgCiAgICBpZiAoZC5sb29wTW9kZSA9PT0gJ2JlYXQnKSB7CiAgICAgIGJlYXREaXYuc3R5bGUuZGlzcGxheSA9ICdncmlkJzsKICAgICAgZnJlZURpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAvLyBSZXNldHRhIGZyZWUgbG9vcAogICAgICBkLmZyZWVMb29wU3RhcnQgPSAwOwogICAgICBkLmZyZWVMb29wRW5kID0gMDsKICAgIH0gZWxzZSB7CiAgICAgIGJlYXREaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgZnJlZURpdi5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAvLyBEaXNhYmlsaXRhIGJlYXQgbG9vcAogICAgICBkLmxvb3BCZWF0cyA9IDA7CiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCNiZWF0LWxvb3AtJHtpfSAubG9vcC1idG5gKS5mb3JFYWNoKGIgPT4gYi5jbGFzc0xpc3QucmVtb3ZlKCdvbicpKTsKICAgIH0KICAgIAogICAgLy8gU2UgaW4gcmlwcm9kdXppb25lLCByaWF2dmlhIGNvbiBudW92ZSBpbXBvc3RhemlvbmkKICAgIGlmIChkLnBsYXlpbmcpIHdpbmRvdy5wbGF5RGVjayhpKTsKICB9OwoKICAvLyAtLS0gQmVhdCBMb29wIChiYXNhdG8gc3UgYmF0dHV0ZSkgLS0tCiAgd2luZG93LnNldEJlYXRMb29wID0gZnVuY3Rpb24oaSwgYmVhdHMpIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgaWYgKGQubG9vcE1vZGUgIT09ICdiZWF0JykgcmV0dXJuOwogICAgCiAgICBkLmxvb3BCZWF0cyA9IGJlYXRzOwogICAgCiAgICAvLyBDYWxjb2xhIGxvb3Agc3RhcnQgc3VsIGJlYXQgcGnDuSB2aWNpbm8KICAgIGlmIChkLmJwbSA+IDAgJiYgZC5idWYpIHsKICAgICAgY29uc3QgYmVhdFNlYyA9IDYwIC8gZC5icG07CiAgICAgIGNvbnN0IGN1cnJlbnRQb3MgPSBkLnBsYXlpbmcgPyAoKGN0eC5jdXJyZW50VGltZSAtIGQuc3QpICogZC5zcGVlZCkgJSBkLmJ1Zi5kdXJhdGlvbiA6IGQub2ZmOwogICAgICAKICAgICAgLy8gQXJyb3RvbmRhIGFsIGJlYXQgcGnDuSB2aWNpbm8gY29uc2lkZXJhbmRvIG9mZnNldAogICAgICBjb25zdCBvZmZTZWMgPSBkLmJlYXRPZmZNcyAvIDEwMDA7CiAgICAgIGNvbnN0IGJlYXRzRnJvbVN0YXJ0ID0gKGN1cnJlbnRQb3MgLSBvZmZTZWMpIC8gYmVhdFNlYzsKICAgICAgY29uc3Qgcm91bmRlZEJlYXRzID0gTWF0aC5yb3VuZChiZWF0c0Zyb21TdGFydCk7CiAgICAgIGQubG9vcFN0YXJ0ID0gb2ZmU2VjICsgKHJvdW5kZWRCZWF0cyAqIGJlYXRTZWMpOwogICAgICAKICAgICAgLy8gQXNzaWN1cmEgY2hlIHNpYSBkZW50cm8gaSBsaW1pdGkKICAgICAgaWYgKGQubG9vcFN0YXJ0IDwgMCkgZC5sb29wU3RhcnQgPSAwOwogICAgICBpZiAoZC5sb29wU3RhcnQgKyAoYmVhdFNlYyAqIGJlYXRzKSA+IGQuYnVmLmR1cmF0aW9uKSB7CiAgICAgICAgZC5sb29wU3RhcnQgPSBkLmJ1Zi5kdXJhdGlvbiAtIChiZWF0U2VjICogYmVhdHMpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBkLmxvb3BTdGFydCA9IGQub2ZmOwogICAgfQogICAgCiAgICAvLyBVSSBmZWVkYmFjawogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgI2JlYXQtbG9vcC0ke2l9IC5sb29wLWJ0bmApLmZvckVhY2goYiA9PiB7CiAgICAgIGIuY2xhc3NMaXN0LnRvZ2dsZSgnb24nLCBiLnRleHRDb250ZW50ID09IGJlYXRzKTsKICAgIH0pOwogICAgCiAgICBpZiAoZC5wbGF5aW5nKSB3aW5kb3cucGxheURlY2soaSk7CiAgICBzdGF0dXMoaSwgYEJlYXQgTG9vcDogJHtiZWF0c30gYmF0dHV0ZWApOwogIH07CgogIC8vIC0tLSBGcmVlIExvb3AgKG1hbnVhbGUpIC0tLQogIHdpbmRvdy5zZXRMb29wSW4gPSBmdW5jdGlvbihpKSB7CiAgICBjb25zdCBkID0gRFtpXTsKICAgIGlmIChkLmxvb3BNb2RlICE9PSAnZnJlZScgfHwgIWQuYnVmKSByZXR1cm47CiAgICAKICAgIGQuZnJlZUxvb3BTdGFydCA9IGQucGxheWluZyA/ICgoY3R4LmN1cnJlbnRUaW1lIC0gZC5zdCkgKiBkLnNwZWVkKSAlIGQuYnVmLmR1cmF0aW9uIDogZC5vZmY7CiAgICAKICAgICQoYGxvb3AtaW4tJHtpfWApLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgJChgbG9vcC1vdXQtJHtpfWApLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgCiAgICBzdGF0dXMoaSwgYExvb3AgSU4gaW1wb3N0YXRvIGEgJHtkLmZyZWVMb29wU3RhcnQudG9GaXhlZCgyKX1zYCk7CiAgfTsKCiAgd2luZG93LnNldExvb3BPdXQgPSBmdW5jdGlvbihpKSB7CiAgICBjb25zdCBkID0gRFtpXTsKICAgIGlmIChkLmxvb3BNb2RlICE9PSAnZnJlZScgfHwgIWQuYnVmKSByZXR1cm47CiAgICAKICAgIGQuZnJlZUxvb3BFbmQgPSBkLnBsYXlpbmcgPyAoKGN0eC5jdXJyZW50VGltZSAtIGQuc3QpICogZC5zcGVlZCkgJSBkLmJ1Zi5kdXJhdGlvbiA6IGQub2ZmOwogICAgCiAgICAvLyBBc3NpY3VyYSBjaGUgc3RhcnQgPCBlbmQKICAgIGlmIChkLmZyZWVMb29wRW5kIDw9IGQuZnJlZUxvb3BTdGFydCkgewogICAgICBkLmZyZWVMb29wRW5kID0gZC5mcmVlTG9vcFN0YXJ0ICsgMTsgLy8gRGVmYXVsdCAxIHNlY29uZG8KICAgIH0KICAgIAogICAgJChgbG9vcC1vdXQtJHtpfWApLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgCiAgICAvLyBBdHRpdmEgaWwgbG9vcAogICAgaWYgKGQucGxheWluZykgewogICAgICAvLyBSaWF2dmlhIGNvbiBpbCBsb29wIGxpYmVybwogICAgICBjb25zdCBzcmMgPSBkLnNyYzsKICAgICAgaWYgKHNyYykgewogICAgICAgIHNyYy5sb29wU3RhcnQgPSBkLmZyZWVMb29wU3RhcnQ7CiAgICAgICAgc3JjLmxvb3BFbmQgPSBkLmZyZWVMb29wRW5kOwogICAgICAgIHNyYy5sb29wID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgCiAgICBzdGF0dXMoaSwgYExvb3AgbGliZXJvOiAke2QuZnJlZUxvb3BTdGFydC50b0ZpeGVkKDIpfXMg4oaSICR7ZC5mcmVlTG9vcEVuZC50b0ZpeGVkKDIpfXNgKTsKICB9OwoKICB3aW5kb3cuY2xlYXJGcmVlTG9vcCA9IGZ1bmN0aW9uKGkpIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgZC5mcmVlTG9vcFN0YXJ0ID0gMDsKICAgIGQuZnJlZUxvb3BFbmQgPSAwOwogICAgCiAgICAkKGBsb29wLWluLSR7aX1gKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKICAgICQoYGxvb3Atb3V0LSR7aX1gKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKICAgIAogICAgaWYgKGQucGxheWluZykgewogICAgICAvLyBEaXNhYmlsaXRhIGxvb3AgbmVsIHNvdXJjZSBjb3JyZW50ZQogICAgICBpZiAoZC5zcmMpIHsKICAgICAgICBkLnNyYy5sb29wID0gZmFsc2U7CiAgICAgIH0KICAgICAgLy8gUmlhdnZpYSBzZW56YSBsb29wCiAgICAgIHdpbmRvdy5wbGF5RGVjayhpKTsKICAgIH0KICAgIAogICAgc3RhdHVzKGksICdMb29wIGxpYmVybyBjYW5jZWxsYXRvJyk7CiAgfTsKCiAgd2luZG93LmNsZWFyQWxsTG9vcCA9IGZ1bmN0aW9uKGkpIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgZC5sb29wQmVhdHMgPSAwOwogICAgZC5mcmVlTG9vcFN0YXJ0ID0gMDsKICAgIGQuZnJlZUxvb3BFbmQgPSAwOwogICAgCiAgICAvLyBVSSByZXNldAogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgI2JlYXQtbG9vcC0ke2l9IC5sb29wLWJ0bmApLmZvckVhY2goYiA9PiBiLmNsYXNzTGlzdC5yZW1vdmUoJ29uJykpOwogICAgJChgbG9vcC1pbi0ke2l9YCk/LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgJChgbG9vcC1vdXQtJHtpfWApPy5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKICAgIAogICAgaWYgKGQucGxheWluZykgd2luZG93LnBsYXlEZWNrKGkpOwogICAgc3RhdHVzKGksICdMb29wIE9GRicpOwogIH07CgogIC8vIC0tLSBQbGF5IChSSVNDUklUVE8gY29uIGNvcnJldHRvIGtleSBsb2NrKSAtLS0KICB3aW5kb3cucGxheURlY2sgPSBmdW5jdGlvbihpKSB7CiAgICBjb25zdCBkID0gRFtpXTsKICAgIGlmICghZC5idWYpIHsgYWxlcnQoJ0NhcmljYSB1biBmaWxlIGF1ZGlvJyk7IHJldHVybjsgfQogICAgcmVzdW1lQ3R4KCk7CiAgICAKICAgIC8vIEZlcm1hIHNvcmdlbnRlIHByZWNlZGVudGUKICAgIGlmIChkLnNyYykgeyAKICAgICAgdHJ5IHsgZC5zcmMuc3RvcCgpOyB9IGNhdGNoKGUpIHt9IAogICAgICBkLnNyYyA9IG51bGw7IAogICAgfQogICAgCiAgICBjb25zdCBzcmMgPSBjdHguY3JlYXRlQnVmZmVyU291cmNlKCk7CiAgICBzcmMuYnVmZmVyID0gZC5idWY7CiAgICAKICAgIC8vIENhbGNvbGEgaWwgcmF0ZTogCiAgICAvLyAtIFNlIGxvY2tLZXkgPSB0cnVlOiBwaXRjaCBmYWN0b3IgPSAxIChwaXRjaCBvcmlnaW5hbGUpCiAgICAvLyAtIFNlIGxvY2tLZXkgPSBmYWxzZTogcGl0Y2ggZmFjdG9yID0gMl4oa2V5U2hpZnQvMTIpCiAgICBjb25zdCBwaXRjaEZhY3RvciA9IGQubG9ja0tleSA/IDEgOiBNYXRoLnBvdygyLCBkLmtleVNoaWZ0IC8gMTIpOwogICAgY29uc3QgcGxheWJhY2tSYXRlID0gZC5zcGVlZCAqIHBpdGNoRmFjdG9yOwogICAgCiAgICBzcmMucGxheWJhY2tSYXRlLnZhbHVlID0gcGxheWJhY2tSYXRlOwogICAgY29uc29sZS5sb2coYHBsYXlEZWNrICR7aX06IHNwZWVkPSR7ZC5zcGVlZH0sIHBpdGNoRmFjdG9yPSR7cGl0Y2hGYWN0b3J9LCByYXRlPSR7cGxheWJhY2tSYXRlfSwgbG9ja0tleT0ke2QubG9ja0tleX1gKTsKICAgIAogICAgc3JjLmNvbm5lY3QoZC5nYWluTm9kZSk7CgogICAgbGV0IG9mZnNldCA9IE1hdGgubWF4KDAsIGQub2ZmICUgZC5idWYuZHVyYXRpb24pOwogICAgCiAgICAvLyBDb25maWd1cmEgbG9vcCBpbiBiYXNlIGFsbGEgbW9kYWxpdMOgCiAgICBpZiAoZC5sb29wTW9kZSA9PT0gJ2JlYXQnICYmIGQubG9vcEJlYXRzID4gMCAmJiBkLmJwbSA+IDApIHsKICAgICAgY29uc3QgYmVhdFNlYyA9IDYwIC8gZC5icG07CiAgICAgIGNvbnN0IGxvb3BMZW4gPSBiZWF0U2VjICogZC5sb29wQmVhdHM7CiAgICAgIGNvbnN0IGxzID0gZC5sb29wU3RhcnQ7CiAgICAgIGNvbnN0IGxlID0gbHMgKyBsb29wTGVuOwogICAgICBpZiAobGUgPD0gZC5idWYuZHVyYXRpb24pIHsKICAgICAgICBzcmMubG9vcFN0YXJ0ID0gbHM7IAogICAgICAgIHNyYy5sb29wRW5kID0gbGU7IAogICAgICAgIHNyYy5sb29wID0gdHJ1ZTsKICAgICAgICBvZmZzZXQgPSBscyArICgob2Zmc2V0IC0gbHMgKyBsb29wTGVuKSAlIGxvb3BMZW4pOwogICAgICB9IGVsc2UgewogICAgICAgIHNyYy5sb29wID0gdHJ1ZTsKICAgICAgfQogICAgfSAKICAgIGVsc2UgaWYgKGQubG9vcE1vZGUgPT09ICdmcmVlJyAmJiBkLmZyZWVMb29wRW5kID4gZC5mcmVlTG9vcFN0YXJ0KSB7CiAgICAgIHNyYy5sb29wU3RhcnQgPSBkLmZyZWVMb29wU3RhcnQ7CiAgICAgIHNyYy5sb29wRW5kID0gZC5mcmVlTG9vcEVuZDsKICAgICAgc3JjLmxvb3AgPSB0cnVlOwogICAgICBvZmZzZXQgPSBkLmZyZWVMb29wU3RhcnQgKyAoKG9mZnNldCAtIGQuZnJlZUxvb3BTdGFydCArIChkLmZyZWVMb29wRW5kIC0gZC5mcmVlTG9vcFN0YXJ0KSkgJSAoZC5mcmVlTG9vcEVuZCAtIGQuZnJlZUxvb3BTdGFydCkpOwogICAgfQogICAgZWxzZSB7CiAgICAgIHNyYy5sb29wID0gdHJ1ZTsgLy8gTG9vcCBzdWxsJ2ludGVyYSB0cmFjY2lhCiAgICB9CgogICAgc3JjLnN0YXJ0KDAsIG9mZnNldCk7CiAgICBkLnNyYyA9IHNyYzsKICAgIGQuc3QgPSBjdHguY3VycmVudFRpbWUgLSBvZmZzZXQgLyBkLnNwZWVkOwogICAgZC5wbGF5aW5nID0gdHJ1ZTsKICAgICQoYGRrLSR7aX1gKS5jbGFzc0xpc3QuYWRkKCdwbGF5aW5nJyk7CiAgICAKICAgIHNyYy5vbmVuZGVkID0gKCkgPT4gewogICAgICBpZiAoZC5zcmMgPT09IHNyYykgewogICAgICAgIGQucGxheWluZyA9IGZhbHNlOwogICAgICAgIGQuc3JjID0gbnVsbDsKICAgICAgICAkKGBkay0ke2l9YCkuY2xhc3NMaXN0LnJlbW92ZSgncGxheWluZycpOwogICAgICB9CiAgICB9OwogICAgCiAgICBpZiAoZC5sb2NrS2V5KSB7CiAgICAgIHN0YXR1cyhpLCBg4pa2IFJpcHJvZHV6aW9uZSBjb24gS0VZIExPQ0sgLSBwaXRjaCBmaXNzbyBhICR7ZC5rZXkgfHwgJy0tJ31gKTsKICAgIH0KICB9OwoKICB3aW5kb3cuc3RvcERlY2sgPSBmdW5jdGlvbihpKSB7CiAgICBjb25zdCBkID0gRFtpXTsKICAgIGlmIChkLnBsYXlpbmcgJiYgZC5idWYpIHsKICAgICAgY29uc3QgZWxhcHNlZCA9IChjdHguY3VycmVudFRpbWUgLSBkLnN0KSAqIGQuc3BlZWQ7CiAgICAgIGQub2ZmID0gZWxhcHNlZCAlIGQuYnVmLmR1cmF0aW9uOwogICAgfQogICAgaWYgKGQuc3JjKSB7IHRyeSB7IGQuc3JjLnN0b3AoKTsgfSBjYXRjaChlKSB7fSBkLnNyYyA9IG51bGw7IH0KICAgIGQucGxheWluZyA9IGZhbHNlOwogICAgJChgZGstJHtpfWApLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXlpbmcnKTsKICB9OwoKICB3aW5kb3cuc2Vla0NsaWNrID0gZnVuY3Rpb24oaSwgZSkgewogICAgY29uc3QgZCA9IERbaV07CiAgICBpZiAoIWQuYnVmKSByZXR1cm47CiAgICBjb25zdCByZWN0ID0gZS5jdXJyZW50VGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgY29uc3QgY2xpY2tYID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0OwogICAgY29uc3QgcmF0aW8gPSBjbGlja1ggLyByZWN0LndpZHRoOwogICAgCiAgICBjb25zdCB6b29tID0gZC56b29tIHx8IDE7CiAgICBjb25zdCB6b29tUG9zID0gZC56b29tUG9zICE9PSB1bmRlZmluZWQgPyBkLnpvb21Qb3MgOiAwLjU7CiAgICAKICAgIGNvbnN0IHZpZXdTaXplID0gMS4wIC8gem9vbTsKICAgIGxldCB2aWV3U3RhcnQgPSB6b29tUG9zIC0gdmlld1NpemUgLyAyOwogICAgCiAgICBpZiAodmlld1N0YXJ0IDwgMCkgdmlld1N0YXJ0ID0gMDsKICAgIGlmICh2aWV3U3RhcnQgKyB2aWV3U2l6ZSA+IDEpIHZpZXdTdGFydCA9IDEgLSB2aWV3U2l6ZTsKICAgIAogICAgY29uc3Qgbm9ybVBvcyA9IHZpZXdTdGFydCArIHJhdGlvICogdmlld1NpemU7CiAgICBkLm9mZiA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIG5vcm1Qb3MpKSAqIGQuYnVmLmR1cmF0aW9uOwogICAgCiAgICBpZiAoZC5wbGF5aW5nKSB3aW5kb3cucGxheURlY2soaSk7CiAgfTsKCiAgLy8gLS0tIExvYWQgdHJhY2sgKGFnZ2lvcm5hdG8pIC0tLQogIHdpbmRvdy5sb2FkVHJhY2sgPSBhc3luYyBmdW5jdGlvbihpLCBlbCkgewogICAgY29uc3QgZmlsZSA9IGVsLmZpbGVzWzBdOwogICAgaWYgKCFmaWxlKSByZXR1cm47CiAgICByZXN1bWVDdHgoKTsKICAgICQoYHRuLSR7aX1gKS50ZXh0Q29udGVudCA9IGZpbGUubmFtZTsKICAgICQoYGJiLSR7aX1gKS50ZXh0Q29udGVudCA9ICcuLi4nOwogICAgJChga2JveC0ke2l9YCkudGV4dENvbnRlbnQgPSAnLi4uJzsKICAgIHN0YXR1cyhpLCAnQ2FyaWNhbWVudG8uLi4nKTsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgaWYgKGQucGxheWluZykgd2luZG93LnN0b3BEZWNrKGkpOwogICAgY29uc3QgYWIgPSBhd2FpdCBmaWxlLmFycmF5QnVmZmVyKCk7CiAgICBjdHguZGVjb2RlQXVkaW9EYXRhKGFiLCAoYnVmKSA9PiB7CiAgICAgIGQuYnVmID0gYnVmOwogICAgICBkLm9mZiA9IDA7CiAgICAgIGQuc3BlZWQgPSAxLjA7CiAgICAgIGQuYmVhdE9mZk1zID0gMDsKICAgICAgZC5sb29wQmVhdHMgPSAwOwogICAgICBkLmtleVNoaWZ0ID0gMDsKICAgICAgZC5sb2NrS2V5ID0gZmFsc2U7CiAgICAgIGQuem9vbSA9IDEuMDsKICAgICAgZC56b29tUG9zID0gMC41OwogICAgICBkLmxvb3BNb2RlID0gJ2JlYXQnOwogICAgICBkLmZyZWVMb29wU3RhcnQgPSAwOwogICAgICBkLmZyZWVMb29wRW5kID0gMDsKICAgICAgCiAgICAgICQoYGxrLSR7aX1gKS5jbGFzc0xpc3QucmVtb3ZlKCdsb2NrZWQnKTsKICAgICAgJChgbGstJHtpfWApLnRleHRDb250ZW50ID0gJ0tFWSBMT0NLIE9GRic7CiAgICAgICQoYHJzLSR7aX1gKS52YWx1ZSA9IDE7CiAgICAgICQoYHJ2LSR7aX1gKS50ZXh0Q29udGVudCA9ICcxLjAwMCc7CiAgICAgICQoYGJvZmYtJHtpfWApLnZhbHVlID0gMDsKICAgICAgJChgYm0tJHtpfWApLnZhbHVlID0gJyc7CiAgICAgICQoYGtzLSR7aX1gKS52YWx1ZSA9IDA7CiAgICAgICQoYHpvb20tJHtpfWApLnZhbHVlID0gMTsKICAgICAgJChgem9vbS12YWwtJHtpfWApLnRleHRDb250ZW50ID0gJzEuMHgnOwogICAgICAkKGB6b29tLXBvcy0ke2l9YCkudmFsdWUgPSAwLjU7CiAgICAgICQoYHpvb20tcG9zLXZhbC0ke2l9YCkudGV4dENvbnRlbnQgPSAnNTAlJzsKICAgICAgJChgbG9vcC1tb2RlLSR7aX1gKS50ZXh0Q29udGVudCA9ICdNT0RFOiBCRUFUJzsKICAgICAgCiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCNiZWF0LWxvb3AtJHtpfSAubG9vcC1idG5gKS5mb3JFYWNoKGIgPT4gYi5jbGFzc0xpc3QucmVtb3ZlKCdvbicpKTsKICAgICAgJChgYmVhdC1sb29wLSR7aX1gKS5zdHlsZS5kaXNwbGF5ID0gJ2dyaWQnOwogICAgICAkKGBmcmVlLWxvb3AtJHtpfWApLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIAogICAgICAkKGBkay0ke2l9YCkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgIAogICAgICBkLnBlYWtzID0gYnVpbGRQZWFrcyhidWYsIDEwMDApOwogICAgICBkcmF3V0YoaSk7CiAgICAgIAogICAgICBzdGF0dXMoaSwgJ0FuYWxpc2kgQlBNLi4uJyk7CiAgICAgIGNvbnN0IGJwbSA9IGRldGVjdEJQTShidWYpOwogICAgICBkLmJwbSA9IGJwbTsgZC5icG1OYXRpdmUgPSBicG07CiAgICAgICQoYGJiLSR7aX1gKS50ZXh0Q29udGVudCA9IGJwbS50b0ZpeGVkKDEpOwogICAgICBkcmF3QkcoaSk7CiAgICAgIAogICAgICBzdGF0dXMoaSwgJ0FuYWxpc2kgdG9uYWxpdMOgLi4uJyk7CiAgICAgIGRldGVjdEtleShidWYsIChrZXkpID0+IHsKICAgICAgICBkLmtleSA9IGtleTsKICAgICAgICAkKGBrZGV0LSR7aX1gKS50ZXh0Q29udGVudCA9IGtleSB8fCAnLS0nOwogICAgICAgICQoYGtib3gtJHtpfWApLnRleHRDb250ZW50ID0ga2V5IHx8ICctLSc7CiAgICAgICAgc3RhdHVzKGksICdQcm9udG8nKTsKICAgICAgfSk7CiAgICB9LCAoZXJyKSA9PiB7CiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgc3RhdHVzKGksICdFcnJvcmUgY2FyaWNhbWVudG8nKTsKICAgIH0pOwogIH07CgogIHdpbmRvdy5zZXRNYW51YWxCUE0gPSBmdW5jdGlvbihpLCB2KSB7CiAgICBjb25zdCBiID0gK3Y7CiAgICBpZiAoaXNOYU4oYikgfHwgYiA8IDIwKSByZXR1cm47CiAgICBEW2ldLmJwbSA9IGI7CiAgICBEW2ldLmJwbU5hdGl2ZSA9IGI7CiAgICAkKGBiYi0ke2l9YCkudGV4dENvbnRlbnQgPSBiLnRvRml4ZWQoMSk7CiAgICBkcmF3QkcoaSk7CiAgfTsKCiAgd2luZG93LnJlc2V0QlBNID0gZnVuY3Rpb24oaSkgewogICAgaWYgKCFEW2ldLmJ1ZikgcmV0dXJuOwogICAgY29uc3QgYnBtID0gZGV0ZWN0QlBNKERbaV0uYnVmKTsKICAgIERbaV0uYnBtID0gYnBtOwogICAgRFtpXS5icG1OYXRpdmUgPSBicG07CiAgICAkKGBiYi0ke2l9YCkudGV4dENvbnRlbnQgPSBicG0udG9GaXhlZCgxKTsKICAgICQoYGJtLSR7aX1gKS52YWx1ZSA9ICcnOwogICAgZHJhd0JHKGkpOwogIH07CgogIHdpbmRvdy5zZXRPZmZzZXQgPSBmdW5jdGlvbihpLCB2KSB7CiAgICBEW2ldLmJlYXRPZmZNcyA9ICt2IHx8IDA7CiAgICBkcmF3QkcoaSk7CiAgfTsKCiAgd2luZG93Lm51ZGdlID0gZnVuY3Rpb24oaSwgZGVsdGEpIHsKICAgIERbaV0uYmVhdE9mZk1zICs9IGRlbHRhOwogICAgJChgYm9mZi0ke2l9YCkudmFsdWUgPSBEW2ldLmJlYXRPZmZNczsKICAgIGRyYXdCRyhpKTsKICB9OwoKICAvLyAtLS0gWm9vbSBmdW56aW9uaSAtLS0KICB3aW5kb3cuc2V0Wm9vbSA9IGZ1bmN0aW9uKGksIHopIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgZC56b29tID0gTWF0aC5tYXgoMSwgTWF0aC5taW4oMTAsICt6KSk7CiAgICAkKGB6b29tLSR7aX1gKS52YWx1ZSA9IGQuem9vbTsKICAgICQoYHpvb20tdmFsLSR7aX1gKS50ZXh0Q29udGVudCA9IGQuem9vbS50b0ZpeGVkKDEpICsgJ3gnOwogICAgCiAgICBjb25zdCBidG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgI2RrLSR7aX0gLnpvb20tYnRuYCk7CiAgICBidG5zLmZvckVhY2goYnRuID0+IHsKICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgICBjb25zdCBidG5WYWwgPSBwYXJzZUZsb2F0KGJ0bi50ZXh0Q29udGVudC5yZXBsYWNlKCd4JywgJycpKTsKICAgICAgaWYgKE1hdGguYWJzKGJ0blZhbCAtIGQuem9vbSkgPCAwLjEpIHsKICAgICAgICBidG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgIH0KICAgIH0pOwogICAgCiAgICBkcmF3V0YoaSk7CiAgICBkcmF3QkcoaSk7CiAgfTsKCiAgd2luZG93LnNldFpvb21Qb3MgPSBmdW5jdGlvbihpLCBwb3MpIHsKICAgIGNvbnN0IGQgPSBEW2ldOwogICAgZC56b29tUG9zID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgK3BvcykpOwogICAgJChgem9vbS1wb3MtJHtpfWApLnZhbHVlID0gZC56b29tUG9zOwogICAgJChgem9vbS1wb3MtdmFsLSR7aX1gKS50ZXh0Q29udGVudCA9IE1hdGgucm91bmQoZC56b29tUG9zICogMTAwKSArICclJzsKICAgIAogICAgZHJhd1dGKGkpOwogICAgZHJhd0JHKGkpOwogIH07CgogIC8vIC0tLSBXYXZlZm9ybSBmdW5jdGlvbnMgLS0tCiAgZnVuY3Rpb24gYnVpbGRQZWFrcyhidWYsIG4pIHsKICAgIGNvbnN0IGRhdGEgPSBidWYuZ2V0Q2hhbm5lbERhdGEoMCk7CiAgICBjb25zdCBibG9ja1NpemUgPSBNYXRoLmZsb29yKGRhdGEubGVuZ3RoIC8gbik7CiAgICBjb25zdCBwZWFrcyA9IG5ldyBGbG9hdDMyQXJyYXkobik7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgewogICAgICBsZXQgbWF4ID0gMDsKICAgICAgY29uc3Qgc3RhcnQgPSBpICogYmxvY2tTaXplOwogICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJsb2NrU2l6ZTsgaisrKSB7CiAgICAgICAgY29uc3QgdmFsID0gTWF0aC5hYnMoZGF0YVtzdGFydCArIGpdIHx8IDApOwogICAgICAgIGlmICh2YWwgPiBtYXgpIG1heCA9IHZhbDsKICAgICAgfQogICAgICBwZWFrc1tpXSA9IG1heDsKICAgIH0KICAgIHJldHVybiBwZWFrczsKICB9CgogIGZ1bmN0aW9uIGRyYXdXRihpKSB7CiAgICBjb25zdCBkID0gRFtpXTsKICAgIGlmICghZC5wZWFrcykgcmV0dXJuOwogICAgY29uc3Qgd3cgPSAkKGB3dy0ke2l9YCk7CiAgICBjb25zdCBjdiA9ICQoYHdjLSR7aX1gKTsKICAgIGlmICghd3cgfHwgIWN2KSByZXR1cm47CiAgICBjdi53aWR0aCA9IHd3LmNsaWVudFdpZHRoIHx8IDMyMDsKICAgIGN2LmhlaWdodCA9IHd3LmNsaWVudEhlaWdodCB8fCA4MDsKICAgIGNvbnN0IFcgPSBjdi53aWR0aCwgSCA9IGN2LmhlaWdodDsKICAgIGNvbnN0IGMgPSBjdi5nZXRDb250ZXh0KCcyZCcpOwogICAgYy5jbGVhclJlY3QoMCwgMCwgVywgSCk7CiAgICAKICAgIGNvbnN0IGdyYWQgPSBjLmNyZWF0ZUxpbmVhckdyYWRpZW50KDAsIDAsIDAsIEgpOwogICAgZ3JhZC5hZGRDb2xvclN0b3AoMCwgJyMxMDJhMjQnKTsKICAgIGdyYWQuYWRkQ29sb3JTdG9wKDEsICcjMDMxMDBkJyk7CiAgICBjLmZpbGxTdHlsZSA9IGdyYWQ7CiAgICBjLmZpbGxSZWN0KDAsIDAsIFcsIEgpOwoKICAgIGNvbnN0IHpvb20gPSBkLnpvb20gfHwgMTsKICAgIGNvbnN0IHpvb21Qb3MgPSBkLnpvb21Qb3MgIT09IHVuZGVmaW5lZCA/IGQuem9vbVBvcyA6IDAuNTsKICAgIGNvbnN0IHRvdGFsUGVha3MgPSBkLnBlYWtzLmxlbmd0aDsKICAgIAogICAgY29uc3Qgdmlld1NpemUgPSAxLjAgLyB6b29tOwogICAgbGV0IHZpZXdTdGFydCA9IHpvb21Qb3MgLSB2aWV3U2l6ZSAvIDI7CiAgICBsZXQgdmlld0VuZCA9IHpvb21Qb3MgKyB2aWV3U2l6ZSAvIDI7CiAgICAKICAgIGlmICh2aWV3U3RhcnQgPCAwKSB7CiAgICAgIHZpZXdTdGFydCA9IDA7CiAgICAgIHZpZXdFbmQgPSB2aWV3U2l6ZTsKICAgIH0KICAgIGlmICh2aWV3RW5kID4gMSkgewogICAgICB2aWV3RW5kID0gMTsKICAgICAgdmlld1N0YXJ0ID0gMSAtIHZpZXdTaXplOwogICAgfQoKICAgIGMuZmlsbFN0eWxlID0gJyMyZWYwZDAnOwogICAgY29uc3QgbWlkID0gSCAvIDI7CiAgICAKICAgIGZvciAobGV0IHggPSAwOyB4IDwgVzsgeCsrKSB7CiAgICAgIGNvbnN0IG5vcm1YID0geCAvIFc7CiAgICAgIGNvbnN0IHQgPSB2aWV3U3RhcnQgKyBub3JtWCAqICh2aWV3RW5kIC0gdmlld1N0YXJ0KTsKICAgICAgY29uc3QgcGVha0lkeCA9IE1hdGguZmxvb3IodCAqIHRvdGFsUGVha3MpOwogICAgICBpZiAocGVha0lkeCA+PSAwICYmIHBlYWtJZHggPCB0b3RhbFBlYWtzKSB7CiAgICAgICAgY29uc3QgYW1wID0gZC5wZWFrc1twZWFrSWR4XSAqIG1pZCAqIDAuOTsKICAgICAgICBjLmZpbGxSZWN0KHgsIG1pZCAtIGFtcCwgMSwgYW1wICogMik7CiAgICAgIH0KICAgIH0KICAgIAogICAgYy5zdHJva2VTdHlsZSA9ICcjNDU3MDY2JzsKICAgIGMuYmVnaW5QYXRoKCk7IAogICAgYy5tb3ZlVG8oMCwgbWlkKTsgCiAgICBjLmxpbmVUbyhXLCBtaWQpOyAKICAgIGMuc3Ryb2tlKCk7CiAgfQoKICBmdW5jdGlvbiBkcmF3QkcoaSkgewogICAgY29uc3QgZCA9IERbaV07CiAgICBjb25zdCB3dyA9ICQoYHd3LSR7aX1gKTsKICAgIGNvbnN0IGN2ID0gJChgZ2MtJHtpfWApOwogICAgaWYgKCF3dyB8fCAhY3YpIHJldHVybjsKICAgIGN2LndpZHRoID0gd3cuY2xpZW50V2lkdGggfHwgMzIwOwogICAgY3YuaGVpZ2h0ID0gd3cuY2xpZW50SGVpZ2h0IHx8IDgwOwogICAgY29uc3QgVyA9IGN2LndpZHRoLCBIID0gY3YuaGVpZ2h0OwogICAgY29uc3QgYyA9IGN2LmdldENvbnRleHQoJzJkJyk7CiAgICBjLmNsZWFyUmVjdCgwLCAwLCBXLCBIKTsKICAgIAogICAgaWYgKCFkLmJ1ZiB8fCAhZC5icG0pIHJldHVybjsKICAgIAogICAgY29uc3QgZHVyID0gZC5idWYuZHVyYXRpb247CiAgICBjb25zdCBiZWF0U2VjID0gNjAgLyBkLmJwbTsKICAgIGNvbnN0IG9mZlNlYyA9IGQuYmVhdE9mZk1zIC8gMTAwMDsKICAgIGNvbnN0IHpvb20gPSBkLnpvb20gfHwgMTsKICAgIGNvbnN0IHpvb21Qb3MgPSBkLnpvb21Qb3MgIT09IHVuZGVmaW5lZCA/IGQuem9vbVBvcyA6IDAuNTsKICAgIAogICAgY29uc3Qgdmlld1NpemUgPSAxLjAgLyB6b29tOwogICAgbGV0IHZpZXdTdGFydCA9IHpvb21Qb3MgLSB2aWV3U2l6ZSAvIDI7CiAgICBsZXQgdmlld0VuZCA9IHpvb21Qb3MgKyB2aWV3U2l6ZSAvIDI7CiAgICAKICAgIGlmICh2aWV3U3RhcnQgPCAwKSB7CiAgICAgIHZpZXdTdGFydCA9IDA7CiAgICAgIHZpZXdFbmQgPSB2aWV3U2l6ZTsKICAgIH0KICAgIGlmICh2aWV3RW5kID4gMSkgewogICAgICB2aWV3RW5kID0gMTsKICAgICAgdmlld1N0YXJ0ID0gMSAtIHZpZXdTaXplOwogICAgfQoKICAgIGNvbnN0IHRTdGFydCA9IHZpZXdTdGFydCAqIGR1cjsKICAgIGNvbnN0IHRFbmQgPSB2aWV3RW5kICogZHVyOwogICAgCiAgICBsZXQgdCA9IG9mZlNlYyAlIGJlYXRTZWM7CiAgICB3aGlsZSAodCA8IHRTdGFydCAtIGJlYXRTZWMpIHQgKz0gYmVhdFNlYzsKICAgIAogICAgbGV0IGJlYXROdW0gPSBNYXRoLmZsb29yKCh0IC0gb2ZmU2VjKSAvIGJlYXRTZWMpOwogICAgCiAgICB3aGlsZSAodCA8PSB0RW5kICsgYmVhdFNlYykgewogICAgICBpZiAodCA+PSB0U3RhcnQgLSBiZWF0U2VjICogMC41ICYmIHQgPD0gdEVuZCArIGJlYXRTZWMgKiAwLjUpIHsKICAgICAgICBjb25zdCB4ID0gKCh0IC0gdFN0YXJ0KSAvICh0RW5kIC0gdFN0YXJ0KSkgKiBXOwogICAgICAgIGlmICh4ID49IC01ICYmIHggPD0gVyArIDUpIHsKICAgICAgICAgIGNvbnN0IGlzRG93biA9IChiZWF0TnVtICUgNCA9PT0gMCk7CiAgICAgICAgICBjLmJlZ2luUGF0aCgpOwogICAgICAgICAgYy5zdHJva2VTdHlsZSA9IGlzRG93biA/ICdyZ2JhKDI1NSwgMTAwLCAxMDAsIDAuOSknIDogJ3JnYmEoNDYsIDI0MCwgMjA4LCAwLjUpJzsKICAgICAgICAgIGMubGluZVdpZHRoID0gaXNEb3duID8gMi41IDogMS4yOwogICAgICAgICAgYy5tb3ZlVG8oeCwgaXNEb3duID8gMCA6IEggKiAwLjIpOwogICAgICAgICAgYy5saW5lVG8oeCwgSCk7CiAgICAgICAgICBjLnN0cm9rZSgpOwogICAgICAgICAgCiAgICAgICAgICBpZiAoaXNEb3duKSB7CiAgICAgICAgICAgIGMuZmlsbFN0eWxlID0gJyNmZmIwYjAnOwogICAgICAgICAgICBjLmZvbnQgPSAnYm9sZCA4cHggbW9ub3NwYWNlJzsKICAgICAgICAgICAgYy5maWxsVGV4dChNYXRoLmZsb29yKGJlYXROdW0gLyA0KSArIDEsIHggKyAzLCAxNCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHQgKz0gYmVhdFNlYzsKICAgICAgYmVhdE51bSsrOwogICAgICBpZiAoYmVhdE51bSA+IDIwMDApIGJyZWFrOwogICAgfQogIH0KCiAgZnVuY3Rpb24gdXBkYXRlUGxheWhlYWRQb3MoaSwgcG9zKSB7CiAgICBjb25zdCBkID0gRFtpXTsKICAgIGlmICghZC5idWYpIHJldHVybjsKICAgIAogICAgY29uc3Qgem9vbSA9IGQuem9vbSB8fCAxOwogICAgY29uc3Qgem9vbVBvcyA9IGQuem9vbVBvcyAhPT0gdW5kZWZpbmVkID8gZC56b29tUG9zIDogMC41OwogICAgCiAgICBjb25zdCB2aWV3U2l6ZSA9IDEuMCAvIHpvb207CiAgICBsZXQgdmlld1N0YXJ0ID0gem9vbVBvcyAtIHZpZXdTaXplIC8gMjsKICAgIGxldCB2aWV3RW5kID0gem9vbVBvcyArIHZpZXdTaXplIC8gMjsKICAgIAogICAgaWYgKHZpZXdTdGFydCA8IDApIHsKICAgICAgdmlld1N0YXJ0ID0gMDsKICAgICAgdmlld0VuZCA9IHZpZXdTaXplOwogICAgfQogICAgaWYgKHZpZXdFbmQgPiAxKSB7CiAgICAgIHZpZXdFbmQgPSAxOwogICAgICB2aWV3U3RhcnQgPSAxIC0gdmlld1NpemU7CiAgICB9CiAgICAKICAgIGNvbnN0IG5vcm1Qb3MgPSBwb3MgLyBkLmJ1Zi5kdXJhdGlvbjsKICAgIAogICAgaWYgKG5vcm1Qb3MgPj0gdmlld1N0YXJ0ICYmIG5vcm1Qb3MgPD0gdmlld0VuZCkgewogICAgICBjb25zdCByZWxhdGl2ZVBvcyA9IChub3JtUG9zIC0gdmlld1N0YXJ0KSAvICh2aWV3RW5kIC0gdmlld1N0YXJ0KTsKICAgICAgJChgcGgtJHtpfWApLnN0eWxlLmxlZnQgPSAocmVsYXRpdmVQb3MgKiAxMDApICsgJyUnOwogICAgICAkKGBwaC0ke2l9YCkuc3R5bGUub3BhY2l0eSA9ICcxJzsKICAgIH0gZWxzZSB7CiAgICAgICQoYHBoLSR7aX1gKS5zdHlsZS5vcGFjaXR5ID0gJzAuMyc7CiAgICAgIGlmIChub3JtUG9zIDwgdmlld1N0YXJ0KSB7CiAgICAgICAgJChgcGgtJHtpfWApLnN0eWxlLmxlZnQgPSAnMCUnOwogICAgICB9IGVsc2UgewogICAgICAgICQoYHBoLSR7aX1gKS5zdHlsZS5sZWZ0ID0gJzEwMCUnOwogICAgICB9CiAgICB9CiAgfQoKICAvLyAtLS0gQlBNIGRldGVjdGlvbiAtLS0KICBmdW5jdGlvbiBkZXRlY3RCUE0oYnVmKSB7CiAgICBjb25zdCBzciA9IGJ1Zi5zYW1wbGVSYXRlOwogICAgY29uc3QgZGF0YSA9IGJ1Zi5nZXRDaGFubmVsRGF0YSgwKTsKICAgIGNvbnN0IG1heFMgPSBNYXRoLm1pbihkYXRhLmxlbmd0aCwgc3IgKiA0MCk7CiAgICBjb25zdCBkcyA9IE1hdGguZmxvb3Ioc3IgLyAzMDAwKTsKICAgIGNvbnN0IGRvd24gPSBuZXcgRmxvYXQzMkFycmF5KE1hdGguY2VpbChtYXhTIC8gZHMpKTsKICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IG1heFM7IGkgKz0gZHMsIGorKykgZG93bltqXSA9IGRhdGFbaV07CiAgICBjb25zdCBkc3IgPSBzciAvIGRzOwogICAgY29uc3Qgd3N6ID0gTWF0aC5mbG9vcihkc3IgKiAwLjAyNSk7CiAgICBjb25zdCBFID0gW107CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRvd24ubGVuZ3RoOyBpICs9IHdzeikgewogICAgICBsZXQgcyA9IDA7CiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgd3N6ICYmIGkgKyBqIDwgZG93bi5sZW5ndGg7IGorKykgcyArPSBkb3duW2kgKyBqXSAqIGRvd25baSArIGpdOwogICAgICBFLnB1c2goTWF0aC5zcXJ0KHMgLyB3c3opKTsKICAgIH0KICAgIGNvbnN0IG9uc2V0ID0gbmV3IEZsb2F0MzJBcnJheShFLmxlbmd0aCAtIDEpOwogICAgZm9yIChsZXQgaSA9IDE7IGkgPCBFLmxlbmd0aDsgaSsrKSB7IAogICAgICBjb25zdCBkID0gRVtpXSAtIEVbaSAtIDFdOyAKICAgICAgb25zZXRbaSAtIDFdID0gZCA+IDAgPyBkIDogMDsgCiAgICB9CiAgICBjb25zdCBlZnIgPSBkc3IgLyB3c3o7CiAgICBjb25zdCBtaW5QID0gTWF0aC5mbG9vcihlZnIgKiA2MCAvIDIwMCk7CiAgICBjb25zdCBtYXhQID0gTWF0aC5mbG9vcihlZnIgKiA2MCAvIDYwKTsKICAgIGxldCBiZXN0UCA9IG1pblAsIGJlc3RTID0gLTE7CiAgICBmb3IgKGxldCBwID0gbWluUDsgcCA8PSBtYXhQOyBwKyspIHsKICAgICAgbGV0IHMgPSAwOwogICAgICBmb3IgKGxldCBpID0gMDsgaSArIHAgPCBvbnNldC5sZW5ndGg7IGkrKykgcyArPSBvbnNldFtpXSAqIG9uc2V0W2kgKyBwXTsKICAgICAgaWYgKHMgPiBiZXN0UykgeyBiZXN0UyA9IHM7IGJlc3RQID0gcDsgfQogICAgfQogICAgbGV0IGJwbSA9IChlZnIgLyBiZXN0UCkgKiA2MDsKICAgIHdoaWxlIChicG0gPCA4MCkgYnBtICo9IDI7CiAgICB3aGlsZSAoYnBtID4gMTgwKSBicG0gLz0gMjsKICAgIGlmIChicG0gPCA0MCB8fCBicG0gPiAyNDApIGJwbSA9IDEyMDsKICAgIHJldHVybiBNYXRoLnJvdW5kKGJwbSAqIDEwKSAvIDEwOwogIH0KCiAgLy8gLS0tIEtleSBkZXRlY3Rpb24gLS0tCiAgY29uc3QgS1NfTUFKID0gWzYuMzUsIDIuMjMsIDMuNDgsIDIuMzMsIDQuMzgsIDQuMDksIDIuNTIsIDUuMTksIDIuMzksIDMuNjYsIDIuMjksIDIuODhdOwogIGNvbnN0IEtTX01JTiA9IFs2LjMzLCAyLjY4LCAzLjUyLCA1LjM4LCAyLjYwLCAzLjUzLCAyLjU0LCA0Ljc1LCAzLjk4LCAyLjY5LCAzLjM0LCAzLjE3XTsKICBjb25zdCBOT1RFUyA9IFsnQycsICdDIycsICdEJywgJ0QjJywgJ0UnLCAnRicsICdGIycsICdHJywgJ0cjJywgJ0EnLCAnQSMnLCAnQiddOwoKICBmdW5jdGlvbiBkZXRlY3RLZXkoYnVmLCBjYikgewogICAgdHJ5IHsKICAgICAgY29uc3Qgc3IgPSBidWYuc2FtcGxlUmF0ZTsKICAgICAgY29uc3QgbGVuID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgc3IgKiAzMCk7CiAgICAgIGNvbnN0IGRhdGEgPSBidWYuZ2V0Q2hhbm5lbERhdGEoMCkuc2xpY2UoMCwgbGVuKTsKICAgICAgY29uc3QgY2hyb21hID0gbmV3IEZsb2F0MzJBcnJheSgxMikuZmlsbCgwKTsKICAgICAgY29uc3QgZmZ0ID0gNDA5NiwgaG9wID0gMjA0ODsKICAgICAgbGV0IGZyYW1lcyA9IDA7CiAgICAgIGZvciAobGV0IHN0YXJ0ID0gMDsgc3RhcnQgKyBmZnQgPCBkYXRhLmxlbmd0aDsgc3RhcnQgKz0gaG9wKSB7CiAgICAgICAgZm9yIChsZXQgbSA9IDM2OyBtIDwgOTY7IG0rKykgewogICAgICAgICAgY29uc3QgZnJlcSA9IDQ0MCAqIE1hdGgucG93KDIsIChtIC0gNjkpIC8gMTIpOwogICAgICAgICAgY29uc3Qgb21lZ2EgPSAyICogTWF0aC5QSSAqIGZyZXEgLyBzcjsKICAgICAgICAgIGxldCByZSA9IDAsIGltID0gMDsKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZmZ0OyBqICs9IDMpIHsKICAgICAgICAgICAgcmUgKz0gZGF0YVtzdGFydCArIGpdICogTWF0aC5jb3Mob21lZ2EgKiBqKTsKICAgICAgICAgICAgaW0gLT0gZGF0YVtzdGFydCArIGpdICogTWF0aC5zaW4ob21lZ2EgKiBqKTsKICAgICAgICAgIH0KICAgICAgICAgIGNocm9tYVttICUgMTJdICs9IE1hdGguc3FydChyZSAqIHJlICsgaW0gKiBpbSk7CiAgICAgICAgfQogICAgICAgIGZyYW1lcysrOwogICAgICAgIGlmIChmcmFtZXMgPiAyMCkgYnJlYWs7CiAgICAgIH0KICAgICAgY29uc3QgbXggPSBNYXRoLm1heCguLi5jaHJvbWEpIHx8IDE7CiAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgMTI7IGsrKykgY2hyb21hW2tdIC89IG14OwogICAgICBsZXQgYmVzdEtleSA9ICdDJywgYmVzdFNjb3JlID0gLUluZmluaXR5OwogICAgICBmb3IgKGxldCByID0gMDsgciA8IDEyOyByKyspIHsKICAgICAgICBsZXQgc20gPSAwLCBzbiA9IDA7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMjsgaisrKSB7CiAgICAgICAgICBzbSArPSBjaHJvbWFbal0gKiBLU19NQUpbKGogLSByICsgMTIpICUgMTJdOwogICAgICAgICAgc24gKz0gY2hyb21hW2pdICogS1NfTUlOWyhqIC0gciArIDEyKSAlIDEyXTsKICAgICAgICB9CiAgICAgICAgaWYgKHNtID4gYmVzdFNjb3JlKSB7IGJlc3RTY29yZSA9IHNtOyBiZXN0S2V5ID0gTk9URVNbcl07IH0KICAgICAgICBpZiAoc24gPiBiZXN0U2NvcmUpIHsgYmVzdFNjb3JlID0gc247IGJlc3RLZXkgPSBOT1RFU1tyXSArICdtJzsgfQogICAgICB9CiAgICAgIGNiKGJlc3RLZXkpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBjYihudWxsKTsKICAgIH0KICB9CgogIC8vIC0tLSBBbmltYXRpb24gdGljayAtLS0KICBmdW5jdGlvbiB0aWNrKCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBOOyBpKyspIHsKICAgICAgY29uc3QgZCA9IERbaV07CiAgICAgIGlmICghZC5idWYgfHwgIWQucGxheWluZykgY29udGludWU7CiAgICAgIAogICAgICBjb25zdCBlbGFwc2VkID0gKGN0eC5jdXJyZW50VGltZSAtIGQuc3QpICogZC5zcGVlZDsKICAgICAgbGV0IHBvczsKICAgICAgCiAgICAgIGlmIChkLmxvb3BNb2RlID09PSAnYmVhdCcgJiYgZC5sb29wQmVhdHMgPiAwICYmIGQuYnBtID4gMCkgewogICAgICAgIGNvbnN0IGxsID0gKDYwIC8gZC5icG0pICogZC5sb29wQmVhdHM7CiAgICAgICAgY29uc3QgbGUgPSBkLmxvb3BTdGFydCArIGxsOwogICAgICAgIHBvcyA9IChsZSA8PSBkLmJ1Zi5kdXJhdGlvbikgPyBkLmxvb3BTdGFydCArIChlbGFwc2VkICUgbGwpIDogZWxhcHNlZCAlIGQuYnVmLmR1cmF0aW9uOwogICAgICB9IAogICAgICBlbHNlIGlmIChkLmxvb3BNb2RlID09PSAnZnJlZScgJiYgZC5mcmVlTG9vcEVuZCA+IGQuZnJlZUxvb3BTdGFydCkgewogICAgICAgIGNvbnN0IGxvb3BMZW4gPSBkLmZyZWVMb29wRW5kIC0gZC5mcmVlTG9vcFN0YXJ0OwogICAgICAgIHBvcyA9IGQuZnJlZUxvb3BTdGFydCArIChlbGFwc2VkICUgbG9vcExlbik7CiAgICAgIH0KICAgICAgZWxzZSB7CiAgICAgICAgcG9zID0gZWxhcHNlZCAlIGQuYnVmLmR1cmF0aW9uOwogICAgICB9CiAgICAgIAogICAgICB1cGRhdGVQbGF5aGVhZFBvcyhpLCBwb3MpOwogICAgfQogICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spOwogIH0KCiAgLy8gLS0tIFJlc2l6ZSAtLS0KICBsZXQgcmVzaXplVGltZXI7CiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHsKICAgIGNsZWFyVGltZW91dChyZXNpemVUaW1lcik7CiAgICByZXNpemVUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgIGlmIChEW2ldLnBlYWtzKSB7IGRyYXdXRihpKTsgZHJhd0JHKGkpOyB9CiAgICAgIH0KICAgIH0sIDE1MCk7CiAgfSk7CgogIHdpbmRvdy5zZXRNYXN0ZXIgPSBmdW5jdGlvbihpKSB7CiAgICBtYXN0ZXJJZHggPSBpOwogICAgZm9yIChsZXQgaiA9IDA7IGogPCBOOyBqKyspIHsKICAgICAgJChgZGstJHtqfWApLmNsYXNzTGlzdC50b2dnbGUoJ21hc3RlcicsIGogPT09IGkpOwogICAgfQogIH07CgogIHdpbmRvdy5zeW5jRGVjayA9IGZ1bmN0aW9uKGkpIHsKICAgIGlmIChpID09PSBtYXN0ZXJJZHgpIHsgc3RhdHVzKGksICdHacOgIE1hc3RlcicpOyByZXR1cm47IH0KICAgIGNvbnN0IG1iID0gRFttYXN0ZXJJZHhdLmJwbU5hdGl2ZTsKICAgIGNvbnN0IGRiID0gRFtpXS5icG1OYXRpdmU7CiAgICBpZiAoIW1iIHx8ICFkYikgeyBhbGVydCgnQlBNIG1hbmNhbnRlJyk7IHJldHVybjsgfQogICAgY29uc3QgcmF0aW8gPSBNYXRoLm1pbigyLCBNYXRoLm1heCgwLjUsIG1iIC8gZGIpKTsKICAgIERbaV0uYnBtID0gbWI7CiAgICB3aW5kb3cuc2V0U3BlZWQoaSwgcmF0aW8pOwogICAgc3RhdHVzKGksIGBTeW5jICR7bWIudG9GaXhlZCgxKX0gQlBNICh4JHtyYXRpby50b0ZpeGVkKDMpfSlgKTsKICB9OwoKICAvLyAtLS0gSW5pemlhbGl6emEgLS0tCiAgd2luZG93LnNldE1hc3RlcigwKTsKICAKICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgd2luZG93LnNldFpvb20oaSwgMSk7CiAgICB3aW5kb3cuc2V0Wm9vbVBvcyhpLCAwLjUpOwogIH0KICAKICB0aWNrKCk7Cgp9KSgpOwo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+"}, "04": {"title": "Synth", "b64": "PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9Iml0Ij4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9InV0Zi04Ii8+CjxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsaW5pdGlhbC1zY2FsZT0xLHZpZXdwb3J0LWZpdD1jb3ZlciIvPgo8dGl0bGU+TWFyYWNhU3ludGg8L3RpdGxlPgo8c3R5bGU+Cjpyb290ewogIC0tYmc6IzA3MDgwZDsKICAtLXR4dDojZTdlZWZjOwogIC0tbXV0ZWQ6IzZhODJhODsKICAtLWFjY2VudDojNGVhMWZmOwogIC0tYWNjZW50MjojNmFmMGMyOwogIC0td2FybjojZmZjYzY2OwogIC0tYmFkOiNmZjVjN2E7CiAgLS1vazojNGJmMDhhOwogIC0tcHVycGxlOiNjMDdhZmY7CiAgLS1icjoxNnB4OwogIC0tZ2FwOjEycHg7CiAgLS1zaGFkb3c6MCAxNHB4IDUwcHggcmdiYSgwLDAsMCwuNTUpOwogIC0tbGluZToxcHggc29saWQgcmdiYSgyNTUsMjU1LDI1NSwuMDcpOwp9Cip7Ym94LXNpemluZzpib3JkZXItYm94O21hcmdpbjowO3BhZGRpbmc6MH0KaHRtbCxib2R5e2hlaWdodDoxMDAlfQpib2R5ewogIGZvbnQtZmFtaWx5OnVpLXNhbnMtc2VyaWYsc3lzdGVtLXVpLC1hcHBsZS1zeXN0ZW0sU2Vnb2UgVUksUm9ib3RvLEFyaWFsLHNhbnMtc2VyaWY7CiAgYmFja2dyb3VuZDoKICAgIHJhZGlhbC1ncmFkaWVudChlbGxpcHNlIDE2MDBweCA3MDBweCBhdCAyMCUgLTUlLHJnYmEoNzgsMTYxLDI1NSwuMTgpIDAlLHRyYW5zcGFyZW50IDYwJSksCiAgICByYWRpYWwtZ3JhZGllbnQoZWxsaXBzZSAxMDAwcHggNjAwcHggYXQgODUlIDE1JSxyZ2JhKDEwNiwyNDAsMTk0LC4xMykgMCUsdHJhbnNwYXJlbnQgNTUlKSwKICAgIHJhZGlhbC1ncmFkaWVudChlbGxpcHNlIDkwMHB4IDUwMHB4IGF0IDUwJSA5NSUscmdiYSgxOTIsMTIyLDI1NSwuMTIpIDAlLHRyYW5zcGFyZW50IDU1JSksCiAgICB2YXIoLS1iZyk7CiAgY29sb3I6dmFyKC0tdHh0KTsKICBvdmVyZmxvdy14OmhpZGRlbjsKfQoud3JhcHttYXgtd2lkdGg6MTMyMHB4O21hcmdpbjowIGF1dG87cGFkZGluZzoxOHB4IDE4cHggNzBweH0KCmhlYWRlcntkaXNwbGF5OmZsZXg7ZmxleC13cmFwOndyYXA7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2dhcDoxMnB4O21hcmdpbi1ib3R0b206MjBweDt9Ci5sb2dve2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjE0cHg7fQoubG9nby1pY29uewogIHdpZHRoOjQ4cHg7aGVpZ2h0OjQ4cHg7Ym9yZGVyLXJhZGl1czoxNXB4OwogIGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDEzNWRlZywjNGVhMWZmLCM2YWYwYzIpOwogIGRpc3BsYXk6Z3JpZDtwbGFjZS1pdGVtczpjZW50ZXI7Zm9udC1zaXplOjI0cHg7CiAgYm94LXNoYWRvdzowIDAgMjhweCByZ2JhKDc4LDE2MSwyNTUsLjU1KTsKfQpoMXtmb250LXNpemU6MjJweDtmb250LXdlaWdodDo5MDA7bGV0dGVyLXNwYWNpbmc6LS40cHg7fQpoMSBlbXtjb2xvcjp2YXIoLS1hY2NlbnQyKTtmb250LXN0eWxlOm5vcm1hbDt9Ci5zdWJ7Y29sb3I6dmFyKC0tbXV0ZWQpO2ZvbnQtc2l6ZToxMnB4O21hcmdpbi10b3A6M3B4O30KCi5waWxsewogIHBhZGRpbmc6NnB4IDE0cHg7Ym9yZGVyLXJhZGl1czo5OTlweDtmb250LXNpemU6MTJweDsKICBib3JkZXI6dmFyKC0tbGluZSk7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LC4wNCk7CiAgY29sb3I6dmFyKC0tbXV0ZWQpO2Rpc3BsYXk6aW5saW5lLWZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo4cHg7d2hpdGUtc3BhY2U6bm93cmFwOwp9Ci5waWxsIGJ7Y29sb3I6dmFyKC0tdHh0KX0KCkBrZXlmcmFtZXMgcHVsc2V7MCUsMTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnNjYWxlKDEpfTUwJXtvcGFjaXR5Oi41O3RyYW5zZm9ybTpzY2FsZSguOCl9fQouZG90e3dpZHRoOjhweDtoZWlnaHQ6OHB4O2JvcmRlci1yYWRpdXM6NTAlO2Rpc3BsYXk6aW5saW5lLWJsb2NrO2ZsZXgtc2hyaW5rOjA7fQouZG90LmdyZWVue2JhY2tncm91bmQ6dmFyKC0tb2spO2FuaW1hdGlvbjpwdWxzZSAxLjVzIGluZmluaXRlO30KLmRvdC5yZWR7YmFja2dyb3VuZDp2YXIoLS1iYWQpO30KCi5jYXJkewogIGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE2MGRlZyxyZ2JhKDI1NSwyNTUsMjU1LC4wNTUpIDAlLHJnYmEoMjU1LDI1NSwyNTUsLjAxOCkgMTAwJSk7CiAgYm9yZGVyOnZhcigtLWxpbmUpO2JvcmRlci1yYWRpdXM6dmFyKC0tYnIpO2JveC1zaGFkb3c6dmFyKC0tc2hhZG93KTsKfQoKLnRvcC1ncmlke2Rpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6MS40ZnIgMWZyO2dhcDp2YXIoLS1nYXApO21hcmdpbi1ib3R0b206dmFyKC0tZ2FwKTt9CkBtZWRpYShtYXgtd2lkdGg6OTAwcHgpey50b3AtZ3JpZHtncmlkLXRlbXBsYXRlLWNvbHVtbnM6MWZyfX0KCi5jb250cm9sc3twYWRkaW5nOjE2cHg7fQouYnRuLXJvd3tkaXNwbGF5OmZsZXg7ZmxleC13cmFwOndyYXA7Z2FwOjhweDthbGlnbi1pdGVtczpjZW50ZXI7bWFyZ2luLWJvdHRvbToxNHB4O30KLmJ0bnsKICBhcHBlYXJhbmNlOm5vbmU7Ym9yZGVyOnZhcigtLWxpbmUpO2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuMDYpOwogIGNvbG9yOnZhcigtLXR4dCk7cGFkZGluZzoxMHB4IDE2cHg7Ym9yZGVyLXJhZGl1czoxM3B4O2N1cnNvcjpwb2ludGVyOwogIGZvbnQtd2VpZ2h0OjcwMDtmb250LXNpemU6MTNweDtkaXNwbGF5OmlubGluZS1mbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjsKICBnYXA6OHB4O3RyYW5zaXRpb246YWxsIC4xcyBlYXNlO3VzZXItc2VsZWN0Om5vbmU7d2hpdGUtc3BhY2U6bm93cmFwOwp9Ci5idG46aG92ZXJ7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LC4xMik7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTFweCk7fQouYnRuOmFjdGl2ZXt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxcHgpO30KLmJ0bi5wcmltYXJ5e2JvcmRlci1jb2xvcjpyZ2JhKDc4LDE2MSwyNTUsLjYpO2JhY2tncm91bmQ6cmdiYSg3OCwxNjEsMjU1LC4xOCk7fQouYnRuLmRhbmdlcntib3JkZXItY29sb3I6cmdiYSgyNTUsOTIsMTIyLC42KTtiYWNrZ3JvdW5kOnJnYmEoMjU1LDkyLDEyMiwuMTYpO30KLmJ0bi5va3tib3JkZXItY29sb3I6cmdiYSg3NSwyNDAsMTM4LC41KTtiYWNrZ3JvdW5kOnJnYmEoNzUsMjQwLDEzOCwuMTMpO30KLmJ0bi53YXJue2JvcmRlci1jb2xvcjpyZ2JhKDI1NSwyMDQsMTAyLC41KTtiYWNrZ3JvdW5kOnJnYmEoMjU1LDIwNCwxMDIsLjEyKTt9Ci5idG4ucHVycGxle2JvcmRlci1jb2xvcjpyZ2JhKDE5MiwxMjIsMjU1LC41KTtiYWNrZ3JvdW5kOnJnYmEoMTkyLDEyMiwyNTUsLjEyKTt9Ci5idG4uaG9sZC1hY3RpdmV7CiAgYm9yZGVyLWNvbG9yOnJnYmEoMjU1LDIwNCwxMDIsLjkpIWltcG9ydGFudDsKICBiYWNrZ3JvdW5kOnJnYmEoMjU1LDIwNCwxMDIsLjI1KSFpbXBvcnRhbnQ7CiAgY29sb3I6dmFyKC0td2FybikhaW1wb3J0YW50OwogIGJveC1zaGFkb3c6MCAwIDE4cHggcmdiYSgyNTUsMjA0LDEwMiwuMzUpOwp9CgouZzJ7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczoxZnIgMWZyO2dhcDoxMHB4O21hcmdpbi1ib3R0b206MTBweDt9Ci5nM3tkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciAxZnIgMWZyO2dhcDoxMHB4O21hcmdpbi1ib3R0b206MTBweDt9CkBtZWRpYShtYXgtd2lkdGg6NTYwcHgpey5nMiwuZzN7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmcn19Cgoua3Z7cGFkZGluZzoxMHB4O2JvcmRlci1yYWRpdXM6MTJweDtib3JkZXI6dmFyKC0tbGluZSk7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC4yMik7fQoua3YgbGFiZWx7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2ZvbnQtc2l6ZToxMS41cHg7Y29sb3I6dmFyKC0tbXV0ZWQpO21hcmdpbi1ib3R0b206NnB4O30KLmt2IGxhYmVsIGJ7Y29sb3I6dmFyKC0tdHh0KTt9Ci5rdiAuaGludHtmb250LXNpemU6MTAuNXB4O2NvbG9yOnZhcigtLW11dGVkKTttYXJnaW4tdG9wOjRweDt9CmlucHV0W3R5cGU9cmFuZ2Vde3dpZHRoOjEwMCU7YWNjZW50LWNvbG9yOnZhcigtLWFjY2VudCk7Y3Vyc29yOnBvaW50ZXI7fQpzZWxlY3QsaW5wdXRbdHlwZT1udW1iZXJdewogIHdpZHRoOjEwMCU7cGFkZGluZzo4cHggMTBweDtib3JkZXItcmFkaXVzOjExcHg7CiAgYm9yZGVyOnZhcigtLWxpbmUpO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMzIpO2NvbG9yOnZhcigtLXR4dCk7CiAgZm9udC1zaXplOjEyLjVweDtvdXRsaW5lOm5vbmU7Cn0Kc2VsZWN0OmZvY3VzLGlucHV0W3R5cGU9bnVtYmVyXTpmb2N1c3tib3JkZXItY29sb3I6cmdiYSg3OCwxNjEsMjU1LC41KTt9Cgouc2NvcGUtY2FyZHtwYWRkaW5nOjE0cHg7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6MTBweDt9Ci5zY29wZS1oZHJ7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmNlbnRlcjtmbGV4LXdyYXA6d3JhcDtnYXA6OHB4O30KY2FudmFzI3Njb3Ble3dpZHRoOjEwMCU7aGVpZ2h0OjE2MHB4O2JvcmRlci1yYWRpdXM6MTJweDtib3JkZXI6dmFyKC0tbGluZSk7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC4zNSk7ZGlzcGxheTpibG9jazt9CgoudnUtd3JhcHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo4cHg7bWFyZ2luLXRvcDoycHg7fQoudnUtYmFye2ZsZXg6MTtoZWlnaHQ6NnB4O2JvcmRlci1yYWRpdXM6M3B4O2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMzUpO2JvcmRlcjp2YXIoLS1saW5lKTtvdmVyZmxvdzpoaWRkZW47fQoudnUtZmlsbHtoZWlnaHQ6MTAwJTt3aWR0aDowJTtib3JkZXItcmFkaXVzOjNweDt0cmFuc2l0aW9uOndpZHRoIC4wOHMgbGluZWFyOwogIGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDkwZGVnLCM0YmYwOGEgMCUsI2ZmY2M2NiA2NSUsI2ZmNWM3YSAxMDAlKTt9Cgoja2JkLWNhcmR7bWFyZ2luLWJvdHRvbTp2YXIoLS1nYXApO30KLmtiZC10b3B7CiAgcGFkZGluZzoxNHB4IDE2cHggMTBweDsKICBkaXNwbGF5OmZsZXg7ZmxleC13cmFwOndyYXA7Z2FwOjEwcHg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOwp9Ci5rYmQtdGl0bGV7Zm9udC13ZWlnaHQ6ODAwO2ZvbnQtc2l6ZToxNXB4O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjEwcHg7fQoua2JkLW9wdHN7CiAgcGFkZGluZzowIDE2cHggMTBweDsKICBkaXNwbGF5OmZsZXg7ZmxleC13cmFwOndyYXA7Z2FwOjE0cHg7YWxpZ24taXRlbXM6Y2VudGVyO2ZvbnQtc2l6ZToxMnB4O2NvbG9yOnZhcigtLW11dGVkKTsKfQoua2JkLW9wdHMgLm9wdC1ncm91cHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo2cHg7fQoua2JkLW9wdHMgc2VsZWN0e3dpZHRoOmF1dG87cGFkZGluZzo1cHggOHB4O2ZvbnQtc2l6ZToxMS41cHg7Ym9yZGVyLXJhZGl1czo4cHg7fQoua2JkLW9wdHMgaW5wdXRbdHlwZT1yYW5nZV17d2lkdGg6NzBweDt9Ci5rYmQtb3B0cyBjb2RlewogIGJhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuMDgpO3BhZGRpbmc6MnB4IDZweDtib3JkZXItcmFkaXVzOjVweDsKICBmb250LWZhbWlseTptb25vc3BhY2U7Zm9udC1zaXplOjEwLjVweDtjb2xvcjp2YXIoLS1hY2NlbnQyKTsKfQoKLmtiZC1zY3JvbGx7b3ZlcmZsb3cteDphdXRvO3BhZGRpbmc6MCAxNnB4IDE2cHg7c2Nyb2xsYmFyLXdpZHRoOnRoaW47fQoua2V5Ym9hcmR7CiAgcG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmZsZXgtc3RhcnQ7CiAgaGVpZ2h0OjE0MHB4O21pbi13aWR0aDptYXgtY29udGVudDt1c2VyLXNlbGVjdDpub25lOwp9Ci5rd3sKICBwb3NpdGlvbjpyZWxhdGl2ZTtmbGV4LXNocmluazowOwogIHdpZHRoOjM4cHg7aGVpZ2h0OjEzOHB4OwogIGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZywjY2RkOWVmIDAlLCNmMGY1ZmYgNTUlLCNlMmVjZmYgMTAwJSk7CiAgYm9yZGVyOjFweCBzb2xpZCAjOWFhZGNjO2JvcmRlci10b3A6bm9uZTsKICBib3JkZXItcmFkaXVzOjAgMCA5cHggOXB4OwogIGN1cnNvcjpwb2ludGVyO3otaW5kZXg6MTsKICBkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQ7CiAgcGFkZGluZy1ib3R0b206N3B4O2dhcDoxcHg7CiAgdHJhbnNpdGlvbjpiYWNrZ3JvdW5kIC4wNXMsYm94LXNoYWRvdyAuMDVzOwp9Ci5rdzpob3ZlcntiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxODBkZWcsI2JkZDBlZiAwJSwjZTBlY2ZmIDU1JSwjZDJlNGZmIDEwMCUpO30KLmt3LnByZXNzZWR7CiAgYmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCM0ZWExZmYgMCUsIzcwYjhmZiA1NSUsI2EwZDBmZiAxMDAlKTsKICBib3gtc2hhZG93Omluc2V0IDAgNHB4IDE0cHggcmdiYSg3OCwxNjEsMjU1LC43KSwgMCAwIDIwcHggcmdiYSg3OCwxNjEsMjU1LC41KTsKfQoua3cgLmtuYW1le2ZvbnQtc2l6ZTo5LjVweDtmb250LXdlaWdodDo4MDA7Y29sb3I6IzNhNGE2YTtsZXR0ZXItc3BhY2luZzotLjJweDt9Ci5rdyAua2ZyZXF7Zm9udC1zaXplOjcuNXB4O2NvbG9yOiM2YTdhOWE7Zm9udC1mYW1pbHk6bW9ub3NwYWNlO30KLmt3IC5rcGN7CiAgcG9zaXRpb246YWJzb2x1dGU7dG9wOjZweDtsZWZ0OjA7cmlnaHQ6MDt0ZXh0LWFsaWduOmNlbnRlcjsKICBmb250LXNpemU6OC41cHg7Zm9udC13ZWlnaHQ6ODAwO2NvbG9yOnJnYmEoNjAsODAsMTQwLC41NSk7Cn0KLmt3LnByZXNzZWQgLmtuYW1le2NvbG9yOiMwMDIyNDQ7fQoua3cucHJlc3NlZCAua2ZyZXF7Y29sb3I6IzAwMzM2Njt9Ci5rdy5wcmVzc2VkIC5rcGN7Y29sb3I6cmdiYSgwLDMwLDgwLC41KTt9Cgoua3cuYW5jaG9yewogIGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZywjZTBjOGZmIDAlLCNmNWVmZmYgNTUlLCNlY2RlZmYgMTAwJSk7CiAgYm9yZGVyLWNvbG9yOiNiMDkwZTA7Cn0KLmt3LmFuY2hvcjpob3ZlcntiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxODBkZWcsI2QwYjhmZiAwJSwjZThlMGZmIDU1JSwjZGNjZWZmIDEwMCUpO30KLmt3LmFuY2hvci5wcmVzc2Vke2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZywjYzA3YWZmIDAlLCNkOGEwZmYgNTUlLCNlOGM4ZmYgMTAwJSk7fQoKLmtiewogIHBvc2l0aW9uOmFic29sdXRlO3RvcDowO3otaW5kZXg6MjsKICB3aWR0aDoyNHB4O2hlaWdodDo4NHB4OwogIGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZywjMTQxODJhIDAlLCMyMjI2M2MgNjUlLCMyZTM0NTAgMTAwJSk7CiAgYm9yZGVyOjFweCBzb2xpZCAjMGEwYzE4OwogIGJvcmRlci1yYWRpdXM6MCAwIDZweCA2cHg7CiAgY3Vyc29yOnBvaW50ZXI7CiAgZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kOwogIHBhZGRpbmctYm90dG9tOjVweDtnYXA6MXB4OwogIHRyYW5zaXRpb246YmFja2dyb3VuZCAuMDVzLGJveC1zaGFkb3cgLjA1czsKfQoua2I6aG92ZXJ7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCMxZTIyNDAgMCUsIzJlMzI1NCA2NSUsIzNlNDQ2OCAxMDAlKTt9Ci5rYi5wcmVzc2VkewogIGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZywjMmQ2YWI4IDAlLCMzYTdlY2MgNjUlLCM1MDkwZDggMTAwJSk7CiAgYm94LXNoYWRvdzppbnNldCAwIDNweCAxMHB4IHJnYmEoNzgsMTYxLDI1NSwuNiksIDAgMCAxNHB4IHJnYmEoNzgsMTYxLDI1NSwuNCk7Cn0KLmtiIC5rbmFtZXtmb250LXNpemU6OHB4O2ZvbnQtd2VpZ2h0OjgwMDtjb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC41NSk7fQoua2IgLmtmcmVxe2ZvbnQtc2l6ZTo2LjVweDtjb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC4zNSk7Zm9udC1mYW1pbHk6bW9ub3NwYWNlO30KLmtiIC5rcGN7CiAgcG9zaXRpb246YWJzb2x1dGU7dG9wOjVweDtsZWZ0OjA7cmlnaHQ6MDt0ZXh0LWFsaWduOmNlbnRlcjsKICBmb250LXNpemU6Ny41cHg7Zm9udC13ZWlnaHQ6ODAwO2NvbG9yOnJnYmEoMjAwLDIyMCwyNTUsLjQpOwp9Ci5rYi5wcmVzc2VkIC5rbmFtZXtjb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC45KTt9Ci5rYi5wcmVzc2VkIC5rZnJlcXtjb2xvcjpyZ2JhKDIwMCwyMzAsMjU1LC44KTt9CgouYWN0aXZlLW5vdGVzewogIHBhZGRpbmc6OHB4IDE2cHggMTJweDsKICBkaXNwbGF5OmZsZXg7ZmxleC13cmFwOndyYXA7Z2FwOjZweDthbGlnbi1pdGVtczpjZW50ZXI7bWluLWhlaWdodDozNnB4Owp9Ci5ub3RlLWNoaXB7CiAgZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjRweDsKICBwYWRkaW5nOjNweCA5cHg7Ym9yZGVyLXJhZGl1czo5OTlweDtmb250LXNpemU6MTFweDtmb250LXdlaWdodDo3MDA7CiAgYmFja2dyb3VuZDpyZ2JhKDc4LDE2MSwyNTUsLjE4KTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoNzgsMTYxLDI1NSwuNCk7Y29sb3I6dmFyKC0tYWNjZW50KTsKICBhbmltYXRpb246Y2hpcEluIC4xcyBlYXNlOwp9CkBrZXlmcmFtZXMgY2hpcElue2Zyb217b3BhY2l0eTowO3RyYW5zZm9ybTpzY2FsZSguOCl9dG97b3BhY2l0eToxO3RyYW5zZm9ybTpzY2FsZSgxKX19Ci5ub3RlLWNoaXAgLm5oentmb250LXNpemU6OS41cHg7Zm9udC13ZWlnaHQ6NDAwO2NvbG9yOnZhcigtLW11dGVkKTt9Cgouc2VjdGlvbi10aXRsZXsKICBkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMHB4O21hcmdpbi1ib3R0b206dmFyKC0tZ2FwKTsKICBmb250LXNpemU6MTJweDtmb250LXdlaWdodDo4MDA7Y29sb3I6dmFyKC0tbXV0ZWQpO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzouOHB4Owp9Ci5zZWN0aW9uLXRpdGxlOjphZnRlcntjb250ZW50OicnO2ZsZXg6MTtoZWlnaHQ6MXB4O2JhY2tncm91bmQ6dmFyKC0tbGluZSk7fQoKLnZvaWNlc3tkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgyLDFmcik7Z2FwOnZhcigtLWdhcCk7fQpAbWVkaWEobWF4LXdpZHRoOjkwMHB4KXsudm9pY2Vze2dyaWQtdGVtcGxhdGUtY29sdW1uczoxZnJ9fQoKLnZvaWNle3BhZGRpbmc6MTRweDt9Ci52b2ljZS5rYmQtYWN0aXZle2JvcmRlci1jb2xvcjpyZ2JhKDc4LDE2MSwyNTUsLjQpO2JveC1zaGFkb3c6dmFyKC0tc2hhZG93KSwwIDAgMjBweCByZ2JhKDc4LDE2MSwyNTUsLjE4KTt9Ci52aGVhZHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2dhcDo4cHg7bWFyZ2luLWJvdHRvbToxMHB4O30KLnZsZWZ0e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjEwcHg7fQouYmFkZ2V7CiAgd2lkdGg6MzBweDtoZWlnaHQ6MzBweDtib3JkZXItcmFkaXVzOjlweDsKICBkaXNwbGF5OmdyaWQ7cGxhY2UtaXRlbXM6Y2VudGVyO2JvcmRlcjp2YXIoLS1saW5lKTsKICBiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsLjA1KTtmb250LXdlaWdodDo5MDA7Zm9udC1zaXplOjE0cHg7Cn0KLnZuYW1le2ZvbnQtd2VpZ2h0OjgwMDtmb250LXNpemU6MTNweDt9Ci52aW5mb3tmb250LXNpemU6MTAuNXB4O2NvbG9yOnZhcigtLW11dGVkKTtmb250LWZhbWlseTptb25vc3BhY2U7bWFyZ2luLXRvcDoxcHg7fQoubnRhZ3sKICBkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOjFweCA2cHg7Ym9yZGVyLXJhZGl1czo1cHg7CiAgZm9udC1zaXplOjkuNXB4O2ZvbnQtd2VpZ2h0OjgwMDsKICBiYWNrZ3JvdW5kOnJnYmEoNzgsMTYxLDI1NSwuMTUpO2NvbG9yOnZhcigtLWFjY2VudCk7CiAgYm9yZGVyOjFweCBzb2xpZCByZ2JhKDc4LDE2MSwyNTUsLjI4KTttYXJnaW4tbGVmdDo0cHg7Cn0KLnRvZ2dsZXN7ZGlzcGxheTpmbGV4O2dhcDo1cHg7ZmxleC13cmFwOndyYXA7fQouY2hpcHsKICBib3JkZXI6dmFyKC0tbGluZSk7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LC4wNCk7CiAgY29sb3I6dmFyKC0tdHh0KTtwYWRkaW5nOjZweCA5cHg7Ym9yZGVyLXJhZGl1czo5OTlweDsKICBmb250LXdlaWdodDo3MDA7Y3Vyc29yOnBvaW50ZXI7dXNlci1zZWxlY3Q6bm9uZTsKICBmb250LXNpemU6MTFweDt0cmFuc2l0aW9uOmFsbCAuMXMgZWFzZTsKfQouY2hpcDpob3ZlcntiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsLjEpO30KLmNoaXAub257Ym9yZGVyLWNvbG9yOnJnYmEoMTA2LDI0MCwxOTQsLjU1KTtiYWNrZ3JvdW5kOnJnYmEoMTA2LDI0MCwxOTQsLjE0KTtjb2xvcjp2YXIoLS1hY2NlbnQyKTt9Ci5jaGlwLm11dGUub257Ym9yZGVyLWNvbG9yOnJnYmEoMjU1LDkyLDEyMiwuNSk7YmFja2dyb3VuZDpyZ2JhKDI1NSw5MiwxMjIsLjEzKTtjb2xvcjp2YXIoLS1iYWQpO30KLmNoaXAuc29sby5vbntib3JkZXItY29sb3I6cmdiYSgyNTUsMjA0LDEwMiwuNik7YmFja2dyb3VuZDpyZ2JhKDI1NSwyMDQsMTAyLC4xNSk7Y29sb3I6dmFyKC0td2Fybik7fQoKLm1vbm97Zm9udC1mYW1pbHk6bW9ub3NwYWNlO30KLnNtYWxse2ZvbnQtc2l6ZToxMS41cHg7Y29sb3I6dmFyKC0tbXV0ZWQpO30KLmZvb3Rlci1ub3Rle21hcmdpbi10b3A6MTRweDtjb2xvcjp2YXIoLS1tdXRlZCk7Zm9udC1zaXplOjExLjVweDtsaW5lLWhlaWdodDoxLjU1O30KCjo6LXdlYmtpdC1zY3JvbGxiYXJ7d2lkdGg6NXB4O2hlaWdodDo1cHg7fQo6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNre2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMik7fQo6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1ie2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuMSk7Ym9yZGVyLXJhZGl1czozcHg7fQo8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5Pgo8ZGl2IGNsYXNzPSJ3cmFwIj4KCjwhLS0gSEVBREVSIC0tPgo8aGVhZGVyPgogIDxkaXYgY2xhc3M9ImxvZ28iPgogICAgPGRpdj4KICAgICAgPGgxPk1hcmFjYTxlbT5TeW50aDwvZW0+IDxzbWFsbCBzdHlsZT0iZm9udC1zaXplOjEycHg7Zm9udC13ZWlnaHQ6NDAwO2NvbG9yOnZhcigtLW11dGVkKSI+djM8L3NtYWxsPjwvaDE+CiAgICAgIDxkaXYgY2xhc3M9InN1YiI+QkVTVC1TWU5USDwvZGl2PgogICAgPC9kaXY+CiAgPC9kaXY+CiAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo4cHg7ZmxleC13cmFwOndyYXA7YWxpZ24taXRlbXM6Y2VudGVyOyI+CiAgICA8ZGl2IGNsYXNzPSJwaWxsIj48c3BhbiBjbGFzcz0iZG90IHJlZCIgaWQ9InNkb3QiPjwvc3Bhbj48YiBpZD0ic3RhdHVzIj5TVE9QPC9iPjxzcGFuIGNsYXNzPSJtb25vIiBpZD0ic3IiPjwvc3Bhbj48L2Rpdj4KICAgIDxkaXYgY2xhc3M9InBpbGwiPk1peDogPGIgaWQ9Im1peEluZm8iPuKAlDwvYj48L2Rpdj4KICAgIDxkaXYgY2xhc3M9InBpbGwiPlZvY2kgYXR0aXZlOiA8YiBpZD0icG9seUNvdW50Ij4wPC9iPjwvZGl2PgogIDwvZGl2Pgo8L2hlYWRlcj4KCjwhLS0gVE9QIEdSSUQgLS0+CjxzZWN0aW9uIGNsYXNzPSJ0b3AtZ3JpZCI+CgogIDwhLS0gQ09OVFJPTFMgLS0+CiAgPGRpdiBjbGFzcz0iY2FyZCBjb250cm9scyI+CiAgICA8ZGl2IGNsYXNzPSJidG4tcm93Ij4KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIHByaW1hcnkiIGlkPSJidG5TdGFydCI+U3RhcnQ8L2J1dHRvbj4KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIGRhbmdlciIgaWQ9ImJ0blN0b3AiIGRpc2FibGVkPlN0b3A8L2J1dHRvbj4KICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0iYnRuUGFuaWMiPlBhbmljPC9idXR0b24+CiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biB3YXJuIiBpZD0iYnRuSG9sZCI+SE9MRDogT0ZGPC9idXR0b24+CiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBwdXJwbGUiIGlkPSJidG5BbGxPZmYiPkFsbCBOb3RlcyBPZmY8L2J1dHRvbj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImcyIj4KICAgICAgPGRpdiBjbGFzcz0ia3YiPgogICAgICAgIDxsYWJlbD48c3Bhbj5NYXN0ZXIgVm9sdW1lPC9zcGFuPjxiIGlkPSJtYXN0ZXJWYWwiPjAuNDA8L2I+PC9sYWJlbD4KICAgICAgICA8aW5wdXQgaWQ9Im1hc3RlciIgdHlwZT0icmFuZ2UiIG1pbj0iMCIgbWF4PSIxIiBzdGVwPSIwLjAwMSIgdmFsdWU9IjAuNDAiPgogICAgICAgIDxkaXYgY2xhc3M9InZ1LXdyYXAiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTBweDtjb2xvcjp2YXIoLS1tdXRlZCkiPlZVPC9zcGFuPjxkaXYgY2xhc3M9InZ1LWJhciI+PGRpdiBjbGFzcz0idnUtZmlsbCIgaWQ9InZ1RmlsbCI+PC9kaXY+PC9kaXY+PC9kaXY+CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJrdiI+CiAgICAgICAgPGxhYmVsPjxzcGFuPkxpbWl0ZXI8L3NwYW4+PGIgaWQ9ImxpbVZhbCI+4oiSNiBkQjwvYj48L2xhYmVsPgogICAgICAgIDxpbnB1dCBpZD0ibGltaXRlciIgdHlwZT0icmFuZ2UiIG1pbj0iLTI0IiBtYXg9Ii0xIiBzdGVwPSIxIiB2YWx1ZT0iLTYiPgogICAgICAgIDxkaXYgY2xhc3M9ImhpbnQiPkR5bmFtaWNzQ29tcHJlc3NvciBhbnRpLWNsaXA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJnMyI+CiAgICAgIDxkaXYgY2xhc3M9Imt2Ij4KICAgICAgICA8bGFiZWw+PHNwYW4+QXR0YWNrPC9zcGFuPjxiIGlkPSJhVmFsIj4wLjAxMCBzPC9iPjwvbGFiZWw+CiAgICAgICAgPGlucHV0IGlkPSJhdGsiIHR5cGU9InJhbmdlIiBtaW49IjAuMDAxIiBtYXg9IjIiIHN0ZXA9IjAuMDAxIiB2YWx1ZT0iMC4wMTAiPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ia3YiPgogICAgICAgIDxsYWJlbD48c3Bhbj5EZWNheTwvc3Bhbj48YiBpZD0iZFZhbCI+MC4xMDAgczwvYj48L2xhYmVsPgogICAgICAgIDxpbnB1dCBpZD0iZGVjIiB0eXBlPSJyYW5nZSIgbWluPSIwLjAwMSIgbWF4PSIyIiBzdGVwPSIwLjAwMSIgdmFsdWU9IjAuMTAwIj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9Imt2Ij4KICAgICAgICA8bGFiZWw+PHNwYW4+U3VzdGFpbjwvc3Bhbj48YiBpZD0ic1ZhbCI+MC43NTwvYj48L2xhYmVsPgogICAgICAgIDxpbnB1dCBpZD0ic3VzIiB0eXBlPSJyYW5nZSIgbWluPSIwIiBtYXg9IjEiIHN0ZXA9IjAuMDAxIiB2YWx1ZT0iMC43NSI+CiAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iZzMiPgogICAgICA8ZGl2IGNsYXNzPSJrdiI+CiAgICAgICAgPGxhYmVsPjxzcGFuPlJlbGVhc2U8L3NwYW4+PGIgaWQ9InJWYWwiPjAuMzAwIHM8L2I+PC9sYWJlbD4KICAgICAgICA8aW5wdXQgaWQ9InJlbCIgdHlwZT0icmFuZ2UiIG1pbj0iMC4wMDEiIG1heD0iNSIgc3RlcD0iMC4wMDEiIHZhbHVlPSIwLjMwMCI+CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJrdiI+CiAgICAgICAgPGxhYmVsPjxzcGFuPkdsb2JhbCBEZXR1bmU8L3NwYW4+PGIgaWQ9ImdEZXRWYWwiPjAgwqI8L2I+PC9sYWJlbD4KICAgICAgICA8aW5wdXQgaWQ9ImdEZXQiIHR5cGU9InJhbmdlIiBtaW49Ii0xMDAiIG1heD0iMTAwIiBzdGVwPSIxIiB2YWx1ZT0iMCI+CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJrdiI+CiAgICAgICAgPGxhYmVsPjxzcGFuPlByZXNldDwvc3Bhbj48Yj5RdWljazwvYj48L2xhYmVsPgogICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6OHB4OyI+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4iIGlkPSJwcmVzZXRDaG9yZCIgc3R5bGU9ImZsZXg6MTtwYWRkaW5nOjhweCA2cHg7Zm9udC1zaXplOjEycHg7Ij5DaG9yZDwvYnV0dG9uPgogICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIiBpZD0icHJlc2V0SGFybSIgc3R5bGU9ImZsZXg6MTtwYWRkaW5nOjhweCA2cHg7Zm9udC1zaXplOjEycHg7Ij5IYXJtPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgPC9kaXY+CgogIDxkaXYgY2xhc3M9ImNhcmQgc2NvcGUtY2FyZCI+CiAgICA8ZGl2IGNsYXNzPSJzY29wZS1oZHIiPgogICAgICA8ZGl2IGNsYXNzPSJwaWxsIj7wn5OhIE9zY2lsbG9zY29waW88L2Rpdj4KICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo4cHg7Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJwaWxsIj5GUFMgPGIgaWQ9ImZwcyI+4oCUPC9iPjwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InBpbGwiPlJNUyA8YiBpZD0icm1zVmFsIj7igJQ8L2I+PC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9kaXY+CiAgICA8Y2FudmFzIGlkPSJzY29wZSIgd2lkdGg9IjkwMCIgaGVpZ2h0PSIyNjAiPjwvY2FudmFzPgogICAgPGRpdiBjbGFzcz0ic21hbGwiPlNlZ25hbGUgcG9zdC1saW1pdGVyLiBGb3JtYSBwaWF0dGEgPSBjbGlwcGluZyDihpIgYWJiYXNzYSBtYXN0ZXIuPC9kaXY+CiAgPC9kaXY+Cgo8L3NlY3Rpb24+Cgo8ZGl2IGNsYXNzPSJjYXJkIiBpZD0ia2JkLWNhcmQiPgogIDxkaXYgY2xhc3M9ImtiZC10b3AiPgogICAgPGRpdiBjbGFzcz0ia2JkLXRpdGxlIj7wn465IFRhc3RpZXJhIFBvbGlmb25pY2EKICAgICAgPHNwYW4gY2xhc3M9InBpbGwiIHN0eWxlPSJiYWNrZ3JvdW5kOnJnYmEoMTkyLDEyMiwyNTUsLjEpO2JvcmRlci1jb2xvcjpyZ2JhKDE5MiwxMjIsMjU1LC40KTtjb2xvcjp2YXIoLS1wdXJwbGUpOyI+QTUgPSA4ODAgSHo8L3NwYW4+CiAgICA8L2Rpdj4KICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6OHB4O2ZsZXgtd3JhcDp3cmFwOyI+CiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biB3YXJuIiBpZD0iYnRuSG9sZDIiPvCflJIgSE9MRDogT0ZGPC9idXR0b24+CiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBwdXJwbGUiIGlkPSJidG5BbGxPZmYyIj7wn5SHIEFsbCBOb3RlcyBPZmY8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvZGl2PgoKICA8ZGl2IGNsYXNzPSJrYmQtb3B0cyI+CiAgICA8ZGl2IGNsYXNzPSJvcHQtZ3JvdXAiPgogICAgICA8c3Bhbj5Gb3JtYSBkJ29uZGE6PC9zcGFuPgogICAgICA8c2VsZWN0IGlkPSJrYmRXYXZlIj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSJzaW5lIj5TaW5lIOOAnDwvb3B0aW9uPgogICAgICAgIDxvcHRpb24gdmFsdWU9InRyaWFuZ2xlIiBzZWxlY3RlZD5UcmlhbmdsZSDilrM8L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSJzYXd0b290aCI+U2F3dG9vdGggL3w8L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSJzcXVhcmUiPlNxdWFyZSDilq08L29wdGlvbj4KICAgICAgPC9zZWxlY3Q+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9Im9wdC1ncm91cCI+CiAgICAgIDxzcGFuPkdhaW4gbm90YTo8L3NwYW4+CiAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgaWQ9ImtiZExldmVsIiBtaW49IjAuMDEiIG1heD0iMC41NSIgc3RlcD0iMC4wMSIgdmFsdWU9IjAuMjIiPgogICAgICA8YiBpZD0ia2JkTHZsVmFsIiBzdHlsZT0iY29sb3I6dmFyKC0tYWNjZW50Mik7Ij4wLjIyPC9iPgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJvcHQtZ3JvdXAiPgogICAgICA8c3Bhbj5NYXggdm9jaTo8L3NwYW4+CiAgICAgIDxzZWxlY3QgaWQ9ImtiZE1heFBvbHkiPgogICAgICAgIDxvcHRpb24gdmFsdWU9IjgiPjg8L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSIxNiIgc2VsZWN0ZWQ+MTY8L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSIzMiI+MzI8L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSI2NCI+NjQ8L29wdGlvbj4KICAgICAgPC9zZWxlY3Q+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9Im9wdC1ncm91cCI+CiAgICAgIDxzcGFuPlRhc3RpIFBDIGJpYW5jaGk6IDxjb2RlPkEgUyBEIEYgRyBIIEogfCBLIEwgOyAnPC9jb2RlPiDigJQgbmVyaTogPGNvZGU+VyBFJm5ic3A7IFQgWSBVJm5ic3A7IHwgTyBQJm5ic3A7IFs8L2NvZGU+PC9zcGFuPgogICAgPC9kaXY+CiAgPC9kaXY+CgogIDxkaXYgY2xhc3M9ImtiZC1zY3JvbGwiPgogICAgPGRpdiBjbGFzcz0ia2V5Ym9hcmQiIGlkPSJrZXlib2FyZCI+PC9kaXY+CiAgPC9kaXY+CgogIDxkaXYgY2xhc3M9ImFjdGl2ZS1ub3RlcyIgaWQ9ImFjdGl2ZU5vdGVzIj4KICAgIDxzcGFuIGNsYXNzPSJzbWFsbCIgc3R5bGU9ImNvbG9yOnZhcigtLW11dGVkKTsiPk5vdGUgYXR0aXZlOjwvc3Bhbj4KICAgIDxzcGFuIGNsYXNzPSJzbWFsbCIgaWQ9Im5vTm90ZXMiIHN0eWxlPSJjb2xvcjp2YXIoLS1tdXRlZCk7Ij7igJQ8L3NwYW4+CiAgPC9kaXY+CjwvZGl2PgoKPCEtLSBNQU5VQUwgVk9JQ0VTIC0tPgo8ZGl2IGNsYXNzPSJzZWN0aW9uLXRpdGxlIj7imqEgVm9jaSBNYW51YWxpICg4IG9zY2lsbGF0b3JpIGZpc3NpKTwvZGl2Pgo8c2VjdGlvbiBjbGFzcz0idm9pY2VzIiBpZD0idm9pY2VzIj48L3NlY3Rpb24+Cgo8ZGl2IGNsYXNzPSJmb290ZXItbm90ZSI+CiAg8J+SoSA8Yj5Qb2xpZm9uaWE6PC9iPiBvZ25pIHRhc3RvIGRlbGxhIHRhc3RpZXJhIGNyZWEgdW4gb3NjaWxsYXRvcmUgV2ViQXVkaW8gZGVkaWNhdG8gKGZpbm8gYWwgbWF4IHZvY2kgaW1wb3N0YXRvKS4gCiAgTGUgOCB2b2NpIHNvdHRvIHNvbm8gPGVtPm9zY2lsbGF0b3JpIG1hbnVhbGkgZmlzc2k8L2VtPiBwZXIgc291bmQgZGVzaWduLiAKICA8Yj5IT0xEPC9iPiBtYW50aWVuZSB0dXR0ZSBsZSBub3RlIGZpbmNow6kgbm9uIGxvIGRpc2F0dGl2aSBvIHByZW1pICJBbGwgTm90ZXMgT2ZmIi4gCiAgSWwgdGFzdG8gPHNwYW4gc3R5bGU9ImNvbG9yOnZhcigtLXB1cnBsZSk7Zm9udC13ZWlnaHQ6NzAwOyI+dmlvbGE8L3NwYW4+IHN1bGxhIHRhc3RpZXJhIMOoIEE1PTg4MEh6Lgo8L2Rpdj4KPC9kaXY+PCEtLSAvd3JhcCAtLT4KCjxzY3JpcHQ+CigoKT0+ewoidXNlIHN0cmljdCI7CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ09TVEFOVEkgRSBGUkVRVUVOWkUKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNvbnN0IE5PVEVfTkFNRVMgID0gWyJDIiwiQyMiLCJEIiwiRCMiLCJFIiwiRiIsIkYjIiwiRyIsIkcjIiwiQSIsIkEjIiwiQiJdOwpjb25zdCBOT1RFX1dOQU1FUyA9IFsiQyIsICJEIiwgIkUiLCAiRiIsICJHIiwgIkEiLCAiQiJdOwpjb25zdCBOT1RFX0JOQU1FUyA9IFsiQyMiLCJEIyIsbnVsbCwiRiMiLCJHIyIsIkEjIixudWxsXTsgLy8gbnVsbCA9IG5vIGJsYWNrIGtleSBiZXR3ZWVuIEUtRiBhbmQgQi1DCgovLyBBNSA9IE1JREkgODEgPSA4ODAgSHogKHJlZmVyZW56YSkKLy8gRm9ybXVsYTogZnJlcSA9IDQ0MCAqIDJeKChtaWRpLTY5KS8xMikKZnVuY3Rpb24gbWlkaVRvRnJlcShtaWRpKXsgcmV0dXJuIDQ0MCAqIE1hdGgucG93KDIsKG1pZGktNjkpLzEyKTsgfQpmdW5jdGlvbiBmcmVxVG9Ob3RlTmFtZShtaWRpKXsKICBjb25zdCBuID0gKChtaWRpJTEyKSsxMiklMTI7CiAgY29uc3Qgb2N0ID0gTWF0aC5mbG9vcihtaWRpLzEyKS0xOwogIHJldHVybiBOT1RFX05BTUVTW25dK29jdDsKfQoKLy8gQTUgPSBNSURJIDgxLiBDb3N0cnVpYW1vIGRhIEMyIChNSURJIDM2KSBhIEM4IChNSURJIDEwOCkKY29uc3QgTUlESV9TVEFSVCA9IDM2OyAvLyBDMgpjb25zdCBNSURJX0VORCAgID0gMTA4OyAvLyBDOApjb25zdCBBTkNIT1JfTUlESSA9IDgxOyAvLyBBNSA9IDg4MCBIegoKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIFBDIEtFWUJPQVJEIE1BUFBJTkcKLy8gTGF5b3V0OiAyIG90dGF2ZSBkaSB0YXN0aSB2aXNpYmlsaSBuZWxsYSBmaW5lc3RyYSBwcmluY2lwYWxlCi8vIGJpYW5jaGk6IEEgUyBEIEYgRyBIIEogfCBLIEwgOyAnICAoMTIgYmlhbmNoaSA9IDEuNyBvdHRhdmUpCi8vIG5lcmk6ICAgIFcgRSAgIFQgWSBVICAgfCBPIFAgICBbCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpjb25zdCBQQ19XSElURSA9IFsnYScsJ3MnLCdkJywnZicsJ2cnLCdoJywnaicsJ2snLCdsJywnOycsIiciLCd6JywneCcsJ2MnXTsKY29uc3QgUENfQkxBQ0sgPSBbJ3cnLCdlJywnJywndCcsJ3knLCd1JywnJywnbycsJ3AnLCcnLCdbJywnJywnJywnJ107CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gRE9NIFJFRlMKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNvbnN0ICQ9IGlkPT5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CmNvbnN0IHN0YXR1c0VsPSQoInN0YXR1cyIpLCBzZG90PSQoInNkb3QiKSwgc3JFbD0kKCJzciIpOwpjb25zdCBtaXhJbmZvRWw9JCgibWl4SW5mbyIpLCBwb2x5Q291bnRFbD0kKCJwb2x5Q291bnQiKTsKY29uc3QgbWFzdGVyRWw9JCgibWFzdGVyIiksIG1hc3RlclZhbEVsPSQoIm1hc3RlclZhbCIpOwpjb25zdCBsaW1pdGVyRWw9JCgibGltaXRlciIpLCBsaW1WYWxFbD0kKCJsaW1WYWwiKTsKY29uc3QgYXRrRWw9JCgiYXRrIiksIGRlY0VsPSQoImRlYyIpLCBzdXNFbD0kKCJzdXMiKSwgcmVsRWw9JCgicmVsIik7CmNvbnN0IGFWYWxFbD0kKCJhVmFsIiksIGRWYWxFbD0kKCJkVmFsIiksIHNWYWxFbD0kKCJzVmFsIiksIHJWYWxFbD0kKCJyVmFsIik7CmNvbnN0IGdEZXRFbD0kKCJnRGV0IiksIGdEZXRWYWxFbD0kKCJnRGV0VmFsIik7CmNvbnN0IGJ0blN0YXJ0PSQoImJ0blN0YXJ0IiksIGJ0blN0b3A9JCgiYnRuU3RvcCIpLCBidG5QYW5pYz0kKCJidG5QYW5pYyIpOwpjb25zdCBidG5Ib2xkPSQoImJ0bkhvbGQiKSwgYnRuSG9sZDI9JCgiYnRuSG9sZDIiKTsKY29uc3QgYnRuQWxsT2ZmPSQoImJ0bkFsbE9mZiIpLCBidG5BbGxPZmYyPSQoImJ0bkFsbE9mZjIiKTsKY29uc3QgcHJlc2V0Q2hvcmQ9JCgicHJlc2V0Q2hvcmQiKSwgcHJlc2V0SGFybT0kKCJwcmVzZXRIYXJtIik7CmNvbnN0IHNjb3BlQ2FudmFzPSQoInNjb3BlIiksIGN0eD1zY29wZUNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwpjb25zdCBmcHNFbD0kKCJmcHMiKSwgcm1zVmFsRWw9JCgicm1zVmFsIiksIHZ1RmlsbD0kKCJ2dUZpbGwiKTsKY29uc3Qgdm9pY2VzUm9vdD0kKCJ2b2ljZXMiKTsKY29uc3Qga2JkRWw9JCgia2V5Ym9hcmQiKTsKY29uc3Qga2JkV2F2ZT0kKCJrYmRXYXZlIiksIGtiZExldmVsPSQoImtiZExldmVsIiksIGtiZEx2bFZhbD0kKCJrYmRMdmxWYWwiKTsKY29uc3Qga2JkTWF4UG9seT0kKCJrYmRNYXhQb2x5Iik7CmNvbnN0IGFjdGl2ZU5vdGVzRWw9JCgiYWN0aXZlTm90ZXMiKSwgbm9Ob3Rlc0VsPSQoIm5vTm90ZXMiKTsKCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBTVEFUTwovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KbGV0IGFjPW51bGwsIG1hc3RlckdhaW49bnVsbCwgY29tcHJlc3Nvcj1udWxsLCBhbmFseXNlcj1udWxsOwpjb25zdCBzdGF0ZT17CiAgcnVubmluZzpmYWxzZSwKICBob2xkOmZhbHNlLAogIGFkc3I6e2E6LjAxMCxkOi4xMDAsczouNzUscjouMzAwfSwKICBnbG9iYWxEZXR1bmU6MAp9OwoKLy8gUG9saWZvbmlhIHRhc3RpZXJhOiBtaWRpIC0+IHtvc2MsIGdhaW5Ob2RlLCBwYW5uZXJ9CmNvbnN0IHBvbHlWb2ljZXMgPSBuZXcgTWFwKCk7IC8vIG1pZGkgLT4gdm9pY2Ugb2JqZWN0CgovLyA4IHZvY2kgbWFudWFsaSBmaXNzZQpjb25zdCBmaXhlZFZvaWNlcyA9IFtdOwpjb25zdCBNQVhfRklYRUQgPSA4OwoKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIEFVRElPIElOSVQKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmZ1bmN0aW9uIGVuc3VyZUF1ZGlvKCl7CiAgaWYoYWMpIHJldHVybjsKICBhYyA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dHx8d2luZG93LndlYmtpdEF1ZGlvQ29udGV4dCkoe2xhdGVuY3lIaW50OiJpbnRlcmFjdGl2ZSJ9KTsKICBtYXN0ZXJHYWluID0gYWMuY3JlYXRlR2FpbigpOwogIG1hc3RlckdhaW4uZ2Fpbi52YWx1ZSA9ICttYXN0ZXJFbC52YWx1ZTsKCiAgY29tcHJlc3NvciA9IGFjLmNyZWF0ZUR5bmFtaWNzQ29tcHJlc3NvcigpOwogIGNvbXByZXNzb3IudGhyZXNob2xkLnZhbHVlID0gK2xpbWl0ZXJFbC52YWx1ZTsKICBjb21wcmVzc29yLmtuZWUudmFsdWUgPSAxNjsKICBjb21wcmVzc29yLnJhdGlvLnZhbHVlID0gMTA7CiAgY29tcHJlc3Nvci5hdHRhY2sudmFsdWUgPSAwLjAwMjsKICBjb21wcmVzc29yLnJlbGVhc2UudmFsdWUgPSAwLjEwOwoKICBhbmFseXNlciA9IGFjLmNyZWF0ZUFuYWx5c2VyKCk7CiAgYW5hbHlzZXIuZmZ0U2l6ZSA9IDIwNDg7CiAgYW5hbHlzZXIuc21vb3RoaW5nVGltZUNvbnN0YW50ID0gMC44MDsKCiAgY29tcHJlc3Nvci5jb25uZWN0KG1hc3RlckdhaW4pOwogIG1hc3RlckdhaW4uY29ubmVjdChhbmFseXNlcik7CiAgYW5hbHlzZXIuY29ubmVjdChhYy5kZXN0aW5hdGlvbik7CgogIHNyRWwudGV4dENvbnRlbnQgPSBgIMK3ICR7TWF0aC5yb3VuZChhYy5zYW1wbGVSYXRlKX0gSHpgOwoKICAvLyBCdWlsZCA4IGZpeGVkIHZvaWNlcwogIGZvcihsZXQgaT0wO2k8TUFYX0ZJWEVEO2krKyl7CiAgICBjb25zdCBvc2MgPSBhYy5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICBvc2MudHlwZSA9ICJzaW5lIjsgb3NjLmZyZXF1ZW5jeS52YWx1ZT00NDA7IG9zYy5kZXR1bmUudmFsdWU9MDsKICAgIGNvbnN0IGcgPSBhYy5jcmVhdGVHYWluKCk7IGcuZ2Fpbi52YWx1ZT0wOwogICAgY29uc3QgcCA9IGFjLmNyZWF0ZVN0ZXJlb1Bhbm5lcigpOyBwLnBhbi52YWx1ZT0wOwogICAgb3NjLmNvbm5lY3QoZykuY29ubmVjdChwKS5jb25uZWN0KGNvbXByZXNzb3IpOwogICAgb3NjLnN0YXJ0KCk7CiAgICBmaXhlZFZvaWNlcy5wdXNoKHsKICAgICAgaWR4OmkrMSwgb3NjLCBnYWluOmcsIHBhbm5lcjpwLAogICAgICBwYXJhbXM6e29uOmZhbHNlLHNvbG86ZmFsc2UsbXV0ZTpmYWxzZSx3YXZlZm9ybToic2luZSIsZnJlcTo0NDAsZGV0dW5lOjAsbGV2ZWw6MC4yMCxwYW46MH0KICAgIH0pOwogIH0KICBidWlsZEZpeGVkVm9pY2VVSSgpOwogIGJ1aWxkS2V5Ym9hcmQoKTsgLy8gcmVidWlsZCB3aXRoIGF1ZGlvIHJlYWR5CiAgdXBkYXRlTWl4SW5mbygpOwp9CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gUE9MWSBOT1RFIE9OIC8gT0ZGCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpmdW5jdGlvbiBwb2x5Tm90ZU9uKG1pZGksIGZyZXEpewogIGlmKCFhYykgcmV0dXJuOwogIGlmKGFjLnN0YXRlPT09InN1c3BlbmRlZCIpIGFjLnJlc3VtZSgpOwogIGlmKHBvbHlWb2ljZXMuaGFzKG1pZGkpKSByZXR1cm47IC8vIGdpw6Agc3VvbmEKCiAgY29uc3QgbWF4UG9seSA9ICtrYmRNYXhQb2x5LnZhbHVlOwogIC8vIFN0ZWFsIG9sZGVzdCB2b2ljZSBpZiBhdCBsaW1pdAogIGlmKHBvbHlWb2ljZXMuc2l6ZSA+PSBtYXhQb2x5KXsKICAgIGNvbnN0IG9sZGVzdE1pZGkgPSBwb2x5Vm9pY2VzLmtleXMoKS5uZXh0KCkudmFsdWU7CiAgICBwb2x5Tm90ZU9mZihvbGRlc3RNaWRpLCB0cnVlKTsKICB9CgogIGNvbnN0IHQgPSBhYy5jdXJyZW50VGltZTsKICBjb25zdCB7YSxkLHN9ID0gc3RhdGUuYWRzcjsKICBjb25zdCBsZXZlbCA9ICtrYmRMZXZlbC52YWx1ZTsKCiAgY29uc3Qgb3NjID0gYWMuY3JlYXRlT3NjaWxsYXRvcigpOwogIG9zYy50eXBlID0ga2JkV2F2ZS52YWx1ZTsKICBvc2MuZnJlcXVlbmN5LnZhbHVlID0gZnJlcTsKICBvc2MuZGV0dW5lLnZhbHVlID0gc3RhdGUuZ2xvYmFsRGV0dW5lOwoKICBjb25zdCBnID0gYWMuY3JlYXRlR2FpbigpOwogIGcuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLCB0KTsKICBnLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUobGV2ZWwsIHQrYSk7CiAgZy5nYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKGxldmVsKnMsIHQrYStkKTsKCiAgY29uc3QgcGFuID0gYWMuY3JlYXRlU3RlcmVvUGFubmVyKCk7CiAgcGFuLnBhbi52YWx1ZSA9IDA7CgogIG9zYy5jb25uZWN0KGcpLmNvbm5lY3QocGFuKS5jb25uZWN0KGNvbXByZXNzb3IpOwogIG9zYy5zdGFydCh0KTsKCiAgcG9seVZvaWNlcy5zZXQobWlkaSwge29zYywgZ2FpbjpnLCBwYW5uZXI6cGFuLCBmcmVxLCBzdGFydFRpbWU6dH0pOwoKICAvLyBWaXN1YWwKICBtYXJrS2V5KG1pZGksIHRydWUpOwogIHVwZGF0ZUFjdGl2ZU5vdGVzVUkoKTsKICB1cGRhdGVQb2x5Q291bnQoKTsKICB1cGRhdGVNaXhJbmZvKCk7Cn0KCmZ1bmN0aW9uIHBvbHlOb3RlT2ZmKG1pZGksIGltbWVkaWF0ZT1mYWxzZSl7CiAgY29uc3QgdiA9IHBvbHlWb2ljZXMuZ2V0KG1pZGkpOwogIGlmKCF2KSByZXR1cm47CgogIGNvbnN0IHQgPSBhYy5jdXJyZW50VGltZTsKICBjb25zdCByID0gaW1tZWRpYXRlID8gMC4wMSA6IHN0YXRlLmFkc3IucjsKCiAgdi5nYWluLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpOwogIHYuZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHYuZ2Fpbi5nYWluLnZhbHVlLCB0KTsKICB2LmdhaW4uZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgwLCB0K3IpOwoKICAvLyBTdG9wIGFuZCBkaXNjb25uZWN0IGFmdGVyIHJlbGVhc2UKICBjb25zdCBzdG9wVGltZSA9IHQgKyByICsgMC4wNTsKICB2Lm9zYy5zdG9wKHN0b3BUaW1lKTsKICBzZXRUaW1lb3V0KCgpPT57CiAgICB0cnl7di5nYWluLmRpc2Nvbm5lY3QoKTt2LnBhbm5lci5kaXNjb25uZWN0KCk7fWNhdGNoKGUpe30KICB9LCAociswLjEpKjEwMDApOwoKICBwb2x5Vm9pY2VzLmRlbGV0ZShtaWRpKTsKICBtYXJrS2V5KG1pZGksIGZhbHNlKTsKICB1cGRhdGVBY3RpdmVOb3Rlc1VJKCk7CiAgdXBkYXRlUG9seUNvdW50KCk7CiAgdXBkYXRlTWl4SW5mbygpOwp9CgpmdW5jdGlvbiBhbGxOb3Rlc09mZigpewogIGNvbnN0IG1pZGlMaXN0ID0gWy4uLnBvbHlWb2ljZXMua2V5cygpXTsKICBtaWRpTGlzdC5mb3JFYWNoKG1pZGkgPT4gcG9seU5vdGVPZmYobWlkaSkpOwogIHVwZGF0ZUFjdGl2ZU5vdGVzVUkoKTsKICB1cGRhdGVQb2x5Q291bnQoKTsKfQoKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIEtFWUJPQVJEIEJVSUxECi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBMYXlvdXQ6IGRhIEMyIChNSURJIDM2KSBhIEI3IChNSURJIDEwNykKLy8gVGFzdGkgYmlhbmNoaTogb2duaSBDIEQgRSBGIEcgQSBCCi8vIE5lcmk6IHRyYSBpIGJpYW5jaGkgZ2l1c3RpCgpjb25zdCBrZXlFbHMgPSBuZXcgTWFwKCk7IC8vIG1pZGkgLT4gZWxlbWVudApsZXQgcGNLZXlUb01pZGkgPSBuZXcgTWFwKCk7CgpmdW5jdGlvbiBidWlsZEtleWJvYXJkKCl7CiAga2JkRWwuaW5uZXJIVE1MID0gIiI7CiAga2V5RWxzLmNsZWFyKCk7CiAgcGNLZXlUb01pZGkuY2xlYXIoKTsKCiAgLy8gQ2FsY29sYSBsYXlvdXQ6IHByaW1hIG1ldHRpIGkgYmlhbmNoaSwgcG9pIG92ZXJsYXkgZGVpIG5lcmkKICAvLyBTdHJhdGVnaWE6IGNvc3RydWlhbW8gdW4gYXJyYXkgZGkgKG1pZGksIGlzQmxhY2ssIHdoaXRlSW5kZXgpCiAgY29uc3QgbGF5b3V0ID0gW107CiAgbGV0IHdoaXRlQ291bnQgPSAwOwogIGZvcihsZXQgbWlkaSA9IE1JRElfU1RBUlQ7IG1pZGkgPD0gTUlESV9FTkQ7IG1pZGkrKyl7CiAgICBjb25zdCBzZW1pdG9uZSA9ICgobWlkaSUxMikrMTIpJTEyOwogICAgY29uc3QgaXNCbGFjayA9IFsxLDMsNiw4LDEwXS5pbmNsdWRlcyhzZW1pdG9uZSk7CiAgICBsYXlvdXQucHVzaCh7bWlkaSwgaXNCbGFjaywgd2hpdGVJbmRleDogaXNCbGFjayA/IC0xIDogd2hpdGVDb3VudH0pOwogICAgaWYoIWlzQmxhY2spIHdoaXRlQ291bnQrKzsKICB9CgogIC8vIFBpYW5vIGNvbnRhaW5lcjogbGFyZ2hlenphIHRvdGFsZSA9IHdoaXRlQ291bnQgKiAoMzgrMnB4IGdhcCkKICBjb25zdCBXID0gNDA7IC8vIHdoaXRlIGtleSB3aWR0aCArIGdhcAogIGNvbnN0IEJXID0gMjQsIEJIID0gODQ7IC8vIGJsYWNrIGtleQogIGtiZEVsLnN0eWxlLndpZHRoID0gKHdoaXRlQ291bnQgKiBXKSArICJweCI7CiAga2JkRWwuc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOwoKICAvLyBNYXAgZGkgd2hpdGVJbmRleCAtPiB4IHBvc2l0aW9uCiAgY29uc3Qgd2hpdGVYID0gW107IC8vIHdoaXRlWFtpXSA9IHBpeGVsIHggb2YgaS10aCB3aGl0ZSBrZXkKICBmb3IobGV0IGk9MDtpPHdoaXRlQ291bnQ7aSsrKSB3aGl0ZVhbaV0gPSBpKlc7CgogIC8vIFdoaXRlIGtleXMgZmlyc3QKICBsYXlvdXQuZmlsdGVyKGs9PiFrLmlzQmxhY2spLmZvckVhY2goaz0+ewogICAgY29uc3Qgbm90ZU5hbWUgPSBmcmVxVG9Ob3RlTmFtZShrLm1pZGkpOwogICAgY29uc3QgZnJlcSA9IG1pZGlUb0ZyZXEoay5taWRpKTsKICAgIGNvbnN0IGlzQW5jaG9yID0gKGsubWlkaSA9PT0gQU5DSE9SX01JREkpOwoKICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgZGl2LmNsYXNzTmFtZSA9ICJrdyIgKyAoaXNBbmNob3I/IiBhbmNob3IiOiIiKTsKICAgIGRpdi5zdHlsZS5jc3NUZXh0ID0gYHBvc2l0aW9uOmFic29sdXRlO2xlZnQ6JHt3aGl0ZVhbay53aGl0ZUluZGV4XX1weDt0b3A6MDtgOwogICAgZGl2LmRhdGFzZXQubWlkaSA9IGsubWlkaTsKICAgIGRpdi5pbm5lckhUTUwgPSBgCiAgICAgIDxkaXYgY2xhc3M9ImtwYyIgaWQ9ImtwY18ke2subWlkaX0iPjwvZGl2PgogICAgICA8c3BhbiBjbGFzcz0ia25hbWUiPiR7bm90ZU5hbWV9PC9zcGFuPgogICAgICA8c3BhbiBjbGFzcz0ia2ZyZXEiPiR7TWF0aC5yb3VuZChmcmVxKX1Iejwvc3Bhbj4KICAgIGA7CiAgICBrYmRFbC5hcHBlbmRDaGlsZChkaXYpOwogICAga2V5RWxzLnNldChrLm1pZGksIGRpdik7CiAgICBiaW5kS2V5RWwoZGl2LCBrLm1pZGksIGZyZXEpOwogIH0pOwoKICAvLyBCbGFjayBrZXlzIG92ZXJsYXkKICAvLyBGb3IgZWFjaCB3aGl0ZSBrZXksIGNoZWNrIGlmIHRoZXJlJ3MgYSBibGFjayBrZXkgdG8gaXRzIHJpZ2h0CiAgLy8gQmxhY2sga2V5IHNpdHMgYXQ6IHdoaXRlWFtpXSArIFcgLSBCVy8yICsgMQogIGxheW91dC5maWx0ZXIoaz0+ay5pc0JsYWNrKS5mb3JFYWNoKGs9PnsKICAgIC8vIGZpbmQgdGhlIHdoaXRlIGtleSBqdXN0IGJlbG93IChsb3dlciBtaWRpKQogICAgY29uc3QgcHJldldoaXRlID0gbGF5b3V0LmZpbHRlcih3PT4hdy5pc0JsYWNrICYmIHcubWlkaSA8IGsubWlkaSkucG9wKCk7CiAgICBpZighcHJldldoaXRlKSByZXR1cm47CiAgICBjb25zdCB4ID0gd2hpdGVYW3ByZXZXaGl0ZS53aGl0ZUluZGV4XSArIFcgLSBNYXRoLmZsb29yKEJXLzIpICsgMTsKCiAgICBjb25zdCBub3RlTmFtZSA9IGZyZXFUb05vdGVOYW1lKGsubWlkaSk7CiAgICBjb25zdCBmcmVxID0gbWlkaVRvRnJlcShrLm1pZGkpOwoKICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgZGl2LmNsYXNzTmFtZSA9ICJrYiI7CiAgICBkaXYuc3R5bGUuY3NzVGV4dCA9IGBsZWZ0OiR7eH1weDtgOwogICAgZGl2LmRhdGFzZXQubWlkaSA9IGsubWlkaTsKICAgIGRpdi5pbm5lckhUTUwgPSBgCiAgICAgIDxkaXYgY2xhc3M9ImtwYyIgaWQ9ImtwY18ke2subWlkaX0iPjwvZGl2PgogICAgICA8c3BhbiBjbGFzcz0ia25hbWUiPiR7bm90ZU5hbWV9PC9zcGFuPgogICAgICA8c3BhbiBjbGFzcz0ia2ZyZXEiPiR7TWF0aC5yb3VuZChmcmVxKX1Iejwvc3Bhbj4KICAgIGA7CiAgICBrYmRFbC5hcHBlbmRDaGlsZChkaXYpOwogICAga2V5RWxzLnNldChrLm1pZGksIGRpdik7CiAgICBiaW5kS2V5RWwoZGl2LCBrLm1pZGksIGZyZXEpOwogIH0pOwoKICAvLyBBc3NpZ24gUEMga2V5IGxhYmVscyDigJQgY2VudGVyIGFyb3VuZCBBNSAoTUlESSA4MSkKICAvLyBHZXQgd2hpdGUga2V5cyBuZWFyIEE1CiAgY29uc3QgYW5jaG9yV2hpdGVJZHggPSBsYXlvdXQuZmluZChrPT5rLm1pZGk9PT1BTkNIT1JfTUlESSk/LndoaXRlSW5kZXggPz8gMDsKICAvLyBNYXAgd2hpdGUga2V5cyBzdGFydGluZyB+NyBiZWZvcmUgYW5jaG9yCiAgY29uc3Qgd2hpdGVMYXlvdXQgPSBsYXlvdXQuZmlsdGVyKGs9PiFrLmlzQmxhY2spOwogIGNvbnN0IGFuY2hvcldoaXRlUG9zID0gd2hpdGVMYXlvdXQuZmluZEluZGV4KGs9PmsubWlkaT09PUFOQ0hPUl9NSURJKTsKICBjb25zdCBzdGFydFdoaXRlUG9zID0gTWF0aC5tYXgoMCwgYW5jaG9yV2hpdGVQb3MgLSA1KTsgLy8gQSBpcyB0aGUgNnRoIHdoaXRlIGtleSBpbiB0aGUgdmlzaWJsZSByYW5nZQoKICBQQ19XSElURS5mb3JFYWNoKChwY2ssIGkpID0+IHsKICAgIGlmKCFwY2spIHJldHVybjsKICAgIGNvbnN0IHdrID0gd2hpdGVMYXlvdXRbc3RhcnRXaGl0ZVBvcyArIGldOwogICAgaWYoIXdrKSByZXR1cm47CiAgICBwY0tleVRvTWlkaS5zZXQocGNrLCB3ay5taWRpKTsKICAgIGNvbnN0IGxibCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBrcGNfJHt3ay5taWRpfWApOwogICAgaWYobGJsKSBsYmwudGV4dENvbnRlbnQgPSBwY2sudG9VcHBlckNhc2UoKTsKICB9KTsKCiAgLy8gQmxhY2sga2V5cyBuZWFyIHNhbWUgcmFuZ2UKICBjb25zdCBibGFja0xheW91dCA9IGxheW91dC5maWx0ZXIoaz0+ay5pc0JsYWNrKTsKICAvLyBmaW5kIGJsYWNrIGtleXMgdGhhdCBjb3JyZXNwb25kIHRvIHRoZSB3aGl0ZSBrZXkgcmFuZ2UKICBsZXQgYklkeCA9IDA7CiAgUENfQkxBQ0suZm9yRWFjaCgocGNrLCBpKSA9PiB7CiAgICAvLyBpLXRoIHBvc2l0aW9uIG1hdGNoZXMgd2hpdGUga2V5IGkgaW4gcmFuZ2UKICAgIGlmKCFwY2spIHJldHVybjsKICAgIGNvbnN0IHdrID0gd2hpdGVMYXlvdXRbc3RhcnRXaGl0ZVBvcyArIGldOwogICAgaWYoIXdrKSByZXR1cm47CiAgICAvLyBmaW5kIGJsYWNrIGtleSB3aG9zZSBwcmV2IHdoaXRlIGlzIHRoaXMgd2hpdGUKICAgIGNvbnN0IGJrID0gbGF5b3V0LmZpbmQoaz0+ay5pc0JsYWNrICYmIGsubWlkaT09PXdrLm1pZGkrMSB8fCBrLm1pZGk9PT13ay5taWRpKzIpOwogICAgLy8gTW9yZSBwcmVjaXNlOiBmaW5kIGJsYWNrIGtleSBqdXN0IGFmdGVyIHRoaXMgd2hpdGUga2V5CiAgICBjb25zdCBia0V4YWN0ID0gbGF5b3V0LmZpbmQoaz0+IGsuaXNCbGFjayAmJiBrLm1pZGkgPiB3ay5taWRpICYmIAogICAgICAhbGF5b3V0LmZpbmQodz0+IXcuaXNCbGFjayAmJiB3Lm1pZGkgPiB3ay5taWRpICYmIHcubWlkaSA8IGsubWlkaSkpOwogICAgaWYoYmtFeGFjdCl7CiAgICAgIHBjS2V5VG9NaWRpLnNldChwY2ssIGJrRXhhY3QubWlkaSk7CiAgICAgIGNvbnN0IGxibCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBrcGNfJHtia0V4YWN0Lm1pZGl9YCk7CiAgICAgIGlmKGxibCkgbGJsLnRleHRDb250ZW50ID0gcGNrLnRvVXBwZXJDYXNlKCk7CiAgICB9CiAgfSk7CgogIC8vIEF1dG8tc2Nyb2xsIHRvIEE1CiAgc2V0VGltZW91dCgoKT0+ewogICAgY29uc3QgYW5jaG9yRWwgPSBrZXlFbHMuZ2V0KEFOQ0hPUl9NSURJKTsKICAgIGlmKGFuY2hvckVsKXsKICAgICAgY29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmtiZC1zY3JvbGwiKTsKICAgICAgY29uc3Qga2V5TGVmdCA9IHBhcnNlSW50KGFuY2hvckVsLnN0eWxlLmxlZnR8fCIwIik7CiAgICAgIGNvbnN0IGNvbnRhaW5lclcgPSBzY3JvbGxDb250YWluZXIuY2xpZW50V2lkdGg7CiAgICAgIHNjcm9sbENvbnRhaW5lci5zY3JvbGxMZWZ0ID0gTWF0aC5tYXgoMCwga2V5TGVmdCAtIGNvbnRhaW5lclcvMiArIDIwKTsKICAgIH0KICB9LCAxMDApOwp9CgpmdW5jdGlvbiBiaW5kS2V5RWwoZGl2LCBtaWRpLCBmcmVxKXsKICBkaXYuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIiwgZT0+eyBlLnByZXZlbnREZWZhdWx0KCk7IG5vdGVPbihtaWRpLGZyZXEpOyB9KTsKICBkaXYuYWRkRXZlbnRMaXN0ZW5lcigibW91c2VlbnRlciIsIGU9PnsgaWYoZS5idXR0b25zPT09MSkgbm90ZU9uKG1pZGksZnJlcSk7IH0pOwogIGRpdi5hZGRFdmVudExpc3RlbmVyKCJtb3VzZXVwIiwgKCk9PnsgaWYoIXN0YXRlLmhvbGQpIG5vdGVPZmYobWlkaSk7IH0pOwogIGRpdi5hZGRFdmVudExpc3RlbmVyKCJtb3VzZWxlYXZlIiwgKCk9PnsgaWYoIXN0YXRlLmhvbGQpIG5vdGVPZmYobWlkaSk7IH0pOwogIGRpdi5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0IiwgZT0+eyBlLnByZXZlbnREZWZhdWx0KCk7IG5vdGVPbihtaWRpLGZyZXEpOyB9LHtwYXNzaXZlOmZhbHNlfSk7CiAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNoZW5kIiwgKCk9PnsgaWYoIXN0YXRlLmhvbGQpIG5vdGVPZmYobWlkaSk7IH0pOwogIGRpdi5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaGNhbmNlbCIsICgpPT57IGlmKCFzdGF0ZS5ob2xkKSBub3RlT2ZmKG1pZGkpOyB9KTsKfQoKZnVuY3Rpb24gbm90ZU9uKG1pZGksIGZyZXEpewogIGVuc3VyZUF1ZGlvKCk7CiAgcG9seU5vdGVPbihtaWRpLCBmcmVxKTsKfQpmdW5jdGlvbiBub3RlT2ZmKG1pZGkpewogIGlmKCFzdGF0ZS5ob2xkKSBwb2x5Tm90ZU9mZihtaWRpKTsKfQoKZnVuY3Rpb24gbWFya0tleShtaWRpLCBvbil7CiAgY29uc3QgZWwgPSBrZXlFbHMuZ2V0KG1pZGkpOwogIGlmKGVsKSBlbC5jbGFzc0xpc3QudG9nZ2xlKCJwcmVzc2VkIiwgb24pOwp9CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gUEMgS0VZQk9BUkQKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNvbnN0IHByZXNzZWRQQyA9IG5ldyBTZXQoKTsKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIGU9PnsKICBpZihlLnRhcmdldC50YWdOYW1lPT09IklOUFVUInx8ZS50YXJnZXQudGFnTmFtZT09PSJTRUxFQ1QiKSByZXR1cm47CiAgaWYoZS5yZXBlYXQpIHJldHVybjsKICBjb25zdCBrID0gZS5rZXkudG9Mb3dlckNhc2UoKTsKICBpZihwcmVzc2VkUEMuaGFzKGspKSByZXR1cm47CiAgcHJlc3NlZFBDLmFkZChrKTsKICBjb25zdCBtaWRpID0gcGNLZXlUb01pZGkuZ2V0KGspOwogIGlmKG1pZGkhPT11bmRlZmluZWQpewogICAgY29uc3QgZnJlcSA9IG1pZGlUb0ZyZXEobWlkaSk7CiAgICBub3RlT24obWlkaSwgZnJlcSk7CiAgfQogIC8vIEhvbGQgdG9nZ2xlID0gSCBrZXkgKHdoZW4gbm90IGluIGlucHV0KQogIGlmKGs9PT0iaCIgJiYgIXBjS2V5VG9NaWRpLmhhcygiaCIpKSB0b2dnbGVIb2xkKCk7Cn0pOwpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJrZXl1cCIsIGU9PnsKICBjb25zdCBrID0gZS5rZXkudG9Mb3dlckNhc2UoKTsKICBwcmVzc2VkUEMuZGVsZXRlKGspOwogIGNvbnN0IG1pZGkgPSBwY0tleVRvTWlkaS5nZXQoayk7CiAgaWYobWlkaSE9PXVuZGVmaW5lZCAmJiAhc3RhdGUuaG9sZCkgbm90ZU9mZihtaWRpKTsKfSk7CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gSE9MRAovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KZnVuY3Rpb24gdG9nZ2xlSG9sZChmb3JjZVRvKXsKICBzdGF0ZS5ob2xkID0gKGZvcmNlVG8hPT11bmRlZmluZWQpID8gZm9yY2VUbyA6ICFzdGF0ZS5ob2xkOwogIGNvbnN0IGxhYmVsID0gc3RhdGUuaG9sZCA/ICLwn5SSIEhPTEQ6IE9OIiA6ICLwn5SSIEhPTEQ6IE9GRiI7CiAgYnRuSG9sZC50ZXh0Q29udGVudD1sYWJlbDsgYnRuSG9sZDIudGV4dENvbnRlbnQ9bGFiZWw7CiAgW2J0bkhvbGQsIGJ0bkhvbGQyXS5mb3JFYWNoKGI9PnsKICAgIGIuY2xhc3NMaXN0LnRvZ2dsZSgiaG9sZC1hY3RpdmUiLCBzdGF0ZS5ob2xkKTsKICAgIGIuY2xhc3NMaXN0LnRvZ2dsZSgid2FybiIsICFzdGF0ZS5ob2xkKTsKICB9KTsKICBpZighc3RhdGUuaG9sZCkgYWxsTm90ZXNPZmYoKTsKfQpidG5Ib2xkLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+dG9nZ2xlSG9sZCgpKTsKYnRuSG9sZDIuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCgpPT50b2dnbGVIb2xkKCkpOwpidG5BbGxPZmYuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCgpPT5hbGxOb3Rlc09mZigpKTsKYnRuQWxsT2ZmMi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9PmFsbE5vdGVzT2ZmKCkpOwoKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIEFDVElWRSBOT1RFUyBESVNQTEFZCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpmdW5jdGlvbiB1cGRhdGVBY3RpdmVOb3Rlc1VJKCl7CiAgLy8gUmVtb3ZlIG9sZCBjaGlwcwogIGNvbnN0IGNoaXBzID0gYWN0aXZlTm90ZXNFbC5xdWVyeVNlbGVjdG9yQWxsKCIubm90ZS1jaGlwIik7CiAgY2hpcHMuZm9yRWFjaChjPT5jLnJlbW92ZSgpKTsKICBub05vdGVzRWwuc3R5bGUuZGlzcGxheSA9IHBvbHlWb2ljZXMuc2l6ZT09PTAgPyAiIiA6ICJub25lIjsKCiAgcG9seVZvaWNlcy5mb3JFYWNoKCh2LG1pZGkpPT57CiAgICBjb25zdCBjaGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpOwogICAgY2hpcC5jbGFzc05hbWUgPSAibm90ZS1jaGlwIjsKICAgIGNoaXAuaW5uZXJIVE1MID0gYCR7ZnJlcVRvTm90ZU5hbWUobWlkaSl9IDxzcGFuIGNsYXNzPSJuaHoiPiR7TWF0aC5yb3VuZCh2LmZyZXEpfUh6PC9zcGFuPmA7CiAgICBhY3RpdmVOb3Rlc0VsLmFwcGVuZENoaWxkKGNoaXApOwogIH0pOwp9CgpmdW5jdGlvbiB1cGRhdGVQb2x5Q291bnQoKXsKICBwb2x5Q291bnRFbC50ZXh0Q29udGVudCA9IHBvbHlWb2ljZXMuc2l6ZTsKfQoKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIE1JWCBJTkZPCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpmdW5jdGlvbiB1cGRhdGVNaXhJbmZvKCl7CiAgY29uc3QgYW55U29sbyA9IGZpeGVkVm9pY2VzLnNvbWUodj0+di5wYXJhbXMuc29sbyk7CiAgbGV0IHN1bT0wLCBhY3RpdmU9MDsKICBmaXhlZFZvaWNlcy5mb3JFYWNoKHY9PnsKICAgIGNvbnN0IHBhc3M9KCFhbnlTb2xvfHx2LnBhcmFtcy5zb2xvKSYmdi5wYXJhbXMub24mJiF2LnBhcmFtcy5tdXRlOwogICAgaWYocGFzcyl7c3VtKz12LnBhcmFtcy5sZXZlbDthY3RpdmUrKzt9CiAgfSk7CiAgY29uc3QgcG9seVN1bSA9IHBvbHlWb2ljZXMuc2l6ZSAqICgra2JkTGV2ZWwudmFsdWUpOwogIGNvbnN0IHRvdGFsID0gc3VtICsgcG9seVN1bTsKICBtaXhJbmZvRWwudGV4dENvbnRlbnQgPSBgZml4ZWQgJHthY3RpdmV9LzggwrcgcG9seSAke3BvbHlWb2ljZXMuc2l6ZX0gwrcgcGVha+KJiCR7dG90YWwudG9GaXhlZCgyKX1gOwogIHZ1RmlsbC5zdHlsZS53aWR0aCA9IGAke01hdGgubWluKDEwMCwgdG90YWwqNTUpfSVgOwp9CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gRklYRUQgVk9JQ0UgRU5WRUxPUEUKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmZ1bmN0aW9uIGZpeGVkTm93KCl7IHJldHVybiBhYyA/IGFjLmN1cnJlbnRUaW1lIDogMDsgfQoKZnVuY3Rpb24gYXBwbHlGaXhlZFZvaWNlKHYpewogIHYub3NjLnR5cGUgPSB2LnBhcmFtcy53YXZlZm9ybTsKICB2Lm9zYy5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUodi5wYXJhbXMuZnJlcSwgZml4ZWROb3coKSk7CiAgdi5vc2MuZGV0dW5lLnNldFZhbHVlQXRUaW1lKHYucGFyYW1zLmRldHVuZStzdGF0ZS5nbG9iYWxEZXR1bmUsIGZpeGVkTm93KCkpOwogIHYucGFubmVyLnBhbi5zZXRWYWx1ZUF0VGltZSh2LnBhcmFtcy5wYW4sIGZpeGVkTm93KCkpOwp9CgpmdW5jdGlvbiBmaXhlZFZvaWNlVGFyZ2V0KHYpewogIGNvbnN0IGFueVNvbG8gPSBmaXhlZFZvaWNlcy5zb21lKHg9PngucGFyYW1zLnNvbG8pOwogIGlmKGFueVNvbG8mJiF2LnBhcmFtcy5zb2xvKSByZXR1cm4gMDsKICBpZighdi5wYXJhbXMub258fHYucGFyYW1zLm11dGUpIHJldHVybiAwOwogIHJldHVybiB2LnBhcmFtcy5sZXZlbDsKfQoKZnVuY3Rpb24gZml4ZWRFbnZPbih2KXsKICBjb25zdCB0PWZpeGVkTm93KCksIHthLGQsc309c3RhdGUuYWRzcjsKICBjb25zdCB0Z3Q9Zml4ZWRWb2ljZVRhcmdldCh2KTsKICB2LmdhaW4uZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModCk7CiAgdi5nYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodi5nYWluLmdhaW4udmFsdWUsdCk7CiAgdi5nYWluLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodGd0LHQrYSk7CiAgdi5nYWluLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodGd0KnMsdCthK2QpOwp9CmZ1bmN0aW9uIGZpeGVkRW52T2ZmKHYpewogIGNvbnN0IHQ9Zml4ZWROb3coKSwgcj1zdGF0ZS5hZHNyLnI7CiAgdi5nYWluLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpOwogIHYuZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHYuZ2Fpbi5nYWluLnZhbHVlLHQpOwogIHYuZ2Fpbi5nYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDAsdCtyKTsKfQpmdW5jdGlvbiByZWZyZXNoRml4ZWQoKXsKICBpZighYWMpIHJldHVybjsKICBmaXhlZFZvaWNlcy5mb3JFYWNoKHY9PnsKICAgIGFwcGx5Rml4ZWRWb2ljZSh2KTsKICAgIGNvbnN0IHRndD1maXhlZFZvaWNlVGFyZ2V0KHYpOwogICAgY29uc3QgdD1maXhlZE5vdygpOwogICAgdi5nYWluLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpOwogICAgdi5nYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodi5nYWluLmdhaW4udmFsdWUsdCk7CiAgICB2LmdhaW4uZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0Z3Qqc3RhdGUuYWRzci5zLHQrMC4wMyk7CiAgfSk7CiAgdXBkYXRlTWl4SW5mbygpOwp9CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gRklYRUQgVk9JQ0UgVUkKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmZ1bmN0aW9uIG5vdGVOYW1lRm9yVm9pY2Uodil7IHJldHVybiBmcmVxVG9Ob3RlTmFtZShNYXRoLnJvdW5kKDY5KzEyKk1hdGgubG9nMih2LnBhcmFtcy5mcmVxLzQ0MCkpKTsgfQoKZnVuY3Rpb24gc3luY0ZpeGVkVUkodil7CiAgY29uc3Qgb25CdG49JChgdk9uXyR7di5pZHh9YCksIG11dGVCdG49JChgdk11dGVfJHt2LmlkeH1gKSwgc29sb0J0bj0kKGB2U29sb18ke3YuaWR4fWApOwogIGNvbnN0IGluZm89JChgdkluZm9fJHt2LmlkeH1gKSwgY2FyZD0kKGB2Q2FyZF8ke3YuaWR4fWApOwogIGlmKG9uQnRuKXtvbkJ0bi5jbGFzc0xpc3QudG9nZ2xlKCJvbiIsdi5wYXJhbXMub24pO29uQnRuLnRleHRDb250ZW50PXYucGFyYW1zLm9uPyJPTiI6Ik9GRiI7fQogIGlmKG11dGVCdG4pIG11dGVCdG4uY2xhc3NMaXN0LnRvZ2dsZSgib24iLHYucGFyYW1zLm11dGUpOwogIGlmKHNvbG9CdG4pIHNvbG9CdG4uY2xhc3NMaXN0LnRvZ2dsZSgib24iLHYucGFyYW1zLnNvbG8pOwogIGlmKGNhcmQpIGNhcmQuY2xhc3NMaXN0LnRvZ2dsZSgia2JkLWFjdGl2ZSIsdi5wYXJhbXMub24mJiF2LnBhcmFtcy5tdXRlKTsKICBjb25zdCBubiA9IG5vdGVOYW1lRm9yVm9pY2Uodik7CiAgaWYoaW5mbykgaW5mby5pbm5lckhUTUwgPSBgJHtNYXRoLnJvdW5kKHYucGFyYW1zLmZyZXEpfSBIeiA8c3BhbiBjbGFzcz0ibnRhZyI+JHtubn08L3NwYW4+IMK3IGdhaW4gJHt2LnBhcmFtcy5sZXZlbC50b0ZpeGVkKDIpfSDCtyBwYW4gJHt2LnBhcmFtcy5wYW4udG9GaXhlZCgyKX1gOwogIFsnV2F2ZUxibCcsJ0ZyZXFMYmwnLCdMdmxMYmwnLCdEZXRMYmwnLCdQYW5MYmwnXS5mb3JFYWNoKGlkPT57CiAgICBjb25zdCBlbF89JChgdiR7aWR9XyR7di5pZHh9YCk7CiAgICBpZighZWxfKSByZXR1cm47CiAgICBpZihpZD09PSdXYXZlTGJsJykgZWxfLnRleHRDb250ZW50PXYucGFyYW1zLndhdmVmb3JtOwogICAgaWYoaWQ9PT0nRnJlcUxibCcpIGVsXy50ZXh0Q29udGVudD1gJHtNYXRoLnJvdW5kKHYucGFyYW1zLmZyZXEpfSBIemA7CiAgICBpZihpZD09PSdMdmxMYmwnKSBlbF8udGV4dENvbnRlbnQ9di5wYXJhbXMubGV2ZWwudG9GaXhlZCgyKTsKICAgIGlmKGlkPT09J0RldExibCcpIGVsXy50ZXh0Q29udGVudD1gJHt2LnBhcmFtcy5kZXR1bmV8MH0gwqJgOwogICAgaWYoaWQ9PT0nUGFuTGJsJykgZWxfLnRleHRDb250ZW50PXYucGFyYW1zLnBhbi50b0ZpeGVkKDIpOwogIH0pOwogIGNvbnN0IGZyPSQoYHZGcmVxUl8ke3YuaWR4fWApOyBpZihmcikgZnIudmFsdWU9U3RyaW5nKE1hdGgubWluKDIwMDAsTWF0aC5tYXgoMjAsdi5wYXJhbXMuZnJlcSkpKTsKICBjb25zdCBmbj0kKGB2RnJlcU5fJHt2LmlkeH1gKTsgaWYoZm4pIGZuLnZhbHVlPVN0cmluZyhNYXRoLnJvdW5kKHYucGFyYW1zLmZyZXEpKTsKICBjb25zdCB3cz0kKGB2V2F2ZV8ke3YuaWR4fWApOyBpZih3cykgd3MudmFsdWU9di5wYXJhbXMud2F2ZWZvcm07CiAgY29uc3QgbHI9JChgdkx2bF8ke3YuaWR4fWApOyBpZihscikgbHIudmFsdWU9U3RyaW5nKHYucGFyYW1zLmxldmVsKTsKfQoKZnVuY3Rpb24gYnVpbGRGaXhlZFZvaWNlVUkoKXsKICB2b2ljZXNSb290LmlubmVySFRNTD0iIjsKICBjb25zdCBjb2xvcnM9WycjNGVhMWZmJywnIzZhZjBjMicsJyNjMDdhZmYnLCcjZmZjYzY2JywnI2ZmNWM3YScsJyM0YmYwOGEnLCcjZmY5ZjQzJywnIzU0YTBmZiddOwogIGZpeGVkVm9pY2VzLmZvckVhY2godj0+ewogICAgY29uc3QgYz1jb2xvcnNbKHYuaWR4LTEpJWNvbG9ycy5sZW5ndGhdOwogICAgY29uc3QgY2FyZD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIGNhcmQuY2xhc3NOYW1lPSJjYXJkIHZvaWNlIjsKICAgIGNhcmQuaWQ9YHZDYXJkXyR7di5pZHh9YDsKICAgIGNhcmQuaW5uZXJIVE1MPWAKICAgICAgPGRpdiBjbGFzcz0idmhlYWQiPgogICAgICAgIDxkaXYgY2xhc3M9InZsZWZ0Ij4KICAgICAgICAgIDxkaXYgY2xhc3M9ImJhZGdlIiBzdHlsZT0iY29sb3I6JHtjfTtib3JkZXItY29sb3I6JHtjfTMwOyI+JHt2LmlkeH08L2Rpdj4KICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InZuYW1lIj5Wb2ljZSAke3YuaWR4fTwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ2aW5mbyBtb25vIiBpZD0idkluZm9fJHt2LmlkeH0iPjQ0MCBIeiA8c3BhbiBjbGFzcz0ibnRhZyI+QTQ8L3NwYW4+IMK3IGdhaW4gMC4yMCDCtyBwYW4gMDwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0idG9nZ2xlcyI+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJjaGlwIiBpZD0idk9uXyR7di5pZHh9Ij5PRkY8L2J1dHRvbj4KICAgICAgICAgIDxidXR0b24gY2xhc3M9ImNoaXAgbXV0ZSIgaWQ9InZNdXRlXyR7di5pZHh9Ij5NVVRFPC9idXR0b24+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJjaGlwIHNvbG8iIGlkPSJ2U29sb18ke3YuaWR4fSI+U09MTzwvYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iZzMiIHN0eWxlPSJtYXJnaW4tYm90dG9tOjhweDsiPgogICAgICAgIDxkaXYgY2xhc3M9Imt2Ij4KICAgICAgICAgIDxsYWJlbD48c3Bhbj5XYXZlZm9ybTwvc3Bhbj48YiBpZD0idldhdmVMYmxfJHt2LmlkeH0iPnNpbmU8L2I+PC9sYWJlbD4KICAgICAgICAgIDxzZWxlY3QgaWQ9InZXYXZlXyR7di5pZHh9Ij4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ic2luZSI+U2luZSDjgJw8L29wdGlvbj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0idHJpYW5nbGUiPlRyaWFuZ2xlIOKWszwvb3B0aW9uPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJzYXd0b290aCI+U2F3dG9vdGggL3w8L29wdGlvbj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ic3F1YXJlIj5TcXVhcmUg4patPC9vcHRpb24+CiAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJrdiIgc3R5bGU9ImdyaWQtY29sdW1uOnNwYW4gMjsiPgogICAgICAgICAgPGxhYmVsPjxzcGFuPkZyZXF1ZW56YTwvc3Bhbj48YiBpZD0idkZyZXFMYmxfJHt2LmlkeH0iPjQ0MCBIejwvYj48L2xhYmVsPgogICAgICAgICAgPGlucHV0IGlkPSJ2RnJlcVJfJHt2LmlkeH0iIHR5cGU9InJhbmdlIiBtaW49IjIwIiBtYXg9IjIwMDAiIHN0ZXA9IjAuNSIgdmFsdWU9IjQ0MCI+CiAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7Z2FwOjhweDttYXJnaW4tdG9wOjZweDsiPgogICAgICAgICAgICA8aW5wdXQgaWQ9InZGcmVxTl8ke3YuaWR4fSIgdHlwZT0ibnVtYmVyIiBtaW49IjEiIG1heD0iMjAwMDAiIHN0ZXA9IjAuNSIgdmFsdWU9IjQ0MCIgc3R5bGU9ImZsZXg6MTsiPgogICAgICAgICAgICA8c2VsZWN0IGlkPSJ2Tm90ZVByZXNldF8ke3YuaWR4fSIgc3R5bGU9ImZsZXg6MS4zO3BhZGRpbmc6N3B4IDZweDtib3JkZXItcmFkaXVzOjEwcHg7Ym9yZGVyOnZhcigtLWxpbmUpO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMyk7Y29sb3I6dmFyKC0tdHh0KTtmb250LXNpemU6MTAuNXB4O291dGxpbmU6bm9uZTsiPgogICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiI+4oCUIE5vdGEg4oCUPC9vcHRpb24+CiAgICAgICAgICAgICAgJHtnZW5Ob3RlT3B0cygpfQogICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iZzMiIHN0eWxlPSJtYXJnaW4tYm90dG9tOjhweDsiPgogICAgICAgIDxkaXYgY2xhc3M9Imt2Ij4KICAgICAgICAgIDxsYWJlbD48c3Bhbj5MaXZlbGxvPC9zcGFuPjxiIGlkPSJ2THZsTGJsXyR7di5pZHh9Ij4wLjIwPC9iPjwvbGFiZWw+CiAgICAgICAgICA8aW5wdXQgaWQ9InZMdmxfJHt2LmlkeH0iIHR5cGU9InJhbmdlIiBtaW49IjAiIG1heD0iMSIgc3RlcD0iMC4wMDEiIHZhbHVlPSIwLjIwIj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJrdiI+CiAgICAgICAgICA8bGFiZWw+PHNwYW4+RGV0dW5lICjCoik8L3NwYW4+PGIgaWQ9InZEZXRMYmxfJHt2LmlkeH0iPjAgwqI8L2I+PC9sYWJlbD4KICAgICAgICAgIDxpbnB1dCBpZD0idkRldF8ke3YuaWR4fSIgdHlwZT0icmFuZ2UiIG1pbj0iLTEyMDAiIG1heD0iMTIwMCIgc3RlcD0iMSIgdmFsdWU9IjAiPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9Imt2Ij4KICAgICAgICAgIDxsYWJlbD48c3Bhbj5QYW48L3NwYW4+PGIgaWQ9InZQYW5MYmxfJHt2LmlkeH0iPjA8L2I+PC9sYWJlbD4KICAgICAgICAgIDxpbnB1dCBpZD0idlBhbl8ke3YuaWR4fSIgdHlwZT0icmFuZ2UiIG1pbj0iLTEiIG1heD0iMSIgc3RlcD0iMC4wMDEiIHZhbHVlPSIwIj4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6OHB4OyI+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iYnRuIG9rIiBpZD0idlRyaWdfJHt2LmlkeH0iIHN0eWxlPSJmbGV4OjE7cGFkZGluZzo4cHg7Zm9udC1zaXplOjEycHg7Ij7wn5SKIFRyaWdnZXI8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gZGFuZ2VyIiBpZD0idk9mZl8ke3YuaWR4fSIgc3R5bGU9ImZsZXg6MTtwYWRkaW5nOjhweDtmb250LXNpemU6MTJweDsiPvCflIcgT2ZmPC9idXR0b24+CiAgICAgIDwvZGl2PgogICAgYDsKICAgIHZvaWNlc1Jvb3QuYXBwZW5kQ2hpbGQoY2FyZCk7CgogICAgLy8gQmluZCBldmVudHMKICAgICQoYHZPbl8ke3YuaWR4fWApLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+ewogICAgICB2LnBhcmFtcy5vbj0hdi5wYXJhbXMub247IHN5bmNGaXhlZFVJKHYpOwogICAgICBpZihhYyl7YXBwbHlGaXhlZFZvaWNlKHYpOyBpZih2LnBhcmFtcy5vbikgZml4ZWRFbnZPbih2KTsgZWxzZSBmaXhlZEVudk9mZih2KTsgcmVmcmVzaEZpeGVkKCk7fQogICAgfSk7CiAgICAkKGB2TXV0ZV8ke3YuaWR4fWApLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+e3YucGFyYW1zLm11dGU9IXYucGFyYW1zLm11dGU7c3luY0ZpeGVkVUkodik7cmVmcmVzaEZpeGVkKCk7fSk7CiAgICAkKGB2U29sb18ke3YuaWR4fWApLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+e3YucGFyYW1zLnNvbG89IXYucGFyYW1zLnNvbG87c3luY0ZpeGVkVUkodik7cmVmcmVzaEZpeGVkKCk7fSk7CiAgICAkKGB2V2F2ZV8ke3YuaWR4fWApLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsKCk9Pnt2LnBhcmFtcy53YXZlZm9ybT0kKGB2V2F2ZV8ke3YuaWR4fWApLnZhbHVlO3N5bmNGaXhlZFVJKHYpO2lmKGFjKWFwcGx5Rml4ZWRWb2ljZSh2KTt9KTsKCiAgICBmdW5jdGlvbiBzZXRGcmVxKHZhbCl7CiAgICAgIHYucGFyYW1zLmZyZXE9TWF0aC5tYXgoMSxNYXRoLm1pbigyMDAwMCxOdW1iZXIodmFsKXx8NDQwKSk7CiAgICAgIHN5bmNGaXhlZFVJKHYpOwogICAgICBpZihhYykgdi5vc2MuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKHYucGFyYW1zLmZyZXEsZml4ZWROb3coKSk7CiAgICB9CiAgICAkKGB2RnJlcVJfJHt2LmlkeH1gKS5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsZT0+c2V0RnJlcShlLnRhcmdldC52YWx1ZSkpOwogICAgJChgdkZyZXFOXyR7di5pZHh9YCkuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLGU9PnNldEZyZXEoZS50YXJnZXQudmFsdWUpKTsKICAgICQoYHZGcmVxTl8ke3YuaWR4fWApLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsZT0+c2V0RnJlcShlLnRhcmdldC52YWx1ZSkpOwogICAgJChgdk5vdGVQcmVzZXRfJHt2LmlkeH1gKS5hZGRFdmVudExpc3RlbmVyKCJjaGFuZ2UiLGU9PntpZihlLnRhcmdldC52YWx1ZSl7c2V0RnJlcShlLnRhcmdldC52YWx1ZSk7ZS50YXJnZXQudmFsdWU9IiI7fX0pOwogICAgJChgdkx2bF8ke3YuaWR4fWApLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IixlPT57di5wYXJhbXMubGV2ZWw9K2UudGFyZ2V0LnZhbHVlO3N5bmNGaXhlZFVJKHYpO3JlZnJlc2hGaXhlZCgpO30pOwogICAgJChgdkRldF8ke3YuaWR4fWApLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IixlPT57di5wYXJhbXMuZGV0dW5lPStlLnRhcmdldC52YWx1ZTtzeW5jRml4ZWRVSSh2KTtpZihhYyl2Lm9zYy5kZXR1bmUuc2V0VmFsdWVBdFRpbWUodi5wYXJhbXMuZGV0dW5lK3N0YXRlLmdsb2JhbERldHVuZSxmaXhlZE5vdygpKTt9KTsKICAgICQoYHZQYW5fJHt2LmlkeH1gKS5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsZT0+e3YucGFyYW1zLnBhbj0rZS50YXJnZXQudmFsdWU7c3luY0ZpeGVkVUkodik7aWYoYWMpdi5wYW5uZXIucGFuLnNldFZhbHVlQXRUaW1lKHYucGFyYW1zLnBhbixmaXhlZE5vdygpKTt9KTsKICAgICQoYHZUcmlnXyR7di5pZHh9YCkuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCgpPT57di5wYXJhbXMub249dHJ1ZTtzeW5jRml4ZWRVSSh2KTtpZighYWMpcmV0dXJuO2FwcGx5Rml4ZWRWb2ljZSh2KTtmaXhlZEVudk9uKHYpO3JlZnJlc2hGaXhlZCgpO30pOwogICAgJChgdk9mZl8ke3YuaWR4fWApLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+e3YucGFyYW1zLm9uPWZhbHNlO3N5bmNGaXhlZFVJKHYpO2lmKCFhYylyZXR1cm47Zml4ZWRFbnZPZmYodik7cmVmcmVzaEZpeGVkKCk7fSk7CgogICAgc3luY0ZpeGVkVUkodik7CiAgfSk7Cn0KCmZ1bmN0aW9uIGdlbk5vdGVPcHRzKCl7CiAgbGV0IHM9IiI7CiAgZm9yKGxldCBvY3Q9MjtvY3Q8PTg7b2N0KyspewogICAgZm9yKGxldCBuPTA7bjwxMjtuKyspewogICAgICBjb25zdCBtaWRpPShvY3QrMSkqMTIrbjsKICAgICAgY29uc3QgZnJlcT1taWRpVG9GcmVxKG1pZGkpOwogICAgICBjb25zdCBuYW1lPU5PVEVfTkFNRVNbbl0rb2N0OwogICAgICBzKz1gPG9wdGlvbiB2YWx1ZT0iJHtmcmVxLnRvRml4ZWQoMyl9Ij4ke25hbWV9IOKAlCAke01hdGgucm91bmQoZnJlcSl9IEh6PC9vcHRpb24+YDsKICAgIH0KICB9CiAgcmV0dXJuIHM7Cn0KCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBHTE9CQUwgQ09OVFJPTFMKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmZ1bmN0aW9uIHNldExhYmVscygpewogIGFWYWxFbC50ZXh0Q29udGVudD1gJHsoK2F0a0VsLnZhbHVlKS50b0ZpeGVkKDMpfSBzYDsKICBkVmFsRWwudGV4dENvbnRlbnQ9YCR7KCtkZWNFbC52YWx1ZSkudG9GaXhlZCgzKX0gc2A7CiAgc1ZhbEVsLnRleHRDb250ZW50PSgrc3VzRWwudmFsdWUpLnRvRml4ZWQoMyk7CiAgclZhbEVsLnRleHRDb250ZW50PWAkeygrcmVsRWwudmFsdWUpLnRvRml4ZWQoMyl9IHNgOwogIGxpbVZhbEVsLnRleHRDb250ZW50PWAkeytsaW1pdGVyRWwudmFsdWV9IGRCYDsKICBtYXN0ZXJWYWxFbC50ZXh0Q29udGVudD0oK21hc3RlckVsLnZhbHVlKS50b0ZpeGVkKDMpOwogIGdEZXRWYWxFbC50ZXh0Q29udGVudD1gJHsoK2dEZXRFbC52YWx1ZSl8MH0gwqJgOwp9CgphdGtFbC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsKCk9PntzdGF0ZS5hZHNyLmE9K2F0a0VsLnZhbHVlO3NldExhYmVscygpO3JlZnJlc2hGaXhlZCgpO30pOwpkZWNFbC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsKCk9PntzdGF0ZS5hZHNyLmQ9K2RlY0VsLnZhbHVlO3NldExhYmVscygpO3JlZnJlc2hGaXhlZCgpO30pOwpzdXNFbC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsKCk9PntzdGF0ZS5hZHNyLnM9K3N1c0VsLnZhbHVlO3NldExhYmVscygpO3JlZnJlc2hGaXhlZCgpO30pOwpyZWxFbC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsKCk9PntzdGF0ZS5hZHNyLnI9K3JlbEVsLnZhbHVlO3NldExhYmVscygpO30pOwptYXN0ZXJFbC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsKCk9PntzZXRMYWJlbHMoKTtpZihtYXN0ZXJHYWluKW1hc3RlckdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSgrbWFzdGVyRWwudmFsdWUsYWMuY3VycmVudFRpbWUpO30pOwpsaW1pdGVyRWwuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCgpPT57c2V0TGFiZWxzKCk7aWYoY29tcHJlc3Nvciljb21wcmVzc29yLnRocmVzaG9sZC5zZXRWYWx1ZUF0VGltZSgrbGltaXRlckVsLnZhbHVlLGFjLmN1cnJlbnRUaW1lKTt9KTsKZ0RldEVsLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwoKT0+ewogIHN0YXRlLmdsb2JhbERldHVuZT0rZ0RldEVsLnZhbHVlO3NldExhYmVscygpOwogIGlmKGFjKXsKICAgIGZpeGVkVm9pY2VzLmZvckVhY2godj0+di5vc2MuZGV0dW5lLnNldFZhbHVlQXRUaW1lKHYucGFyYW1zLmRldHVuZStzdGF0ZS5nbG9iYWxEZXR1bmUsYWMuY3VycmVudFRpbWUpKTsKICAgIHBvbHlWb2ljZXMuZm9yRWFjaCh2PT52Lm9zYy5kZXR1bmUuc2V0VmFsdWVBdFRpbWUoc3RhdGUuZ2xvYmFsRGV0dW5lLGFjLmN1cnJlbnRUaW1lKSk7CiAgfQp9KTsKa2JkTGV2ZWwuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCgpPT57a2JkTHZsVmFsLnRleHRDb250ZW50PSgra2JkTGV2ZWwudmFsdWUpLnRvRml4ZWQoMik7dXBkYXRlTWl4SW5mbygpO30pOwoKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIFRSQU5TUE9SVAovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KYnRuU3RhcnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLGFzeW5jKCk9PnsKICBlbnN1cmVBdWRpbygpOwogIGlmKGFjLnN0YXRlPT09InN1c3BlbmRlZCIpIGF3YWl0IGFjLnJlc3VtZSgpOwogIHN0YXRlLnJ1bm5pbmc9dHJ1ZTsKICBzdGF0dXNFbC50ZXh0Q29udGVudD0iUlVOIjsgc2RvdC5jbGFzc05hbWU9ImRvdCBncmVlbiI7CiAgYnRuU3RhcnQuZGlzYWJsZWQ9dHJ1ZTsgYnRuU3RvcC5kaXNhYmxlZD1mYWxzZTsKICBzdGFydFNjb3BlKCk7Cn0pOwpidG5TdG9wLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIixhc3luYygpPT57CiAgaWYoIWFjKSByZXR1cm47CiAgYWxsTm90ZXNPZmYoKTsKICBjb25zdCB0PWFjLmN1cnJlbnRUaW1lOwogIG1hc3RlckdhaW4uZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModCk7CiAgbWFzdGVyR2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKG1hc3RlckdhaW4uZ2Fpbi52YWx1ZSx0KTsKICBtYXN0ZXJHYWluLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMCx0KzAuMDYpOwogIGZpeGVkVm9pY2VzLmZvckVhY2godj0+Zml4ZWRFbnZPZmYodikpOwogIHNldFRpbWVvdXQoYXN5bmMoKT0+ewogICAgdHJ5e2F3YWl0IGFjLnN1c3BlbmQoKTt9Y2F0Y2goZSl7fQogICAgbWFzdGVyR2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKCttYXN0ZXJFbC52YWx1ZSxhYy5jdXJyZW50VGltZSk7CiAgICBzdGF0ZS5ydW5uaW5nPWZhbHNlOyBzdGF0dXNFbC50ZXh0Q29udGVudD0iU1RPUCI7IHNkb3QuY2xhc3NOYW1lPSJkb3QgcmVkIjsKICAgIGJ0blN0YXJ0LmRpc2FibGVkPWZhbHNlOyBidG5TdG9wLmRpc2FibGVkPXRydWU7CiAgfSw4MCk7Cn0pOwpidG5QYW5pYy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKCk9PnsKICBpZighYWMpIHJldHVybjsKICBhbGxOb3Rlc09mZigpOwogIGNvbnN0IHQ9YWMuY3VycmVudFRpbWU7CiAgZml4ZWRWb2ljZXMuZm9yRWFjaCh2PT57CiAgICB2LnBhcmFtcy5vbj1mYWxzZTt2LnBhcmFtcy5tdXRlPWZhbHNlO3YucGFyYW1zLnNvbG89ZmFsc2U7CiAgICB2LmdhaW4uZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModCk7CiAgICB2LmdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLHQpOwogICAgc3luY0ZpeGVkVUkodik7CiAgfSk7CiAgbWFzdGVyR2Fpbi5nYWluLmNhbmNlbFNjaGVkdWxlZFZhbHVlcyh0KTsKICBtYXN0ZXJHYWluLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMCx0KzAuMDEpOwogIG1hc3RlckdhaW4uZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgrbWFzdGVyRWwudmFsdWUsdCswLjA5KTsKICB1cGRhdGVNaXhJbmZvKCk7Cn0pOwoKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIFBSRVNFVFMKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CnByZXNldENob3JkLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+ewogIGVuc3VyZUF1ZGlvKCk7CiAgLy8gQyBtYWpvciBjaG9yZCBzcHJlYWQgb3ZlciBvY3RhdmVzCiAgY29uc3QgcHJlc2V0cz1bCiAgICB7ZjoyNjEuNjMsdzoic2F3dG9vdGgiLGw6LjE4LGQ6LTYscDotLjR9LAogICAge2Y6MzI5LjYzLHc6InNhd3Rvb3RoIixsOi4xNixkOiA2LHA6LS4yfSwKICAgIHtmOjM5Mi4wMCx3OiJ0cmlhbmdsZSIsbDouMTYsZDotNSxwOiAuMn0sCiAgICB7Zjo1MjMuMjUsdzoic2F3dG9vdGgiLGw6LjEzLGQ6IDUscDogLjR9LAogICAge2Y6NjU5LjI1LHc6InRyaWFuZ2xlIixsOi4xMCxkOi00LHA6LS4zfSwKICAgIHtmOjc4My45OSx3OiJ0cmlhbmdsZSIsbDouMDksZDogNCxwOiAuM30sCiAgICB7ZjoyMjAuMDAsdzoic2luZSIsICAgIGw6LjE0LGQ6IDAscDogMCB9LAogICAge2Y6NDQwLjAwLHc6InNpbmUiLCAgICBsOi4xMCxkOiAwLHA6IDAgfSwKICBdOwogIGZpeGVkVm9pY2VzLmZvckVhY2goKHYsaSk9PnsKICAgIGNvbnN0IHA9cHJlc2V0c1tpXTsKICAgIHYucGFyYW1zLndhdmVmb3JtPXAudzsgdi5wYXJhbXMuZnJlcT1wLmY7IHYucGFyYW1zLmxldmVsPXAubDsKICAgIHYucGFyYW1zLmRldHVuZT1wLmQ7IHYucGFyYW1zLnBhbj1wLnA7IHYucGFyYW1zLm9uPWk8NjsKICAgIHYucGFyYW1zLm11dGU9ZmFsc2U7IHYucGFyYW1zLnNvbG89ZmFsc2U7CiAgICBzeW5jRml4ZWRVSSh2KTsgYXBwbHlGaXhlZFZvaWNlKHYpOwogICAgaWYodi5wYXJhbXMub24pIGZpeGVkRW52T24odik7IGVsc2UgZml4ZWRFbnZPZmYodik7CiAgfSk7CiAgcmVmcmVzaEZpeGVkKCk7Cn0pOwpwcmVzZXRIYXJtLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwoKT0+ewogIGVuc3VyZUF1ZGlvKCk7CiAgY29uc3QgYmFzZT0xMTA7CiAgZml4ZWRWb2ljZXMuZm9yRWFjaCgodixpKT0+ewogICAgY29uc3Qgbj1pKzE7CiAgICB2LnBhcmFtcy53YXZlZm9ybT1uPD0yPyJzaW5lIjpuPD01PyJ0cmlhbmdsZSI6InNxdWFyZSI7CiAgICB2LnBhcmFtcy5mcmVxPWJhc2Uqbjsgdi5wYXJhbXMubGV2ZWw9MC4yMi9uOwogICAgdi5wYXJhbXMuZGV0dW5lPTA7IHYucGFyYW1zLnBhbj0oaSUyPT09MCk/LS4yNTouMjU7CiAgICB2LnBhcmFtcy5vbj10cnVlOyB2LnBhcmFtcy5tdXRlPWZhbHNlOyB2LnBhcmFtcy5zb2xvPWZhbHNlOwogICAgc3luY0ZpeGVkVUkodik7IGFwcGx5Rml4ZWRWb2ljZSh2KTsgZml4ZWRFbnZPbih2KTsKICB9KTsKICByZWZyZXNoRml4ZWQoKTsKfSk7CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gT1NDSUxMT1NDT1BFCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpsZXQgcmFmPTAsIGxhc3RGcHNUPTAsIGZyYW1lcz0wOwoKZnVuY3Rpb24gZHJhd1Njb3BlKCl7CiAgcmFmPXJlcXVlc3RBbmltYXRpb25GcmFtZShkcmF3U2NvcGUpOwogIGlmKCFhbmFseXNlcikgcmV0dXJuOwogIGNvbnN0IHc9c2NvcGVDYW52YXMud2lkdGgsIGg9c2NvcGVDYW52YXMuaGVpZ2h0OwogIGNvbnN0IGRhdGE9bmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXIuZmZ0U2l6ZSk7CiAgYW5hbHlzZXIuZ2V0Qnl0ZVRpbWVEb21haW5EYXRhKGRhdGEpOwoKICBjdHguZmlsbFN0eWxlPSJyZ2JhKDcsOCwxMywuODYpIjsKICBjdHguZmlsbFJlY3QoMCwwLHcsaCk7CgogIC8vIGdyaWQKICBjdHguc3Ryb2tlU3R5bGU9InJnYmEoMjU1LDI1NSwyNTUsLjA1KSI7CiAgY3R4LmxpbmVXaWR0aD0xOwogIGN0eC5iZWdpblBhdGgoKTsKICBmb3IobGV0IGk9MTtpPDc7aSsrKXtjb25zdCB5PWgqaS83O2N0eC5tb3ZlVG8oMCx5KTtjdHgubGluZVRvKHcseSk7fQogIGZvcihsZXQgaT0xO2k8MTM7aSsrKXtjb25zdCB4PXcqaS8xMztjdHgubW92ZVRvKHgsMCk7Y3R4LmxpbmVUbyh4LGgpO30KICBjdHguc3Ryb2tlKCk7CgogIC8vIGNlbnRlcgogIGN0eC5zdHJva2VTdHlsZT0icmdiYSg3OCwxNjEsMjU1LC4xMikiOwogIGN0eC5iZWdpblBhdGgoKTtjdHgubW92ZVRvKDAsaC8yKTtjdHgubGluZVRvKHcsaC8yKTtjdHguc3Ryb2tlKCk7CgogIC8vIGdsb3cKICBjdHguc3Ryb2tlU3R5bGU9InJnYmEoMTA2LDI0MCwxOTQsLjE1KSI7CiAgY3R4LmxpbmVXaWR0aD03OwogIGRyYXdXYXZlKGRhdGEsdyxoKTsKCiAgY3R4LnN0cm9rZVN0eWxlPSJyZ2JhKDc4LDE2MSwyNTUsLjkpIjsKICBjdHgubGluZVdpZHRoPTEuODsKICBkcmF3V2F2ZShkYXRhLHcsaCk7CgogIC8vIFJNUwogIGxldCBybXM9MDsKICBmb3IobGV0IGk9MDtpPGRhdGEubGVuZ3RoO2krKyl7Y29uc3Qgcz0oZGF0YVtpXS0xMjgpLzEyODtybXMrPXMqczt9CiAgcm1zPU1hdGguc3FydChybXMvZGF0YS5sZW5ndGgpOwogIHJtc1ZhbEVsLnRleHRDb250ZW50PXJtcy50b0ZpeGVkKDMpOwoKICBmcmFtZXMrKzsKICBjb25zdCB0PXBlcmZvcm1hbmNlLm5vdygpOwogIGlmKHQtbGFzdEZwc1Q+NzAwKXsKICAgIGZwc0VsLnRleHRDb250ZW50PShmcmFtZXMqMTAwMC8odC1sYXN0RnBzVCkpLnRvRml4ZWQoMCk7CiAgICBsYXN0RnBzVD10O2ZyYW1lcz0wOwogIH0KfQpmdW5jdGlvbiBkcmF3V2F2ZShkYXRhLHcsaCl7CiAgY3R4LmJlZ2luUGF0aCgpOwogIGZvcihsZXQgaT0wO2k8ZGF0YS5sZW5ndGg7aSsrKXsKICAgIGNvbnN0IHg9KGkvKGRhdGEubGVuZ3RoLTEpKSp3OwogICAgY29uc3QgeT1oLzIrKChkYXRhW2ldLTEyOCkvMTI4KSooaCouNDApOwogICAgaT09PTA/Y3R4Lm1vdmVUbyh4LHkpOmN0eC5saW5lVG8oeCx5KTsKICB9CiAgY3R4LnN0cm9rZSgpOwp9CmZ1bmN0aW9uIHN0YXJ0U2NvcGUoKXsKICBpZihyYWYpIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHJhZik7CiAgbGFzdEZwc1Q9cGVyZm9ybWFuY2Uubm93KCk7ZnJhbWVzPTA7CiAgZHJhd1Njb3BlKCk7Cn0KCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBJTklUCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpzZXRMYWJlbHMoKTsKa2JkTHZsVmFsLnRleHRDb250ZW50PSgra2JkTGV2ZWwudmFsdWUpLnRvRml4ZWQoMik7CgovLyBQbGFjZWhvbGRlciB2b2ljZXMKKGZ1bmN0aW9uIHBsYWNlaG9sZGVyKCl7CiAgdm9pY2VzUm9vdC5pbm5lckhUTUw9IiI7CiAgZm9yKGxldCBpPTE7aTw9TUFYX0ZJWEVEO2krKyl7CiAgICBjb25zdCBkPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgZC5jbGFzc05hbWU9ImNhcmQgdm9pY2UiOyBkLmlkPWB2Q2FyZF8ke2l9YDsKICAgIGNvbnN0IGNvbG9ycz1bJyM0ZWExZmYnLCcjNmFmMGMyJywnI2MwN2FmZicsJyNmZmNjNjYnLCcjZmY1YzdhJywnIzRiZjA4YScsJyNmZjlmNDMnLCcjNTRhMGZmJ107CiAgICBkLmlubmVySFRNTD1gCiAgICAgIDxkaXYgY2xhc3M9InZoZWFkIj4KICAgICAgICA8ZGl2IGNsYXNzPSJ2bGVmdCI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJiYWRnZSIgc3R5bGU9ImNvbG9yOiR7Y29sb3JzWyhpLTEpJThdfTtib3JkZXItY29sb3I6JHtjb2xvcnNbKGktMSklOF19MzA7Ij4ke2l9PC9kaXY+CiAgICAgICAgICA8ZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ2bmFtZSI+Vm9pY2UgJHtpfTwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJ2aW5mbyBzbWFsbCI+UHJlbWkg4pa2IFN0YXJ0IHBlciBhdHRpdmFyZSBsJ2F1ZGlvLjwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0idG9nZ2xlcyI+PHNwYW4gY2xhc3M9InBpbGwiPuKAlDwvc3Bhbj48L2Rpdj4KICAgICAgPC9kaXY+CiAgICBgOwogICAgdm9pY2VzUm9vdC5hcHBlbmRDaGlsZChkKTsKICB9Cn0pKCk7CgovLyBCdWlsZCBrZXlib2FyZCAoc2VuemEgYXVkaW8sIHNvbG8gdmlzdWFsZSkKYnVpbGRLZXlib2FyZCgpOwoKfSkoKTsKPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPg=="}, "05": {"title": "Sequencer", "b64": "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9Iml0Ij4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+TWFyYWNhUGFkIOKAoiBEcnVtIE1hY2hpbmUg4oCiIDE2eDE2IFNlcXVlbmNlcjwvdGl0bGU+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4udGFpbHdpbmRjc3MuY29tIj48L3NjcmlwdD4KICAgIDxzdHlsZT4KICAgICAgICBAaW1wb3J0IHVybCgnaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1JbnRlcjp3Z2h0QDMwMDs0MDA7NTAwOzYwMDs3MDA7ODAwJmRpc3BsYXk9c3dhcCcpOwogICAgICAgICogeyBtYXJnaW46MDsgcGFkZGluZzowOyBib3gtc2l6aW5nOmJvcmRlci1ib3g7IH0KICAgICAgICBib2R5IHsKICAgICAgICAgICAgZm9udC1mYW1pbHk6J0ludGVyJyxzYW5zLXNlcmlmOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiMwQTBBMEM7CiAgICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6cmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCAyMCUgMjAlLHJnYmEoMCwyNTUsMjAwLDAuMDQpIDAlLHRyYW5zcGFyZW50IDQwJSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFkaWFsLWdyYWRpZW50KGNpcmNsZSBhdCA4MCUgODAlLHJnYmEoMjU1LDAsMjAwLDAuMDQpIDAlLHRyYW5zcGFyZW50IDQwJSk7CiAgICAgICAgICAgIG1pbi1oZWlnaHQ6MTAwdmg7IGNvbG9yOiNmZmY7CiAgICAgICAgfQogICAgICAgIC5zdHVkaW8tcGFuZWwgewogICAgICAgICAgICBiYWNrZ3JvdW5kOnJnYmEoMTAsMTAsMTUsMC45Nyk7CiAgICAgICAgICAgIGJhY2tkcm9wLWZpbHRlcjpibHVyKDIwcHgpOwogICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkIHJnYmEoMCwyNTUsMTM2LDAuMTUpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOjI4cHg7CiAgICAgICAgICAgIGJveC1zaGFkb3c6MCAzMHB4IDYwcHggLTIwcHggIzAwMDsKICAgICAgICB9CiAgICAgICAgLyogU3RlcCBDZWxscyAqLwogICAgICAgIC5zdGVwLWNlbGwgewogICAgICAgICAgICBhc3BlY3QtcmF0aW86MTsgYmFja2dyb3VuZDojMWExYTI0OyBib3JkZXI6MS41cHggc29saWQgIzJmMmYzYTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czo1cHg7IGN1cnNvcjpwb2ludGVyOyB0cmFuc2l0aW9uOmFsbCAwLjA4cyBlYXNlOwogICAgICAgICAgICBkaXNwbGF5OmZsZXg7IGFsaWduLWl0ZW1zOmNlbnRlcjsganVzdGlmeS1jb250ZW50OmNlbnRlcjsKICAgICAgICAgICAgZm9udC1zaXplOjhweDsgZm9udC13ZWlnaHQ6NzAwOyBjb2xvcjojNDQ0OwogICAgICAgIH0KICAgICAgICAuc3RlcC1jZWxsOmhvdmVyIHsgYm9yZGVyLWNvbG9yOiMwMGZmODg7IGJhY2tncm91bmQ6IzIyMjIyZTsgfQogICAgICAgIC5zdGVwLWNlbGwuYWN0aXZlIHsgYmFja2dyb3VuZDojMDBmZjg4OyBib3JkZXItY29sb3I6I2FhZmZjYzsgY29sb3I6IzAwMDsgYm94LXNoYWRvdzowIDAgMTRweCAjMDBmZjg4ODA7IH0KICAgICAgICAuc3RlcC1jZWxsLnBsYXlpbmcgeyBiYWNrZ3JvdW5kOiNmZmFhMDAgIWltcG9ydGFudDsgYm9yZGVyLWNvbG9yOiNmZmYgIWltcG9ydGFudDsgY29sb3I6IzAwMCAhaW1wb3J0YW50OyBib3gtc2hhZG93OjAgMCAyMHB4ICNmZmFhMDA5OSAhaW1wb3J0YW50OyB0cmFuc2Zvcm06c2NhbGUoMS4xKTsgei1pbmRleDo1OyB9CiAgICAgICAgLyogQmVhdCBsaWdodHMgKi8KICAgICAgICAuYmVhdC1saWdodCB7CiAgICAgICAgICAgIG1pbi13aWR0aDoyOHB4OyBoZWlnaHQ6MjhweDsgYm9yZGVyLXJhZGl1czo4cHg7IGJhY2tncm91bmQ6IzE0MTQxYzsKICAgICAgICAgICAgYm9yZGVyOjEuNXB4IHNvbGlkICMyZDJkMzg7IGRpc3BsYXk6ZmxleDsgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOyBmb250LXNpemU6MTBweDsgZm9udC13ZWlnaHQ6NzAwOyBjb2xvcjojNDQ0OwogICAgICAgICAgICB0cmFuc2l0aW9uOmFsbCAwLjA2cyBlYXNlOwogICAgICAgIH0KICAgICAgICAuYmVhdC1saWdodC5vbiB7IGJhY2tncm91bmQ6IzAwZmY4ODsgYm9yZGVyLWNvbG9yOiNmZmY7IGNvbG9yOiMwMDA7IGJveC1zaGFkb3c6MCAwIDIwcHggIzAwZmY4ODg4OyB0cmFuc2Zvcm06c2NhbGUoMS4wNSk7IH0KICAgICAgICAvKiBUcmFjayByb3cgKi8KICAgICAgICAudHJhY2stcm93IHsKICAgICAgICAgICAgZGlzcGxheTpmbGV4OyBhbGlnbi1pdGVtczpjZW50ZXI7IGdhcDo2cHg7IHBhZGRpbmc6NXB4IDhweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czoxMnB4OyBib3JkZXI6MXB4IHNvbGlkICMxZTFlMjg7IHRyYW5zaXRpb246YWxsIDAuMTVzOwogICAgICAgIH0KICAgICAgICAudHJhY2stcm93OmhvdmVyIHsgYm9yZGVyLWNvbG9yOiMzMzMzNDQ7IGJhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwwLjAxKTsgfQogICAgICAgIC50cmFjay1yb3cucGxheWluZy1yb3cgeyBib3JkZXItY29sb3I6IzAwZmY4ODQwOyB9CiAgICAgICAgLyogQ29sb3IgYmFycyBwZXIgdGlwbyAqLwogICAgICAgIC50LWRydW0gIHsgYm9yZGVyLWxlZnQ6M3B4IHNvbGlkICNmZjMzNjY7IH0KICAgICAgICAudC1zeW50aCB7IGJvcmRlci1sZWZ0OjNweCBzb2xpZCAjMDBjY2ZmOyB9CiAgICAgICAgLnQtYmFzcyAgeyBib3JkZXItbGVmdDozcHggc29saWQgI2ZmYWEwMDsgfQogICAgICAgIC50LWFtYmllbnQgeyBib3JkZXItbGVmdDozcHggc29saWQgI2FhODhmZjsgfQogICAgICAgIC50LWd1aXRhciB7IGJvcmRlci1sZWZ0OjNweCBzb2xpZCAjMDBmZmFhOyB9CiAgICAgICAgLyogTXV0ZSBidG4gKi8KICAgICAgICAubXV0ZS1idG4geyBmb250LXNpemU6OXB4OyBwYWRkaW5nOjNweCA3cHg7IGJvcmRlci1yYWRpdXM6NnB4OyBib3JkZXI6MXB4IHNvbGlkICMzMzM7IGJhY2tncm91bmQ6IzFhMWEyNDsgY29sb3I6Izg4ODsgY3Vyc29yOnBvaW50ZXI7IHRyYW5zaXRpb246YWxsIDAuMXM7IH0KICAgICAgICAubXV0ZS1idG4ubXV0ZWQgeyBiYWNrZ3JvdW5kOiNmZjMzNjY7IGNvbG9yOiNmZmY7IGJvcmRlci1jb2xvcjojZmYzMzY2OyB9CiAgICAgICAgLnNvbG8tYnRuIHsgZm9udC1zaXplOjlweDsgcGFkZGluZzozcHggN3B4OyBib3JkZXItcmFkaXVzOjZweDsgYm9yZGVyOjFweCBzb2xpZCAjMzMzOyBiYWNrZ3JvdW5kOiMxYTFhMjQ7IGNvbG9yOiM4ODg7IGN1cnNvcjpwb2ludGVyOyB0cmFuc2l0aW9uOmFsbCAwLjFzOyB9CiAgICAgICAgLnNvbG8tYnRuLnNvbG9lZCB7IGJhY2tncm91bmQ6I2ZmYWEwMDsgY29sb3I6IzAwMDsgYm9yZGVyLWNvbG9yOiNmZmFhMDA7IH0KICAgICAgICAvKiBEaXZpc2lvbiBidG5zICovCiAgICAgICAgLmRpdi1idG4geyBwYWRkaW5nOjVweCAxMnB4OyBmb250LXNpemU6MTBweDsgZm9udC13ZWlnaHQ6NzAwOyBib3JkZXItcmFkaXVzOjIwcHg7IGJhY2tncm91bmQ6dHJhbnNwYXJlbnQ7IGNvbG9yOiM2NjY7IGJvcmRlcjpub25lOyBjdXJzb3I6cG9pbnRlcjsgdHJhbnNpdGlvbjphbGwgMC4xczsgfQogICAgICAgIC5kaXYtYnRuLmFjdGl2ZSB7IGJhY2tncm91bmQ6IzAwZmY4ODsgY29sb3I6IzAwMDsgfQogICAgICAgIC8qIFNjcm9sbGJhciAqLwogICAgICAgIDo6LXdlYmtpdC1zY3JvbGxiYXIgeyB3aWR0aDo0cHg7IGhlaWdodDo0cHg7IH0KICAgICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsgYmFja2dyb3VuZDojMGEwYTBjOyB9CiAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7IGJhY2tncm91bmQ6IzMzMzsgYm9yZGVyLXJhZGl1czo0cHg7IH0KICAgICAgICAvKiBUcmFuc3BvcnQgYnV0dG9ucyAqLwogICAgICAgIC50cmFuc3BvcnQtYnRuIHsKICAgICAgICAgICAgcGFkZGluZzoxMnB4IDI0cHg7IGJvcmRlci1yYWRpdXM6OTk5cHg7IGZvbnQtd2VpZ2h0OjcwMDsgZm9udC1zaXplOjEzcHg7CiAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzJmMmYzYTsgYmFja2dyb3VuZDojMWExYTI0OyBjb2xvcjojYWFhOyBjdXJzb3I6cG9pbnRlcjsKICAgICAgICAgICAgdHJhbnNpdGlvbjphbGwgMC4xNXM7CiAgICAgICAgfQogICAgICAgIC50cmFuc3BvcnQtYnRuOmhvdmVyIHsgYm9yZGVyLWNvbG9yOiMwMGZmODg7IGNvbG9yOiNmZmY7IH0KICAgICAgICAudHJhbnNwb3J0LWJ0bi5wbGF5LWFjdGl2ZSB7IGJhY2tncm91bmQ6IzAwZmY4ODsgY29sb3I6IzAwMDsgYm9yZGVyLWNvbG9yOiMwMGZmODg7IH0KICAgICAgICAvKiBWVSBtZXRlciBiYXIgKi8KICAgICAgICAudnUtYmFyIHsgd2lkdGg6MTAwJTsgaGVpZ2h0OjNweDsgYmFja2dyb3VuZDojMWExYTI0OyBib3JkZXItcmFkaXVzOjJweDsgb3ZlcmZsb3c6aGlkZGVuOyBtYXJnaW4tdG9wOjJweDsgfQogICAgICAgIC52dS1maWxsIHsgaGVpZ2h0OjEwMCU7IGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDkwZGVnLCMwMGZmODgsI2ZmYWEwMCk7IHdpZHRoOjAlOyB0cmFuc2l0aW9uOndpZHRoIDAuMDVzOyBib3JkZXItcmFkaXVzOjJweDsgfQogICAgICAgIC8qIFRvb2x0aXAgbm90ZSAqLwogICAgICAgIC5ub3RlLXNlbGVjdCB7IGJhY2tncm91bmQ6IzExMTExODsgYm9yZGVyOjFweCBzb2xpZCAjMmYyZjNhOyBjb2xvcjojMDBmZjg4OyBmb250LXNpemU6MTBweDsgcGFkZGluZzoycHggNHB4OyBib3JkZXItcmFkaXVzOjZweDsgY3Vyc29yOnBvaW50ZXI7IH0KICAgICAgICAubm90ZS1zZWxlY3Q6Zm9jdXMgeyBvdXRsaW5lOm5vbmU7IGJvcmRlci1jb2xvcjojMDBmZjg4OyB9CiAgICA8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5IGNsYXNzPSJwLTQiPgoKPGRpdiBjbGFzcz0ibWF4LXctWzE5MDBweF0gbXgtYXV0byBzdHVkaW8tcGFuZWwgcC02Ij4KCiAgICA8IS0tIEhFQURFUiAtLT4KICAgIDxkaXYgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBtYi02Ij4KICAgICAgICA8ZGl2PgogICAgICAgICAgICA8aDEgY2xhc3M9InRleHQtNHhsIGZvbnQtYmxhY2sgdHJhY2tpbmctdGlnaHQiPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRleHQtdHJhbnNwYXJlbnQgYmctY2xpcC10ZXh0IGJnLWdyYWRpZW50LXRvLXIgZnJvbS1lbWVyYWxkLTQwMCB0by1jeWFuLTQwMCI+TUFSQUNBPC9zcGFuPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRleHQtd2hpdGUiPlBBRDwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJtbC0yIHRleHQteHMgcHgtMiBweS0xIGJnLWVtZXJhbGQtNTAwLzIwIHJvdW5kZWQtZnVsbCB0ZXh0LWVtZXJhbGQtNDAwIGFsaWduLW1pZGRsZSI+djIg4oCiIDE2IFRSQUNDRTwvc3Bhbj4KICAgICAgICAgICAgPC9oMT4KICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtemluYy02MDAgdGV4dC14cyBtdC0xIj5EUlVNIE1BQ0hJTkUgKyBTWU5USCBTRVFVRU5DRVIg4oCiIFdFQiBBVURJTyBBUEk8L3A+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDwhLS0gVFJBTlNQT1JUIC0tPgogICAgICAgIDxkaXYgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIGdhcC0zIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGV4dC1jZW50ZXIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGV4dC14cyB0ZXh0LXppbmMtNjAwIG1iLTEiPkJQTTwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iY2hhbmdlQlBNKC01KSIgY2xhc3M9InRleHQtemluYy00MDAgaG92ZXI6dGV4dC13aGl0ZSB3LTYgaC02IGJnLXppbmMtODAwIHJvdW5kZWQtZnVsbCB0ZXh0LXNtIj7iiJI8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIGlkPSJicG0tc2xpZGVyIiBtaW49IjQwIiBtYXg9IjI0MCIgdmFsdWU9IjEyMCIgY2xhc3M9InctMjggYWNjZW50LWVtZXJhbGQtNDAwIiBvbmlucHV0PSJ1cGRhdGVCUE0oKSI+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gaWQ9ImJwbS1kaXNwbGF5IiBjbGFzcz0idGV4dC14bCBmb250LWJvbGQgdGV4dC1lbWVyYWxkLTQwMCB3LTEwIj4xMjA8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJjaGFuZ2VCUE0oNSkiIGNsYXNzPSJ0ZXh0LXppbmMtNDAwIGhvdmVyOnRleHQtd2hpdGUgdy02IGgtNiBiZy16aW5jLTgwMCByb3VuZGVkLWZ1bGwgdGV4dC1zbSI+KzwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8YnV0dG9uIGlkPSJwbGF5LWJ0biIgb25jbGljaz0idG9nZ2xlUGxheSgpIiBjbGFzcz0idHJhbnNwb3J0LWJ0biI+4pa2IFNUQVJUPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0ic3RvcEFsbCgpIiBjbGFzcz0idHJhbnNwb3J0LWJ0biI+4pe8IFNUT1A8L2J1dHRvbj4KICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJyYW5kb21QYXR0ZXJuKCkiIGNsYXNzPSJ0cmFuc3BvcnQtYnRuIHRleHQtc20iPvCfjrI8L2J1dHRvbj4KICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJjbGVhckFsbCgpIiBjbGFzcz0idHJhbnNwb3J0LWJ0biB0ZXh0LXNtIj7wn5eR77iPPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8IS0tIERJVklTSU9OIENPTlRST0xTIC0tPgogICAgPGRpdiBjbGFzcz0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTYgbWItNSI+CiAgICAgICAgPGRpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGV4dC14cyB0ZXh0LXppbmMtNjAwIG1iLTEiPlNURVBTIFBFUiBUUkFDQ0lBPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsZXggZ2FwLTEgYmctYmxhY2svNDAgcm91bmRlZC1mdWxsIHAtMSBib3JkZXIgYm9yZGVyLXppbmMtODAwIj4KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImRpdi1idG4iIGlkPSJkaXY0IiBvbmNsaWNrPSJzZXRTdGVwcyg0KSI+NDwvYnV0dG9uPgogICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZGl2LWJ0biIgaWQ9ImRpdjgiIG9uY2xpY2s9InNldFN0ZXBzKDgpIj44PC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkaXYtYnRuIGFjdGl2ZSIgaWQ9ImRpdjE2IiBvbmNsaWNrPSJzZXRTdGVwcygxNikiPjE2PC9idXR0b24+CiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJkaXYtYnRuIiBpZD0iZGl2MzIiIG9uY2xpY2s9InNldFN0ZXBzKDMyKSI+MzI8L2J1dHRvbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGV4dC14cyB0ZXh0LXppbmMtNjAwIG1iLTEiPlNDQUxBIE5PVEUgU0lOVEVUSVpaQVRPUkk8L2Rpdj4KICAgICAgICAgICAgPHNlbGVjdCBpZD0ic2NhbGUtc2VsZWN0IiBjbGFzcz0ibm90ZS1zZWxlY3QiIG9uY2hhbmdlPSJhcHBseVNjYWxlKCkiPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibWFqb3IiPk1hZ2dpb3JlIChEbyk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im1pbm9yIj5NaW5vcmUgKExhKTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0icGVudGF0b25pYyI+UGVudGF0b25pY2E8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImJsdWVzIj5CbHVlczwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iY2hyb21hdGljIj5Dcm9tYXRpY2E8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0idGV4dC14cyB0ZXh0LXppbmMtNjAwIG1iLTEiPlRPTkFMSVTDgDwvZGl2PgogICAgICAgICAgICA8c2VsZWN0IGlkPSJyb290LXNlbGVjdCIgY2xhc3M9Im5vdGUtc2VsZWN0IiBvbmNoYW5nZT0iYXBwbHlTY2FsZSgpIj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IkMiPkRvIChDKTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iRCI+UmUgKEQpPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJFIj5NaSAoRSk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IkYiPkZhIChGKTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iRyI+U29sIChHKTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iQSI+TGEgKEEpPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJCIj5TaSAoQik8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ibWwtYXV0byBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InRleHQteHMgdGV4dC16aW5jLTYwMCI+TUFTVEVSIFZPTDwvZGl2PgogICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIG1pbj0iMCIgbWF4PSIxMDAiIHZhbHVlPSI4MCIgY2xhc3M9InctMjQgYWNjZW50LWVtZXJhbGQtNDAwIiBvbmlucHV0PSJzZXRNYXN0ZXJWb2wodGhpcy52YWx1ZSkiPgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+CgogICAgPCEtLSBCRUFUIExJR0hUUyAtLT4KICAgIDxkaXYgaWQ9ImJlYXQtbGlnaHRzIiBjbGFzcz0iZmxleCBnYXAtMSBtYi01IG92ZXJmbG93LXgtYXV0byBwYi0xIj48L2Rpdj4KCiAgICA8IS0tIFNFUVVFTkNFUiBUUkFDS1MgLS0+CiAgICA8ZGl2IGlkPSJ0cmFja3MtY29udGFpbmVyIiBjbGFzcz0ic3BhY2UteS0xLjUiPjwvZGl2PgoKPC9kaXY+Cgo8c2NyaXB0PgovLyA9PT09PT09PT09IEFVRElPIEVOR0lORSA9PT09PT09PT09CmxldCBhdWRpb0N0eCA9IG51bGw7CmxldCBtYXN0ZXJHYWluOwoKZnVuY3Rpb24gaW5pdEF1ZGlvKCkgewogICAgaWYgKGF1ZGlvQ3R4KSByZXR1cm47CiAgICBhdWRpb0N0eCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpOwogICAgbWFzdGVyR2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgIG1hc3RlckdhaW4uZ2Fpbi52YWx1ZSA9IDAuODsKICAgIG1hc3RlckdhaW4uY29ubmVjdChhdWRpb0N0eC5kZXN0aW5hdGlvbik7Cn0KCmZ1bmN0aW9uIHJlc3VtZUF1ZGlvKCkgewogICAgaWYgKCFhdWRpb0N0eCkgaW5pdEF1ZGlvKCk7CiAgICBpZiAoYXVkaW9DdHguc3RhdGUgPT09ICdzdXNwZW5kZWQnKSBhdWRpb0N0eC5yZXN1bWUoKTsKfQoKLy8gPT09PT09PT09PSBTVU9OSSBSRUFMSVNUSUNJID09PT09PT09PT0KZnVuY3Rpb24gcGxheUtpY2soKSB7CiAgICByZXN1bWVBdWRpbygpOwogICAgY29uc3QgdCA9IGF1ZGlvQ3R4LmN1cnJlbnRUaW1lOwogICAgY29uc3Qgb3NjID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgIG9zYy5jb25uZWN0KGdhaW4pOyBnYWluLmNvbm5lY3QobWFzdGVyR2Fpbik7CiAgICBvc2MudHlwZSA9ICdzaW5lJzsKICAgIG9zYy5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoMTgwLCB0KTsKICAgIG9zYy5mcmVxdWVuY3kuZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSg0MCwgdCArIDAuMTIpOwogICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKDAuOSwgdCk7CiAgICBnYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdCArIDAuMzUpOwogICAgb3NjLnN0YXJ0KHQpOyBvc2Muc3RvcCh0ICsgMC4zNSk7Cn0KCmZ1bmN0aW9uIHBsYXlTbmFyZSh2b2w9MC43KSB7CiAgICByZXN1bWVBdWRpbygpOwogICAgY29uc3QgdCA9IGF1ZGlvQ3R4LmN1cnJlbnRUaW1lOwogICAgLy8gTm9pc2UKICAgIGNvbnN0IGJ1ZlNpemUgPSBhdWRpb0N0eC5zYW1wbGVSYXRlICogMC4xNTsKICAgIGNvbnN0IGJ1ZiA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlcigxLCBidWZTaXplLCBhdWRpb0N0eC5zYW1wbGVSYXRlKTsKICAgIGNvbnN0IGRhdGEgPSBidWYuZ2V0Q2hhbm5lbERhdGEoMCk7CiAgICBmb3IgKGxldCBpPTA7aTxidWZTaXplO2krKykgZGF0YVtpXSA9IChNYXRoLnJhbmRvbSgpKjItMSk7CiAgICBjb25zdCBub2lzZSA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpOwogICAgbm9pc2UuYnVmZmVyID0gYnVmOwogICAgY29uc3Qgbm9pc2VHYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgY29uc3QgaHBmID0gYXVkaW9DdHguY3JlYXRlQmlxdWFkRmlsdGVyKCk7CiAgICBocGYudHlwZSA9ICdiYW5kcGFzcyc7IGhwZi5mcmVxdWVuY3kudmFsdWUgPSAyNTAwOyBocGYuUS52YWx1ZSA9IDAuODsKICAgIG5vaXNlLmNvbm5lY3QoaHBmKTsgaHBmLmNvbm5lY3Qobm9pc2VHYWluKTsgbm9pc2VHYWluLmNvbm5lY3QobWFzdGVyR2Fpbik7CiAgICBub2lzZUdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSh2b2wsIHQpOwogICAgbm9pc2VHYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdCArIDAuMTgpOwogICAgbm9pc2Uuc3RhcnQodCk7IG5vaXNlLnN0b3AodCArIDAuMTgpOwogICAgLy8gQm9keSB0b25lCiAgICBjb25zdCBvc2MgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICBjb25zdCBvc2NHYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgb3NjLmNvbm5lY3Qob3NjR2Fpbik7IG9zY0dhaW4uY29ubmVjdChtYXN0ZXJHYWluKTsKICAgIG9zYy50eXBlID0gJ3RyaWFuZ2xlJzsgb3NjLmZyZXF1ZW5jeS52YWx1ZSA9IDIyMDsKICAgIG9zY0dhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSh2b2wgKiAwLjUsIHQpOwogICAgb3NjR2Fpbi5nYWluLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoMC4wMDEsIHQgKyAwLjA4KTsKICAgIG9zYy5zdGFydCh0KTsgb3NjLnN0b3AodCArIDAuMDgpOwp9CgpmdW5jdGlvbiBwbGF5SGloYXQob3Blbj1mYWxzZSwgdm9sPTAuNSkgewogICAgcmVzdW1lQXVkaW8oKTsKICAgIGNvbnN0IHQgPSBhdWRpb0N0eC5jdXJyZW50VGltZTsKICAgIGNvbnN0IGR1ciA9IG9wZW4gPyAwLjM1IDogMC4wNjsKICAgIGNvbnN0IGJ1ZlNpemUgPSBNYXRoLmZsb29yKGF1ZGlvQ3R4LnNhbXBsZVJhdGUgKiBkdXIpOwogICAgY29uc3QgYnVmID0gYXVkaW9DdHguY3JlYXRlQnVmZmVyKDEsIGJ1ZlNpemUsIGF1ZGlvQ3R4LnNhbXBsZVJhdGUpOwogICAgY29uc3QgZGF0YSA9IGJ1Zi5nZXRDaGFubmVsRGF0YSgwKTsKICAgIGZvciAobGV0IGk9MDtpPGJ1ZlNpemU7aSsrKSBkYXRhW2ldID0gKE1hdGgucmFuZG9tKCkqMi0xKTsKICAgIGNvbnN0IG5vaXNlID0gYXVkaW9DdHguY3JlYXRlQnVmZmVyU291cmNlKCk7CiAgICBub2lzZS5idWZmZXIgPSBidWY7CiAgICBjb25zdCBocGYgPSBhdWRpb0N0eC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTsKICAgIGhwZi50eXBlID0gJ2hpZ2hwYXNzJzsgaHBmLmZyZXF1ZW5jeS52YWx1ZSA9IDcwMDA7CiAgICBjb25zdCBnYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgbm9pc2UuY29ubmVjdChocGYpOyBocGYuY29ubmVjdChnYWluKTsgZ2Fpbi5jb25uZWN0KG1hc3RlckdhaW4pOwogICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHZvbCwgdCk7CiAgICBnYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdCArIGR1cik7CiAgICBub2lzZS5zdGFydCh0KTsgbm9pc2Uuc3RvcCh0ICsgZHVyKTsKfQoKZnVuY3Rpb24gcGxheUNsYXAodm9sPTAuNikgewogICAgcmVzdW1lQXVkaW8oKTsKICAgIGNvbnN0IHQgPSBhdWRpb0N0eC5jdXJyZW50VGltZTsKICAgIFswLCAwLjAxLCAwLjAyXS5mb3JFYWNoKG9mZnNldCA9PiB7CiAgICAgICAgY29uc3QgYnVmU2l6ZSA9IGF1ZGlvQ3R4LnNhbXBsZVJhdGUgKiAwLjEyOwogICAgICAgIGNvbnN0IGJ1ZiA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlcigxLCBidWZTaXplLCBhdWRpb0N0eC5zYW1wbGVSYXRlKTsKICAgICAgICBjb25zdCBkID0gYnVmLmdldENoYW5uZWxEYXRhKDApOwogICAgICAgIGZvciAobGV0IGk9MDtpPGJ1ZlNpemU7aSsrKSBkW2ldID0gKE1hdGgucmFuZG9tKCkqMi0xKTsKICAgICAgICBjb25zdCBub2lzZSA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpOwogICAgICAgIG5vaXNlLmJ1ZmZlciA9IGJ1ZjsKICAgICAgICBjb25zdCBicGYgPSBhdWRpb0N0eC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTsKICAgICAgICBicGYudHlwZSA9ICdiYW5kcGFzcyc7IGJwZi5mcmVxdWVuY3kudmFsdWUgPSAxMjAwOyBicGYuUS52YWx1ZSA9IDAuODsKICAgICAgICBjb25zdCBnYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgICAgIG5vaXNlLmNvbm5lY3QoYnBmKTsgYnBmLmNvbm5lY3QoZ2Fpbik7IGdhaW4uY29ubmVjdChtYXN0ZXJHYWluKTsKICAgICAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodm9sICogMC43LCB0ICsgb2Zmc2V0KTsKICAgICAgICBnYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdCArIG9mZnNldCArIDAuMTQpOwogICAgICAgIG5vaXNlLnN0YXJ0KHQgKyBvZmZzZXQpOyBub2lzZS5zdG9wKHQgKyBvZmZzZXQgKyAwLjE0KTsKICAgIH0pOwp9CgpmdW5jdGlvbiBwbGF5VG9tKGZyZXE9MTIwLCB2b2w9MC43KSB7CiAgICByZXN1bWVBdWRpbygpOwogICAgY29uc3QgdCA9IGF1ZGlvQ3R4LmN1cnJlbnRUaW1lOwogICAgY29uc3Qgb3NjID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgIG9zYy5jb25uZWN0KGdhaW4pOyBnYWluLmNvbm5lY3QobWFzdGVyR2Fpbik7CiAgICBvc2MudHlwZSA9ICdzaW5lJzsKICAgIG9zYy5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoZnJlcSAqIDEuNSwgdCk7CiAgICBvc2MuZnJlcXVlbmN5LmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoZnJlcSwgdCArIDAuMDgpOwogICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHZvbCwgdCk7CiAgICBnYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdCArIDAuMzUpOwogICAgb3NjLnN0YXJ0KHQpOyBvc2Muc3RvcCh0ICsgMC4zNSk7Cn0KCmZ1bmN0aW9uIHBsYXlSaW0odm9sPTAuNikgewogICAgcmVzdW1lQXVkaW8oKTsKICAgIGNvbnN0IHQgPSBhdWRpb0N0eC5jdXJyZW50VGltZTsKICAgIGNvbnN0IG9zYyA9IGF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgIGNvbnN0IGdhaW4gPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICBjb25zdCBicGYgPSBhdWRpb0N0eC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTsKICAgIGJwZi50eXBlID0gJ2JhbmRwYXNzJzsgYnBmLmZyZXF1ZW5jeS52YWx1ZSA9IDMwMDA7IGJwZi5RLnZhbHVlID0gMzsKICAgIG9zYy5jb25uZWN0KGJwZik7IGJwZi5jb25uZWN0KGdhaW4pOyBnYWluLmNvbm5lY3QobWFzdGVyR2Fpbik7CiAgICBvc2MudHlwZSA9ICd0cmlhbmdsZSc7IG9zYy5mcmVxdWVuY3kudmFsdWUgPSA0NTA7CiAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodm9sLCB0KTsKICAgIGdhaW4uZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKDAuMDAxLCB0ICsgMC4wNSk7CiAgICBvc2Muc3RhcnQodCk7IG9zYy5zdG9wKHQgKyAwLjA1KTsKfQoKZnVuY3Rpb24gcGxheVBlcmMoZnJlcT0yNTAsIHZvbD0wLjU1KSB7CiAgICByZXN1bWVBdWRpbygpOwogICAgY29uc3QgdCA9IGF1ZGlvQ3R4LmN1cnJlbnRUaW1lOwogICAgY29uc3Qgb3NjID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgIG9zYy5jb25uZWN0KGdhaW4pOyBnYWluLmNvbm5lY3QobWFzdGVyR2Fpbik7CiAgICBvc2MudHlwZSA9ICdzcXVhcmUnOyBvc2MuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKGZyZXEsIHQpOwogICAgb3NjLmZyZXF1ZW5jeS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKGZyZXEgKiAwLjUsIHQgKyAwLjA1KTsKICAgIGdhaW4uZ2Fpbi5zZXRWYWx1ZUF0VGltZSh2b2wsIHQpOwogICAgZ2Fpbi5nYWluLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoMC4wMDEsIHQgKyAwLjEyKTsKICAgIG9zYy5zdGFydCh0KTsgb3NjLnN0b3AodCArIDAuMTIpOwp9CgpmdW5jdGlvbiBwbGF5U2hha2VyKHZvbD0wLjQpIHsKICAgIHJlc3VtZUF1ZGlvKCk7CiAgICBjb25zdCB0ID0gYXVkaW9DdHguY3VycmVudFRpbWU7CiAgICBjb25zdCBidWZTaXplID0gYXVkaW9DdHguc2FtcGxlUmF0ZSAqIDAuMDQ7CiAgICBjb25zdCBidWYgPSBhdWRpb0N0eC5jcmVhdGVCdWZmZXIoMSwgYnVmU2l6ZSwgYXVkaW9DdHguc2FtcGxlUmF0ZSk7CiAgICBjb25zdCBkID0gYnVmLmdldENoYW5uZWxEYXRhKDApOwogICAgZm9yIChsZXQgaT0wO2k8YnVmU2l6ZTtpKyspIGRbaV0gPSAoTWF0aC5yYW5kb20oKSoyLTEpOwogICAgY29uc3Qgbm9pc2UgPSBhdWRpb0N0eC5jcmVhdGVCdWZmZXJTb3VyY2UoKTsKICAgIG5vaXNlLmJ1ZmZlciA9IGJ1ZjsKICAgIGNvbnN0IGhwZiA9IGF1ZGlvQ3R4LmNyZWF0ZUJpcXVhZEZpbHRlcigpOwogICAgaHBmLnR5cGUgPSAnaGlnaHBhc3MnOyBocGYuZnJlcXVlbmN5LnZhbHVlID0gODAwMDsKICAgIGNvbnN0IGdhaW4gPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICBub2lzZS5jb25uZWN0KGhwZik7IGhwZi5jb25uZWN0KGdhaW4pOyBnYWluLmNvbm5lY3QobWFzdGVyR2Fpbik7CiAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUodm9sLCB0KTsKICAgIGdhaW4uZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKDAuMDAxLCB0ICsgMC4wNCk7CiAgICBub2lzZS5zdGFydCh0KTsgbm9pc2Uuc3RvcCh0ICsgMC4wNCk7Cn0KCi8vIFN5bnRoIG5vdGUgY29uIGZyZXF1ZW56YSBzcGVjaWZpY2F0YQpmdW5jdGlvbiBwbGF5Tm90ZShmcmVxLCB3YXZlPSdzYXd0b290aCcsIGF0dGFjaz0wLjAxLCBkZWNheT0wLjMsIHZvbD0wLjUsIGZpbHRlckZyZXE9MTUwMCkgewogICAgcmVzdW1lQXVkaW8oKTsKICAgIGNvbnN0IHQgPSBhdWRpb0N0eC5jdXJyZW50VGltZTsKICAgIGNvbnN0IG9zYyA9IGF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgIGNvbnN0IGdhaW4gPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7CiAgICBjb25zdCBmaWx0ZXIgPSBhdWRpb0N0eC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTsKICAgIGZpbHRlci50eXBlID0gJ2xvd3Bhc3MnOyBmaWx0ZXIuZnJlcXVlbmN5LnZhbHVlID0gZmlsdGVyRnJlcTsgZmlsdGVyLlEudmFsdWUgPSAyOwogICAgb3NjLmNvbm5lY3QoZmlsdGVyKTsgZmlsdGVyLmNvbm5lY3QoZ2Fpbik7IGdhaW4uY29ubmVjdChtYXN0ZXJHYWluKTsKICAgIG9zYy50eXBlID0gd2F2ZTsKICAgIG9zYy5mcmVxdWVuY3kudmFsdWUgPSBmcmVxOwogICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKDAsIHQpOwogICAgZ2Fpbi5nYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHZvbCwgdCArIGF0dGFjayk7CiAgICBnYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdCArIGF0dGFjayArIGRlY2F5KTsKICAgIG9zYy5zdGFydCh0KTsgb3NjLnN0b3AodCArIGF0dGFjayArIGRlY2F5ICsgMC4wNSk7Cn0KCmZ1bmN0aW9uIHBsYXlCYXNzKGZyZXEsIHZvbD0wLjgpIHsKICAgIHJlc3VtZUF1ZGlvKCk7CiAgICBjb25zdCB0ID0gYXVkaW9DdHguY3VycmVudFRpbWU7CiAgICBjb25zdCBvc2MgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICBjb25zdCBvc2MyID0gYXVkaW9DdHguY3JlYXRlT3NjaWxsYXRvcigpOwogICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgIGNvbnN0IGZpbHRlciA9IGF1ZGlvQ3R4LmNyZWF0ZUJpcXVhZEZpbHRlcigpOwogICAgZmlsdGVyLnR5cGUgPSAnbG93cGFzcyc7IGZpbHRlci5mcmVxdWVuY3kudmFsdWUgPSAzMDA7IGZpbHRlci5RLnZhbHVlID0gMTsKICAgIG9zYy5jb25uZWN0KGZpbHRlcik7IG9zYzIuY29ubmVjdChmaWx0ZXIpOyBmaWx0ZXIuY29ubmVjdChnYWluKTsgZ2Fpbi5jb25uZWN0KG1hc3RlckdhaW4pOwogICAgb3NjLnR5cGUgPSAnc2F3dG9vdGgnOyBvc2MuZnJlcXVlbmN5LnZhbHVlID0gZnJlcTsKICAgIG9zYzIudHlwZSA9ICdzaW5lJzsgb3NjMi5mcmVxdWVuY3kudmFsdWUgPSBmcmVxOwogICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKDAsIHQpOwogICAgZ2Fpbi5nYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHZvbCwgdCArIDAuMDA1KTsKICAgIGdhaW4uZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKDAuMDAxLCB0ICsgMC4zNSk7CiAgICBvc2Muc3RhcnQodCk7IG9zYy5zdG9wKHQgKyAwLjQpOwogICAgb3NjMi5zdGFydCh0KTsgb3NjMi5zdG9wKHQgKyAwLjQpOwp9CgpmdW5jdGlvbiBwbGF5QW1iaWVudChmcmVxLCB2b2w9MC4zNSkgewogICAgcmVzdW1lQXVkaW8oKTsKICAgIGNvbnN0IHQgPSBhdWRpb0N0eC5jdXJyZW50VGltZTsKICAgIGNvbnN0IG9zYyA9IGF1ZGlvQ3R4LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgIGNvbnN0IG9zYzIgPSBhdWRpb0N0eC5jcmVhdGVPc2NpbGxhdG9yKCk7CiAgICBjb25zdCBnYWluID0gYXVkaW9DdHguY3JlYXRlR2FpbigpOwogICAgY29uc3QgZmlsdGVyID0gYXVkaW9DdHguY3JlYXRlQmlxdWFkRmlsdGVyKCk7CiAgICBjb25zdCByZXZlcmIgPSBhdWRpb0N0eC5jcmVhdGVDb252b2x2ZXIoKTsKICAgIGZpbHRlci50eXBlID0gJ2xvd3Bhc3MnOyBmaWx0ZXIuZnJlcXVlbmN5LnZhbHVlID0gODAwOyBmaWx0ZXIuUS52YWx1ZSA9IDAuNTsKICAgIG9zYy5jb25uZWN0KGZpbHRlcik7IG9zYzIuY29ubmVjdChmaWx0ZXIpOyBmaWx0ZXIuY29ubmVjdChnYWluKTsgZ2Fpbi5jb25uZWN0KG1hc3RlckdhaW4pOwogICAgb3NjLnR5cGUgPSAndHJpYW5nbGUnOyBvc2MuZnJlcXVlbmN5LnZhbHVlID0gZnJlcTsKICAgIG9zYzIudHlwZSA9ICd0cmlhbmdsZSc7IG9zYzIuZnJlcXVlbmN5LnZhbHVlID0gZnJlcSAqIDEuMDAxOyAvLyBzbGlnaHQgZGV0dW5lCiAgICBnYWluLmdhaW4uc2V0VmFsdWVBdFRpbWUoMCwgdCk7CiAgICBnYWluLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodm9sLCB0ICsgMC4yKTsKICAgIGdhaW4uZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKDAuMDAxLCB0ICsgMS41KTsKICAgIG9zYy5zdGFydCh0KTsgb3NjLnN0b3AodCArIDEuNik7CiAgICBvc2MyLnN0YXJ0KHQpOyBvc2MyLnN0b3AodCArIDEuNik7Cn0KCmZ1bmN0aW9uIHBsYXlHdWl0YXIoZnJlcSwgdm9sPTAuNTUpIHsKICAgIC8vIEthcnBsdXMtU3Ryb25nIGFwcHJveGltYXRpb24KICAgIHJlc3VtZUF1ZGlvKCk7CiAgICBjb25zdCB0ID0gYXVkaW9DdHguY3VycmVudFRpbWU7CiAgICBjb25zdCBidWZTaXplID0gTWF0aC5mbG9vcihhdWRpb0N0eC5zYW1wbGVSYXRlIC8gZnJlcSk7CiAgICBjb25zdCBidWYgPSBhdWRpb0N0eC5jcmVhdGVCdWZmZXIoMSwgYnVmU2l6ZSwgYXVkaW9DdHguc2FtcGxlUmF0ZSk7CiAgICBjb25zdCBkID0gYnVmLmdldENoYW5uZWxEYXRhKDApOwogICAgZm9yIChsZXQgaT0wO2k8YnVmU2l6ZTtpKyspIGRbaV0gPSBNYXRoLnJhbmRvbSgpKjItMTsKICAgIGNvbnN0IG5vaXNlID0gYXVkaW9DdHguY3JlYXRlQnVmZmVyU291cmNlKCk7CiAgICBub2lzZS5idWZmZXIgPSBidWY7IG5vaXNlLmxvb3AgPSB0cnVlOwogICAgY29uc3QgZ2FpbiA9IGF1ZGlvQ3R4LmNyZWF0ZUdhaW4oKTsKICAgIGNvbnN0IGZpbHRlciA9IGF1ZGlvQ3R4LmNyZWF0ZUJpcXVhZEZpbHRlcigpOwogICAgZmlsdGVyLnR5cGUgPSAnbG93cGFzcyc7IGZpbHRlci5mcmVxdWVuY3kudmFsdWUgPSAyMDAwOwogICAgbm9pc2UuY29ubmVjdChmaWx0ZXIpOyBmaWx0ZXIuY29ubmVjdChnYWluKTsgZ2Fpbi5jb25uZWN0KG1hc3RlckdhaW4pOwogICAgZ2Fpbi5nYWluLnNldFZhbHVlQXRUaW1lKHZvbCwgdCk7CiAgICBnYWluLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdCArIDAuNik7CiAgICBub2lzZS5zdGFydCh0KTsgbm9pc2Uuc3RvcCh0ICsgMC42NSk7Cn0KCi8vID09PT09PT09PT0gU0NBTEUgPT09PT09PT09PQpjb25zdCBOT1RFU19GUkVRID0gewogICAgQzogMjYxLjYzLCBEOiAyOTMuNjYsIEU6IDMyOS42MywgRjogMzQ5LjIzLAogICAgRzogMzkyLjAwLCBBOiA0NDAuMDAsIEI6IDQ5My44OAp9Owpjb25zdCBTQ0FMRVMgPSB7CiAgICBtYWpvcjogICAgICBbMCwgMiwgNCwgNSwgNywgOSwgMTFdLAogICAgbWlub3I6ICAgICAgWzAsIDIsIDMsIDUsIDcsIDgsIDEwXSwKICAgIHBlbnRhdG9uaWM6IFswLCAyLCA0LCA3LCA5XSwKICAgIGJsdWVzOiAgICAgIFswLCAzLCA1LCA2LCA3LCAxMF0sCiAgICBjaHJvbWF0aWM6ICBbMCwxLDIsMyw0LDUsNiw3LDgsOSwxMCwxMV0KfTsKCmZ1bmN0aW9uIGdldFNjYWxlRnJlcXMoKSB7CiAgICBjb25zdCByb290TmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290LXNlbGVjdCcpLnZhbHVlOwogICAgY29uc3Qgc2NhbGVOYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYWxlLXNlbGVjdCcpLnZhbHVlOwogICAgY29uc3Qgcm9vdEZyZXEgPSBOT1RFU19GUkVRW3Jvb3ROYW1lXTsKICAgIGNvbnN0IGludGVydmFscyA9IFNDQUxFU1tzY2FsZU5hbWVdOwogICAgY29uc3QgZnJlcXMgPSBbXTsKICAgIFstMSwwLDEsMl0uZm9yRWFjaChvY3QgPT4gewogICAgICAgIGludGVydmFscy5mb3JFYWNoKHNlbWkgPT4gewogICAgICAgICAgICBmcmVxcy5wdXNoKHJvb3RGcmVxICogTWF0aC5wb3coMiwgb2N0ICsgc2VtaS8xMikpOwogICAgICAgIH0pOwogICAgfSk7CiAgICByZXR1cm4gZnJlcXMuZmlsdGVyKGYgPT4gZiA+PSA1MCAmJiBmIDw9IDIwMDApLnNvcnQoKGEsYik9PmEtYik7Cn0KCi8vID09PT09PT09PT0gU1RBVEUgPT09PT09PT09PQpjb25zdCBOVU1fVFJBQ0tTID0gMTY7CmxldCBudW1TdGVwcyA9IDE2OwpsZXQgYnBtID0gMTIwOwpsZXQgaXNQbGF5aW5nID0gZmFsc2U7CmxldCBjdXJyZW50U3RlcCA9IDA7CmxldCBpbnRlcnZhbElkID0gbnVsbDsKCi8vIE9nbmkgdHJhY2NpYTogeyBuYW1lLCB0eXBlLCBjb2xvciwgbXV0ZWQsIHNvbG9lZCwgc3RlcE5vdGVzW10sIGFjdGl2ZVtdIH0KbGV0IHRyYWNrcyA9IFtdOwpsZXQgYmVhdExpZ2h0cyA9IFtdOwoKLy8gRnVuemlvbmUgYXVkaW8gcGVyIG9nbmkgdHJhY2NpYQpjb25zdCBUUkFDS19ERUZTID0gWwogICAgeyBuYW1lOidLSUNLJywgICAgIHR5cGU6J2RydW0nLCAgIGNvbG9yOicjZmYzMzY2JywgZm46IChmcmVxLHZvbCk9PnBsYXlLaWNrKCkgfSwKICAgIHsgbmFtZTonU05BUkUnLCAgICB0eXBlOidkcnVtJywgICBjb2xvcjonI2ZmMzM2NicsIGZuOiAoZnJlcSx2b2wpPT5wbGF5U25hcmUodm9sKSB9LAogICAgeyBuYW1lOidISS1IQVQnLCAgIHR5cGU6J2RydW0nLCAgIGNvbG9yOicjZmYzMzY2JywgZm46IChmcmVxLHZvbCk9PnBsYXlIaWhhdChmYWxzZSx2b2wpIH0sCiAgICB7IG5hbWU6J09QRU4gSEFUJywgdHlwZTonZHJ1bScsICAgY29sb3I6JyNmZjU1ODgnLCBmbjogKGZyZXEsdm9sKT0+cGxheUhpaGF0KHRydWUsdm9sKSB9LAogICAgeyBuYW1lOidDTEFQJywgICAgIHR5cGU6J2RydW0nLCAgIGNvbG9yOicjZmYzMzY2JywgZm46IChmcmVxLHZvbCk9PnBsYXlDbGFwKHZvbCkgfSwKICAgIHsgbmFtZTonVE9NIEhJJywgICB0eXBlOidkcnVtJywgICBjb2xvcjonI2ZmNTU2NicsIGZuOiAoZnJlcSx2b2wpPT5wbGF5VG9tKDE4MCx2b2wpIH0sCiAgICB7IG5hbWU6J1RPTSBMTycsICAgdHlwZTonZHJ1bScsICAgY29sb3I6JyNmZjQ0NTUnLCBmbjogKGZyZXEsdm9sKT0+cGxheVRvbSg5MCx2b2wpIH0sCiAgICB7IG5hbWU6J1NIQUtFUicsICAgdHlwZTonZHJ1bScsICAgY29sb3I6JyNmZjY2NzcnLCBmbjogKGZyZXEsdm9sKT0+cGxheVNoYWtlcih2b2wpIH0sCiAgICB7IG5hbWU6J0JBU1MnLCAgICAgdHlwZTonYmFzcycsICAgY29sb3I6JyNmZmFhMDAnLCBmbjogKGZyZXEsdm9sKT0+cGxheUJhc3MoZnJlcSx2b2wpIH0sCiAgICB7IG5hbWU6J1NVQiBCQVNTJywgdHlwZTonYmFzcycsICAgY29sb3I6JyNmZjg4MDAnLCBmbjogKGZyZXEsdm9sKT0+cGxheUJhc3MoZnJlcSowLjUsdm9sKSB9LAogICAgeyBuYW1lOidTWU5USCBMRCcsIHR5cGU6J3N5bnRoJywgIGNvbG9yOicjMDBjY2ZmJywgZm46IChmcmVxLHZvbCk9PnBsYXlOb3RlKGZyZXEsJ3Nhd3Rvb3RoJywwLjAxLDAuMyx2b2wsMjAwMCkgfSwKICAgIHsgbmFtZTonU1lOVEggUEFEJyx0eXBlOidzeW50aCcsICBjb2xvcjonIzAwODhmZicsIGZuOiAoZnJlcSx2b2wpPT5wbGF5Tm90ZShmcmVxLCd0cmlhbmdsZScsMC4xLDEuMCx2b2wqMC43LDYwMCkgfSwKICAgIHsgbmFtZTonQVJQRUdHSU8nLCB0eXBlOidzeW50aCcsICBjb2xvcjonIzAwYWFmZicsIGZuOiAoZnJlcSx2b2wpPT5wbGF5Tm90ZShmcmVxLCdzcXVhcmUnLDAuMDA1LDAuMTIsdm9sLDMwMDApIH0sCiAgICB7IG5hbWU6J0FNQklFTlQnLCAgdHlwZTonYW1iaWVudCcsY29sb3I6JyNhYTg4ZmYnLCBmbjogKGZyZXEsdm9sKT0+cGxheUFtYmllbnQoZnJlcSx2b2wpIH0sCiAgICB7IG5hbWU6J0dVSVRBUicsICAgdHlwZTonZ3VpdGFyJywgY29sb3I6JyMwMGZmYWEnLCBmbjogKGZyZXEsdm9sKT0+cGxheUd1aXRhcihmcmVxLHZvbCkgfSwKICAgIHsgbmFtZTonUklNJywgICAgICB0eXBlOidkcnVtJywgICBjb2xvcjonI2ZmNzc5OScsIGZuOiAoZnJlcSx2b2wpPT5wbGF5UmltKHZvbCkgfSwKXTsKCmZ1bmN0aW9uIHR5cGVDbGFzcyh0eXBlKSB7CiAgICByZXR1cm4ge2RydW06J3QtZHJ1bScsYmFzczondC1iYXNzJyxzeW50aDondC1zeW50aCcsYW1iaWVudDondC1hbWJpZW50JyxndWl0YXI6J3QtZ3VpdGFyJ31bdHlwZV0gfHwgJ3QtZHJ1bSc7Cn0KCi8vID09PT09PT09PT0gQlVJTEQgVUkgPT09PT09PT09PQpmdW5jdGlvbiBidWlsZEFsbCgpIHsKICAgIC8vIENhbGNvbGEgc2NhbGUgZnJlcXMKICAgIGNvbnN0IHNjYWxlRnJlcXMgPSBnZXRTY2FsZUZyZXFzKCk7CiAgICAKICAgIHRyYWNrcyA9IFRSQUNLX0RFRlMubWFwKChkZWYsIGkpID0+IHsKICAgICAgICBjb25zdCBpc0RydW0gPSBkZWYudHlwZSA9PT0gJ2RydW0nOwogICAgICAgIC8vIEFzc2VnbmEgZnJlcXVlbnplIGRpIGRlZmF1bHQgcGVyIG5vdGUKICAgICAgICBjb25zdCBkZWZhdWx0RnJlcXMgPSBpc0RydW0gCiAgICAgICAgICAgID8gQXJyYXkobnVtU3RlcHMpLmZpbGwoMjIwKQogICAgICAgICAgICA6IEFycmF5KG51bVN0ZXBzKS5maWxsKG51bGwpLm1hcCgoXyxzKSA9PiBzY2FsZUZyZXFzW3MgJSBzY2FsZUZyZXFzLmxlbmd0aF0pOwogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIC4uLmRlZiwKICAgICAgICAgICAgbXV0ZWQ6IGZhbHNlLAogICAgICAgICAgICBzb2xvZWQ6IGZhbHNlLAogICAgICAgICAgICBhY3RpdmU6IEFycmF5KG51bVN0ZXBzKS5maWxsKGZhbHNlKSwKICAgICAgICAgICAgc3RlcEZyZXFzOiBkZWZhdWx0RnJlcXMsCiAgICAgICAgICAgIHZvbDogZGVmLnR5cGUgPT09ICdiYXNzJyA/IDAuOCA6IGRlZi50eXBlID09PSAnZHJ1bScgPyAwLjcgOiAwLjUKICAgICAgICB9OwogICAgfSk7CgogICAgYnVpbGRCZWF0TGlnaHRzKCk7CiAgICBidWlsZFRyYWNrcygpOwp9CgpmdW5jdGlvbiBidWlsZEJlYXRMaWdodHMoKSB7CiAgICBjb25zdCBjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JlYXQtbGlnaHRzJyk7CiAgICBjLmlubmVySFRNTCA9ICcnOwogICAgYmVhdExpZ2h0cyA9IFtdOwogICAgZm9yIChsZXQgaT0wOyBpPG51bVN0ZXBzOyBpKyspIHsKICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGVsLmNsYXNzTmFtZSA9ICdiZWF0LWxpZ2h0JzsKICAgICAgICBlbC50ZXh0Q29udGVudCA9IGkrMTsKICAgICAgICAvLyBDb2xvciBncm91cHMgb2YgNAogICAgICAgIGlmIChpICUgNCA9PT0gMCkgZWwuc3R5bGUuYm9yZGVyQ29sb3IgPSAnIzNhM2E1MCc7CiAgICAgICAgYy5hcHBlbmRDaGlsZChlbCk7CiAgICAgICAgYmVhdExpZ2h0cy5wdXNoKGVsKTsKICAgIH0KfQoKZnVuY3Rpb24gYnVpbGRUcmFja3MoKSB7CiAgICBjb25zdCBjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrcy1jb250YWluZXInKTsKICAgIGMuaW5uZXJIVE1MID0gJyc7CiAgICBjb25zdCBzY2FsZUZyZXFzID0gZ2V0U2NhbGVGcmVxcygpOwoKICAgIHRyYWNrcy5mb3JFYWNoKCh0cmFjaywgdGkpID0+IHsKICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICByb3cuY2xhc3NOYW1lID0gYHRyYWNrLXJvdyAke3R5cGVDbGFzcyh0cmFjay50eXBlKX1gOwogICAgICAgIHJvdy5pZCA9IGB0cmFjay0ke3RpfWA7CgogICAgICAgIC8vIE5hbWUgbGFiZWwKICAgICAgICBjb25zdCBuYW1lRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBuYW1lRWwuY2xhc3NOYW1lID0gJ2ZsZXggZmxleC1jb2wgbWluLXctWzcycHhdJzsKICAgICAgICBuYW1lRWwuaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8c3BhbiBjbGFzcz0idGV4dC1bMTBweF0gZm9udC1ib2xkIiBzdHlsZT0iY29sb3I6JHt0cmFjay5jb2xvcn0iPiR7dHJhY2submFtZX08L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0ZXh0LVs4cHhdIHRleHQtemluYy02MDAiPiR7dHJhY2sudHlwZS50b1VwcGVyQ2FzZSgpfTwvc3Bhbj4KICAgICAgICBgOwoKICAgICAgICAvLyBNdXRlL1NvbG8KICAgICAgICBjb25zdCBtdXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgbXV0ZUJ0bi5jbGFzc05hbWUgPSAnbXV0ZS1idG4nOyBtdXRlQnRuLnRleHRDb250ZW50ID0gJ00nOwogICAgICAgIG11dGVCdG4ub25jbGljayA9ICgpID0+IHRvZ2dsZU11dGUodGksIG11dGVCdG4pOwoKICAgICAgICBjb25zdCBzb2xvQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgc29sb0J0bi5jbGFzc05hbWUgPSAnc29sby1idG4nOyBzb2xvQnRuLnRleHRDb250ZW50ID0gJ1MnOwogICAgICAgIHNvbG9CdG4ub25jbGljayA9ICgpID0+IHRvZ2dsZVNvbG8odGksIHNvbG9CdG4pOwoKICAgICAgICAvLyBWVSBtZXRlciAoc29sbyBwZXIgc2hvdykKICAgICAgICBjb25zdCB2dSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIHZ1LmNsYXNzTmFtZSA9ICd2dS1iYXInOyB2dS5zdHlsZS53aWR0aD0nMjRweCc7CiAgICAgICAgY29uc3QgdnVGaWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgdnVGaWxsLmNsYXNzTmFtZSA9ICd2dS1maWxsJzsgdnVGaWxsLmlkID0gYHZ1LSR7dGl9YDsKICAgICAgICB2dS5hcHBlbmRDaGlsZCh2dUZpbGwpOwoKICAgICAgICAvLyBTdGVwIGNlbGxzCiAgICAgICAgY29uc3Qgc3RlcHNEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBzdGVwc0Rpdi5jbGFzc05hbWUgPSAnZmxleCBnYXAtMSBmbGV4LTEnOwogICAgICAgIHN0ZXBzRGl2LmlkID0gYHN0ZXBzLSR7dGl9YDsKCiAgICAgICAgZm9yIChsZXQgcz0wOyBzPG51bVN0ZXBzOyBzKyspIHsKICAgICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBjZWxsLmNsYXNzTmFtZSA9ICdzdGVwLWNlbGwgZmxleC0xJzsKICAgICAgICAgICAgY2VsbC5kYXRhc2V0LnRyYWNrID0gdGk7CiAgICAgICAgICAgIGNlbGwuZGF0YXNldC5zdGVwID0gczsKICAgICAgICAgICAgY2VsbC50ZXh0Q29udGVudCA9IChzICUgNCkgKyAxOwogICAgICAgICAgICAvLyBHcm91cCBjb2xvcgogICAgICAgICAgICBpZiAocyAlIDQgPT09IDApIGNlbGwuc3R5bGUuYm9yZGVyTGVmdENvbG9yID0gJyM0YTRhNWEnOwogICAgICAgICAgICAKICAgICAgICAgICAgY2VsbC5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICAgICAgdHJhY2suYWN0aXZlW3NdID0gIXRyYWNrLmFjdGl2ZVtzXTsKICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgdHJhY2suYWN0aXZlW3NdKTsKICAgICAgICAgICAgICAgIGlmICh0cmFjay5hY3RpdmVbc10pIHsKICAgICAgICAgICAgICAgICAgICAvLyBQbGF5IHByZXZpZXcKICAgICAgICAgICAgICAgICAgICBwbGF5VHJhY2sodGksIHMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBzdGVwc0Rpdi5hcHBlbmRDaGlsZChjZWxsKTsKICAgICAgICB9CgogICAgICAgIHJvdy5hcHBlbmRDaGlsZChuYW1lRWwpOwogICAgICAgIHJvdy5hcHBlbmRDaGlsZChtdXRlQnRuKTsKICAgICAgICByb3cuYXBwZW5kQ2hpbGQoc29sb0J0bik7CiAgICAgICAgcm93LmFwcGVuZENoaWxkKHN0ZXBzRGl2KTsKICAgICAgICBjLmFwcGVuZENoaWxkKHJvdyk7CiAgICB9KTsKfQoKZnVuY3Rpb24gYXBwbHlTY2FsZSgpIHsKICAgIGNvbnN0IHNjYWxlRnJlcXMgPSBnZXRTY2FsZUZyZXFzKCk7CiAgICB0cmFja3MuZm9yRWFjaCgodHJhY2ssIHRpKSA9PiB7CiAgICAgICAgaWYgKHRyYWNrLnR5cGUgIT09ICdkcnVtJykgewogICAgICAgICAgICB0cmFjay5zdGVwRnJlcXMgPSBBcnJheShudW1TdGVwcykuZmlsbChudWxsKS5tYXAoKF8scykgPT4gc2NhbGVGcmVxc1tzICUgc2NhbGVGcmVxcy5sZW5ndGhdKTsKICAgICAgICB9CiAgICB9KTsKfQoKLy8gPT09PT09PT09PSBNVVRFIC8gU09MTyA9PT09PT09PT09CmZ1bmN0aW9uIHRvZ2dsZU11dGUodGksIGJ0bikgewogICAgdHJhY2tzW3RpXS5tdXRlZCA9ICF0cmFja3NbdGldLm11dGVkOwogICAgYnRuLmNsYXNzTGlzdC50b2dnbGUoJ211dGVkJywgdHJhY2tzW3RpXS5tdXRlZCk7Cn0KCmZ1bmN0aW9uIHRvZ2dsZVNvbG8odGksIGJ0bikgewogICAgdHJhY2tzW3RpXS5zb2xvZWQgPSAhdHJhY2tzW3RpXS5zb2xvZWQ7CiAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZSgnc29sb2VkJywgdHJhY2tzW3RpXS5zb2xvZWQpOwp9CgpmdW5jdGlvbiBpc1RyYWNrQXVkaWJsZSh0aSkgewogICAgY29uc3QgYW55U29sbyA9IHRyYWNrcy5zb21lKHQgPT4gdC5zb2xvZWQpOwogICAgaWYgKGFueVNvbG8pIHJldHVybiB0cmFja3NbdGldLnNvbG9lZDsKICAgIHJldHVybiAhdHJhY2tzW3RpXS5tdXRlZDsKfQoKLy8gPT09PT09PT09PSBQTEFZID09PT09PT09PT0KZnVuY3Rpb24gcGxheVRyYWNrKHRpLCBzdGVwKSB7CiAgICBjb25zdCB0cmFjayA9IHRyYWNrc1t0aV07CiAgICBpZiAoIXRyYWNrKSByZXR1cm47CiAgICBjb25zdCBmcmVxID0gdHJhY2suc3RlcEZyZXFzID8gdHJhY2suc3RlcEZyZXFzW3N0ZXBdIDogMjIwOwogICAgY29uc3Qgdm9sID0gdHJhY2sudm9sIHx8IDAuNjsKICAgIHRyYWNrLmZuKGZyZXEsIHZvbCk7CiAgICAvLyBWVSBmbGFzaAogICAgY29uc3QgdnVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGB2dS0ke3RpfWApOwogICAgaWYgKHZ1RWwpIHsKICAgICAgICB2dUVsLnN0eWxlLndpZHRoID0gJzEwMCUnOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdnVFbC5zdHlsZS53aWR0aCA9ICcwJScsIDgwKTsKICAgIH0KICAgIC8vIFBhZCBmbGFzaAogICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHRyYWNrLSR7dGl9YCk7CiAgICBpZiAocm93KSB7CiAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoJ3BsYXlpbmctcm93Jyk7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiByb3cuY2xhc3NMaXN0LnJlbW92ZSgncGxheWluZy1yb3cnKSwgMTAwKTsKICAgIH0KfQoKZnVuY3Rpb24gdGljaygpIHsKICAgIC8vIFVwZGF0ZSBiZWF0IGxpZ2h0cwogICAgYmVhdExpZ2h0cy5mb3JFYWNoKChsLCBpKSA9PiB7CiAgICAgICAgbC5jbGFzc0xpc3QudG9nZ2xlKCdvbicsIGkgPT09IGN1cnJlbnRTdGVwKTsKICAgIH0pOwoKICAgIC8vIFVwZGF0ZSBzdGVwIGNlbGxzIGhpZ2hsaWdodAogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN0ZXAtY2VsbCcpLmZvckVhY2goYyA9PiB7CiAgICAgICAgYy5jbGFzc0xpc3QucmVtb3ZlKCdwbGF5aW5nJyk7CiAgICAgICAgaWYgKHBhcnNlSW50KGMuZGF0YXNldC5zdGVwKSA9PT0gY3VycmVudFN0ZXApIGMuY2xhc3NMaXN0LmFkZCgncGxheWluZycpOwogICAgfSk7CgogICAgLy8gUGxheSBhY3RpdmUgc3RlcHMKICAgIHRyYWNrcy5mb3JFYWNoKCh0cmFjaywgdGkpID0+IHsKICAgICAgICBpZiAodHJhY2suYWN0aXZlW2N1cnJlbnRTdGVwXSAmJiBpc1RyYWNrQXVkaWJsZSh0aSkpIHsKICAgICAgICAgICAgcGxheVRyYWNrKHRpLCBjdXJyZW50U3RlcCk7CiAgICAgICAgfQogICAgfSk7CgogICAgY3VycmVudFN0ZXAgPSAoY3VycmVudFN0ZXAgKyAxKSAlIG51bVN0ZXBzOwp9CgpmdW5jdGlvbiB0b2dnbGVQbGF5KCkgewogICAgcmVzdW1lQXVkaW8oKTsKICAgIGlmIChpc1BsYXlpbmcpIHsKICAgICAgICBzdG9wQWxsKGZhbHNlKTsKICAgIH0gZWxzZSB7CiAgICAgICAgaXNQbGF5aW5nID0gdHJ1ZTsKICAgICAgICBjdXJyZW50U3RlcCA9IDA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXktYnRuJykudGV4dENvbnRlbnQgPSAn4pe8IFNUT1AnOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5LWJ0bicpLmNsYXNzTGlzdC5hZGQoJ3BsYXktYWN0aXZlJyk7CiAgICAgICAgY29uc3QgbXMgPSAoNjAwMDAgLyBicG0pIC8gNDsgLy8gMTZ0aCBub3RlcwogICAgICAgIHRpY2soKTsKICAgICAgICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwodGljaywgbXMpOwogICAgfQp9CgpmdW5jdGlvbiBzdG9wQWxsKHJlc2V0U3RlcD10cnVlKSB7CiAgICBpZiAoaW50ZXJ2YWxJZCkgeyBjbGVhckludGVydmFsKGludGVydmFsSWQpOyBpbnRlcnZhbElkID0gbnVsbDsgfQogICAgaXNQbGF5aW5nID0gZmFsc2U7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheS1idG4nKS50ZXh0Q29udGVudCA9ICfilrYgU1RBUlQnOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXktYnRuJykuY2xhc3NMaXN0LnJlbW92ZSgncGxheS1hY3RpdmUnKTsKICAgIGJlYXRMaWdodHMuZm9yRWFjaChsID0+IGwuY2xhc3NMaXN0LnJlbW92ZSgnb24nKSk7CiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3RlcC1jZWxsJykuZm9yRWFjaChjID0+IGMuY2xhc3NMaXN0LnJlbW92ZSgncGxheWluZycpKTsKICAgIGlmIChyZXNldFN0ZXApIGN1cnJlbnRTdGVwID0gMDsKfQoKZnVuY3Rpb24gdXBkYXRlQlBNKCkgewogICAgYnBtID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JwbS1zbGlkZXInKS52YWx1ZSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnBtLWRpc3BsYXknKS50ZXh0Q29udGVudCA9IGJwbTsKICAgIGlmIChpc1BsYXlpbmcpIHsKICAgICAgICBzdG9wQWxsKGZhbHNlKTsKICAgICAgICBjb25zdCBtcyA9ICg2MDAwMCAvIGJwbSkgLyA0OwogICAgICAgIGludGVydmFsSWQgPSBzZXRJbnRlcnZhbCh0aWNrLCBtcyk7CiAgICAgICAgaXNQbGF5aW5nID0gdHJ1ZTsKICAgIH0KfQoKZnVuY3Rpb24gY2hhbmdlQlBNKGRlbHRhKSB7CiAgICBjb25zdCBzbGlkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnBtLXNsaWRlcicpOwogICAgc2xpZGVyLnZhbHVlID0gTWF0aC5taW4oMjQwLCBNYXRoLm1heCg0MCwgcGFyc2VJbnQoc2xpZGVyLnZhbHVlKSArIGRlbHRhKSk7CiAgICB1cGRhdGVCUE0oKTsKfQoKZnVuY3Rpb24gc2V0TWFzdGVyVm9sKHZhbCkgewogICAgaWYgKG1hc3RlckdhaW4pIG1hc3RlckdhaW4uZ2Fpbi52YWx1ZSA9IHZhbCAvIDEwMDsKICAgIGVsc2UgaWYgKGF1ZGlvQ3R4KSBtYXN0ZXJHYWluLmdhaW4udmFsdWUgPSB2YWwvMTAwOwp9CgpmdW5jdGlvbiBzZXRTdGVwcyhuKSB7CiAgICBudW1TdGVwcyA9IG47CiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGl2LWJ0bicpLmZvckVhY2goYiA9PiBiLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBkaXYke259YCkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICB0cmFja3MuZm9yRWFjaCh0ID0+IHsKICAgICAgICBpZiAodC5hY3RpdmUubGVuZ3RoIDwgbikgewogICAgICAgICAgICB0LmFjdGl2ZSA9IFsuLi50LmFjdGl2ZSwgLi4uQXJyYXkobiAtIHQuYWN0aXZlLmxlbmd0aCkuZmlsbChmYWxzZSldOwogICAgICAgICAgICB0LnN0ZXBGcmVxcyA9IFsuLi50LnN0ZXBGcmVxcywgLi4uQXJyYXkobiAtIHQuc3RlcEZyZXFzLmxlbmd0aCkuZmlsbCh0LnN0ZXBGcmVxc1swXSB8fCAyMjApXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0LmFjdGl2ZSA9IHQuYWN0aXZlLnNsaWNlKDAsIG4pOwogICAgICAgICAgICB0LnN0ZXBGcmVxcyA9IHQuc3RlcEZyZXFzLnNsaWNlKDAsIG4pOwogICAgICAgIH0KICAgIH0pOwogICAgaWYgKGN1cnJlbnRTdGVwID49IG4pIGN1cnJlbnRTdGVwID0gMDsKICAgIGJ1aWxkQmVhdExpZ2h0cygpOwogICAgcmVidWlsZFN0ZXBDZWxscygpOwp9CgpmdW5jdGlvbiByZWJ1aWxkU3RlcENlbGxzKCkgewogICAgdHJhY2tzLmZvckVhY2goKHRyYWNrLCB0aSkgPT4gewogICAgICAgIGNvbnN0IHN0ZXBzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHN0ZXBzLSR7dGl9YCk7CiAgICAgICAgaWYgKCFzdGVwc0RpdikgcmV0dXJuOwogICAgICAgIHN0ZXBzRGl2LmlubmVySFRNTCA9ICcnOwogICAgICAgIGZvciAobGV0IHM9MDsgczxudW1TdGVwczsgcysrKSB7CiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgY2VsbC5jbGFzc05hbWUgPSBgc3RlcC1jZWxsIGZsZXgtMSAke3RyYWNrLmFjdGl2ZVtzXSA/ICdhY3RpdmUnIDogJyd9YDsKICAgICAgICAgICAgY2VsbC5kYXRhc2V0LnRyYWNrID0gdGk7CiAgICAgICAgICAgIGNlbGwuZGF0YXNldC5zdGVwID0gczsKICAgICAgICAgICAgY2VsbC50ZXh0Q29udGVudCA9IChzICUgNCkgKyAxOwogICAgICAgICAgICBpZiAocyAlIDQgPT09IDApIGNlbGwuc3R5bGUuYm9yZGVyTGVmdENvbG9yID0gJyM0YTRhNWEnOwogICAgICAgICAgICBjZWxsLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICB0cmFjay5hY3RpdmVbc10gPSAhdHJhY2suYWN0aXZlW3NdOwogICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnLCB0cmFjay5hY3RpdmVbc10pOwogICAgICAgICAgICAgICAgaWYgKHRyYWNrLmFjdGl2ZVtzXSkgcGxheVRyYWNrKHRpLCBzKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgc3RlcHNEaXYuYXBwZW5kQ2hpbGQoY2VsbCk7CiAgICAgICAgfQogICAgfSk7Cn0KCmZ1bmN0aW9uIHJhbmRvbVBhdHRlcm4oKSB7CiAgICByZXN1bWVBdWRpbygpOwogICAgdHJhY2tzLmZvckVhY2goKHRyYWNrLCB0aSkgPT4gewogICAgICAgIGNvbnN0IGRlbnNpdHkgPSB0cmFjay50eXBlID09PSAnZHJ1bScgPyAwLjI1IDogMC4xNTsKICAgICAgICB0cmFjay5hY3RpdmUgPSB0cmFjay5hY3RpdmUubWFwKCgpID0+IE1hdGgucmFuZG9tKCkgPCBkZW5zaXR5KTsKICAgIH0pOwogICAgLy8gQXNzaWN1cmEga2ljayBzZW1wcmUgc3UgMQogICAgaWYgKHRyYWNrc1swXSkgeyB0cmFja3NbMF0uYWN0aXZlWzBdID0gdHJ1ZTsgdHJhY2tzWzBdLmFjdGl2ZVs4XSA9IE1hdGgucmFuZG9tKCkgPiAwLjU7IH0KICAgIHJlYnVpbGRTdGVwQ2VsbHMoKTsKfQoKZnVuY3Rpb24gY2xlYXJBbGwoKSB7CiAgICB0cmFja3MuZm9yRWFjaCh0ID0+IHQuYWN0aXZlID0gQXJyYXkobnVtU3RlcHMpLmZpbGwoZmFsc2UpKTsKICAgIHJlYnVpbGRTdGVwQ2VsbHMoKTsKfQoKLy8gPT09PT09PT09PSBJTklUID09PT09PT09PT0Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7CiAgICBidWlsZEFsbCgpOwogICAgLy8gRGVmYXVsdCBmdW5reSBwYXR0ZXJuIGRpbW9zdHJhdGl2bwogICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgY29uc3QgZGVtbyA9IFsKICAgICAgICAgICAgWzEsMCwwLDAsIDEsMCwwLDAsIDEsMCwwLDAsIDEsMCwwLDBdLCAvLyBLSUNLCiAgICAgICAgICAgIFswLDAsMCwwLCAxLDAsMCwwLCAwLDAsMCwwLCAxLDAsMCwxXSwgLy8gU05BUkUKICAgICAgICAgICAgWzEsMCwxLDAsIDEsMCwxLDAsIDEsMCwxLDAsIDEsMCwxLDBdLCAvLyBISUhBVAogICAgICAgICAgICBbMCwwLDAsMCwgMCwwLDAsMSwgMCwwLDAsMCwgMCwwLDAsMF0sIC8vIE9QRU4gSEFUCiAgICAgICAgICAgIFswLDAsMCwwLCAwLDAsMSwwLCAwLDAsMCwwLCAwLDAsMCwwXSwgLy8gQ0xBUAogICAgICAgICAgICBbMCwwLDAsMSwgMCwwLDAsMCwgMCwwLDEsMCwgMCwwLDAsMF0sIC8vIFRPTSBISQogICAgICAgICAgICBbMCwwLDAsMCwgMCwwLDAsMCwgMCwwLDAsMCwgMCwwLDEsMF0sIC8vIFRPTSBMTwogICAgICAgICAgICBbMCwxLDAsMCwgMCwxLDAsMCwgMCwxLDAsMCwgMCwxLDAsMF0sIC8vIFNIQUtFUgogICAgICAgICAgICBbMSwwLDAsMCwgMCwwLDEsMCwgMCwwLDAsMCwgMCwwLDAsMF0sIC8vIEJBU1MKICAgICAgICAgICAgWzAsMCwwLDAsIDAsMCwwLDAsIDEsMCwwLDAsIDAsMCwwLDBdLCAvLyBTVUIKICAgICAgICAgICAgWzAsMCwxLDAsIDAsMCwwLDAsIDAsMSwwLDAsIDAsMCwwLDBdLCAvLyBTWU5USCBMRAogICAgICAgICAgICBbMSwwLDAsMCwgMCwwLDAsMCwgMSwwLDAsMCwgMCwwLDAsMF0sIC8vIFNZTlRIIFBBRAogICAgICAgICAgICBbMCwxLDAsMSwgMCwxLDAsMCwgMCwwLDAsMSwgMCwxLDAsMF0sIC8vIEFSUEVHR0lPCiAgICAgICAgICAgIFswLDAsMCwwLCAwLDAsMCwwLCAwLDAsMCwwLCAwLDAsMCwwXSwgLy8gQU1CSUVOVAogICAgICAgICAgICBbMCwwLDAsMCwgMCwwLDAsMCwgMCwwLDAsMCwgMCwwLDAsMF0sIC8vIEdVSVRBUgogICAgICAgICAgICBbMCwwLDEsMCwgMCwwLDAsMCwgMCwwLDEsMCwgMCwwLDAsMF0sIC8vIFJJTQogICAgICAgIF07CiAgICAgICAgZGVtby5mb3JFYWNoKChwYXQsIHRpKSA9PiB7CiAgICAgICAgICAgIGlmICh0cmFja3NbdGldKSB0cmFja3NbdGldLmFjdGl2ZSA9IHBhdC5tYXAodiA9PiB2PT09MSk7CiAgICAgICAgfSk7CiAgICAgICAgcmVidWlsZFN0ZXBDZWxscygpOwogICAgfSwgMTAwKTsKfSk7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4="}};

  // === Audio unlock (solo per sbloccare policy browser) ===
  let unlocked = false;
  let unlockCtx = null;

  async function unlockAudio() {
    if (unlocked) return true;
    try {
      const AC = window.AudioContext || window.webkitAudioContext;
      if (!AC) {
        unlocked = true;
        return true;
      }
      unlockCtx = unlockCtx || new AC();
      // "ping" audio per far partire il contesto
      const osc = unlockCtx.createOscillator();
      const gain = unlockCtx.createGain();
      gain.gain.value = 0.00001;
      osc.connect(gain);
      gain.connect(unlockCtx.destination);
      osc.start();
      osc.stop(unlockCtx.currentTime + 0.02);
      await unlockCtx.resume?.();
      unlocked = true;

      // nascondi overlay
      const ov = document.getElementById('startOverlay');
      if (ov) ov.style.display = 'none';
      return true;
    } catch (e) {
      console.warn('unlockAudio error', e);
      // anche se fallisce, permetti comunque di usare i pulsanti (alcune piattaforme gestiscono diversamente)
      const ov = document.getElementById('startOverlay');
      if (ov) ov.style.display = 'none';
      return false;
    }
  }

  function b64ToUtf8(b64) {
    // decode base64 -> bytes -> utf8 string
    const bin = atob(b64);
    const bytes = new Uint8Array(bin.length);
    for (let i=0; i<bin.length; i++) bytes[i] = bin.charCodeAt(i);
    const dec = new TextDecoder('utf-8');
    return dec.decode(bytes);
  }

  let currentCode = null;
  let iframeEl = null;

  function ensureIframe() {
    const body = document.getElementById('modalBody');
    if (!iframeEl) {
      iframeEl = document.createElement('iframe');
      // Permessi audio/microfono nella finestra embedded
      iframeEl.setAttribute('allow', 'microphone *; autoplay *; clipboard-read *; clipboard-write *');
      iframeEl.setAttribute('referrerpolicy', 'no-referrer');
      body.appendChild(iframeEl);
    }
    return iframeEl;
  }

  function openSection(code) {
    // se overlay ancora visibile, sblocca prima (ma NON bloccare click al pulsante di sezione)
    if (!unlocked) {
      // tentativo best-effort: molti browser richiedono gesto, e questo click conta come gesto.
      unlockAudio();
    }

    const item = SOURCES[code];
    if (!item) return;
    currentCode = code;

    const modal = document.getElementById('modal');
    const title = document.getElementById('modalTitle');
    title.textContent = code + ' • ' + item.title;

    const iframe = ensureIframe();
    // carica srcdoc decodificato
    iframe.srcdoc = b64ToUtf8(item.b64);

    modal.classList.add('open');
  }

  function closeModal() {
    const modal = document.getElementById('modal');
    modal.classList.remove('open');
  }

  function reloadCurrent() {
    if (!currentCode) return;
    openSection(currentCode);
  }

  // Wire buttons
  document.getElementById('btnActivate').addEventListener('click', async () => {
    await unlockAudio();
  });
  document.getElementById('btnActivateOpen01').addEventListener('click', async () => {
    await unlockAudio();
    openSection('01');
  });
  document.getElementById('btnActivateTop').addEventListener('click', async () => {
    await unlockAudio();
  });

  // ESC to close
  window.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeModal();
  });
</script>

</body>
</html>
